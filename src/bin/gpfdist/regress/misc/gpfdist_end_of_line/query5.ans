CREATE OR REPLACE FUNCTION fxwd_in() RETURNS record AS '$libdir/fixedwidth.so', 'fixedwidth_in' LANGUAGE C STABLE;
CREATE FUNCTION
CREATE OR REPLACE FUNCTION fxwd_out(record) RETURNS bytea AS '$libdir/fixedwidth.so', 'fixedwidth_out' LANGUAGE C STABLE;
CREATE FUNCTION
DROP EXTERNAL TABLE IF EXISTS tbl_ext_fixedwidth;
DROP EXTERNAL TABLE
CREATE READABLE EXTERNAL TABLE tbl_ext_fixedwidth (
            s1 char(10))                                                              
LOCATION ('gpfdist://10.110.120.137/gpfdist_end_of_line/data/fixedwidth_small_correct1.tbl')       
        FORMAT 'CUSTOM' (formatter='fxwd_in', s1='10');
CREATE EXTERNAL TABLE
DROP EXTERNAL TABLE IF EXISTS tbl_out_fixedwidth;
DROP EXTERNAL TABLE
CREATE WRITABLE EXTERNAL TABLE tbl_out_fixedwidth (
            s1 char(10))                                                              
        LOCATION ('gpfdist://10.110.120.137/gpfdist_end_of_line/data/fixedwidth_out.tbl')     
        FORMAT 'CUSTOM' (formatter='fxwd_out', s1='10',line_delim=' ');
CREATE EXTERNAL TABLE
INSERT INTO tbl_out_fixedwidth 
SELECT * FROM tbl_ext_fixedwidth ORDER BY s1;
INSERT 0 10
DROP EXTERNAL TABLE IF EXISTS tbl_ext_fixedwidth;
DROP EXTERNAL TABLE
CREATE READABLE EXTERNAL TABLE tbl_ext_fixedwidth (
            s1 char(10))
       LOCATION ('gpfdist://10.110.120.137/gpfdist_end_of_line/data/fixedwidth_out.tbl')
       FORMAT 'CUSTOM' (formatter='fxwd_in', s1='10',line_delim=' ');
CREATE EXTERNAL TABLE
DROP TABLE IF EXISTS tbl_on_heap;
DROP TABLE
CREATE TABLE tbl_on_heap (
            s1 char(10));
NOTICE:  Table doesn't have 'DISTRIBUTED BY' clause -- Using column named 's1' as the Greenplum Database data distribution key for this table.
HINT:  The 'DISTRIBUTED BY' clause determines the distribution of data. Make sure column(s) chosen are the optimal data distribution key to minimize skew.
CREATE TABLE
INSERT INTO tbl_on_heap SELECT * FROM tbl_ext_fixedwidth;
INSERT 0 10
SELECT * FROM tbl_on_heap ORDER BY s1;
     s1     
------------
 aaa       
 bbb       
 ccc       
 ddd       
 eee       
 fff       
 hhh       
 iii       
 jjj       
 jjj       
(10 rows)

