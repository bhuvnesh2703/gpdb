-- start_ignore
-- end_ignore
select order_id, customer_id, order_total, lead(order_total, 2) over (order by order_total, customer_id) from orders;
 order_id | customer_id | order_total |  lead  
----------+-------------+-------------+--------
          |           1 |        3.00 | 100.00
          |           2 |        5.00 | 100.00
          |           2 |      100.00 | 500.00
          |           3 |      100.00 | 650.00
          |           1 |      500.00 |       
          |           1 |      650.00 |       
(6 rows)

select order_id, customer_id, order_total, lag(order_total, 2) over (order by order_total, customer_id) from orders;
 order_id | customer_id | order_total |  lag   
----------+-------------+-------------+--------
          |           1 |        3.00 |       
          |           2 |        5.00 |       
          |           2 |      100.00 |   3.00
          |           3 |      100.00 |   5.00
          |           1 |      500.00 | 100.00
          |           1 |      650.00 | 100.00
(6 rows)

