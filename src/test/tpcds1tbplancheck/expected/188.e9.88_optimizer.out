-- start query 1 in stream 0 using template query88.tpl
explain
select  *
from
 (select count(*) h8_30_to_9
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk   
     and ss_hdemo_sk = household_demographics.hd_demo_sk 
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 8
     and time_dim.t_minute >= 30
     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) 
     and store.s_store_name = 'ese') s1,
 (select count(*) h9_to_9_30 
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk 
     and time_dim.t_hour = 9 
     and time_dim.t_minute < 30
     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
     and store.s_store_name = 'ese') s2,
 (select count(*) h9_30_to_10 
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 9
     and time_dim.t_minute >= 30
     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
     and store.s_store_name = 'ese') s3,
 (select count(*) h10_to_10_30
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 10 
     and time_dim.t_minute < 30
     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
     and store.s_store_name = 'ese') s4,
 (select count(*) h10_30_to_11
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 10 
     and time_dim.t_minute >= 30
     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
     and store.s_store_name = 'ese') s5,
 (select count(*) h11_to_11_30
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk 
     and time_dim.t_hour = 11
     and time_dim.t_minute < 30
     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
     and store.s_store_name = 'ese') s6,
 (select count(*) h11_30_to_12
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 11
     and time_dim.t_minute >= 30
     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
     and store.s_store_name = 'ese') s7,
 (select count(*) h12_to_12_30
 from store_sales, household_demographics , time_dim, store
 where ss_sold_time_sk = time_dim.t_time_sk
     and ss_hdemo_sk = household_demographics.hd_demo_sk
     and ss_store_sk = s_store_sk
     and time_dim.t_hour = 12
     and time_dim.t_minute < 30
     and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
          (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
     and store.s_store_name = 'ese') s8
;
                                                                                                                        QUERY PLAN                                                                                                                        
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Nested Loop  (cost=0.00..692236639454206813511090176.00 rows=1 width=64)
   Join Filter: true
   ->  Nested Loop  (cost=0.00..676012343216998841319424.00 rows=1 width=56)
         Join Filter: true
         ->  Nested Loop  (cost=0.00..660168303922850168832.00 rows=1 width=48)
               Join Filter: true
               ->  Nested Loop  (cost=0.00..644695609299365376.00 rows=1 width=40)
                     Join Filter: true
                     ->  Nested Loop  (cost=0.00..629585555663578.88 rows=1 width=32)
                           Join Filter: true
                           ->  Nested Loop  (cost=0.00..614829351468.52 rows=1 width=24)
                                 Join Filter: true
                                 ->  Nested Loop  (cost=0.00..600125694.43 rows=1 width=16)
                                       Join Filter: true
                                       ->  Aggregate  (cost=0.00..293059.90 rows=1 width=8)
                                             ->  Gather Motion 3:1  (slice32; segments: 3)  (cost=0.00..293059.90 rows=1 width=8)
                                                   ->  Aggregate  (cost=0.00..293059.90 rows=1 width=8)
                                                         ->  Hash Join  (cost=0.00..293059.90 rows=2628274 width=1)
                                                               Hash Cond: (store_sales_7.ss_hdemo_sk = household_demographics_7.hd_demo_sk)
                                                               ->  Hash Join  (cost=0.00..290282.87 rows=13256181 width=4)
                                                                     Hash Cond: (store_sales_7.ss_store_sk = store_7.s_store_sk)
                                                                     ->  Hash Join  (cost=0.00..277668.92 rows=67146883 width=8)
                                                                           Hash Cond: (store_sales_7.ss_sold_time_sk = time_dim_7.t_time_sk)
                                                                           ->  Sequence  (cost=0.00..68542.76 rows=959996672 width=12)
                                                                                 ->  Partition Selector for store_sales (dynamic scan id: 2)  (cost=10.00..100.00 rows=34 width=4)
                                                                                       Partitions selected: 80 (out of 80)
                                                                                 ->  Dynamic Table Scan on store_sales store_sales_7 (dynamic scan id: 2)  (cost=0.00..68542.76 rows=959996672 width=12)
                                                                           ->  Hash  (cost=435.26..435.26 rows=3261 width=4)
                                                                                 ->  Broadcast Motion 3:3  (slice29; segments: 3)  (cost=0.00..435.26 rows=3261 width=4)
                                                                                       ->  Table Scan on time_dim time_dim_7  (cost=0.00..435.03 rows=1087 width=4)
                                                                                             Filter: ((t_hour = 9) AND (t_minute < 30))
                                                                     ->  Hash  (cost=431.07..431.07 rows=100 width=4)
                                                                           ->  Broadcast Motion 3:3  (slice30; segments: 3)  (cost=0.00..431.07 rows=100 width=4)
                                                                                 ->  Table Scan on store store_7  (cost=0.00..431.06 rows=34 width=4)
                                                                                       Filter: ((s_store_name)::text = 'ese'::text)
                                                               ->  Hash  (cost=431.34..431.34 rows=1429 width=4)
                                                                     ->  Broadcast Motion 3:3  (slice31; segments: 3)  (cost=0.00..431.34 rows=1429 width=4)
                                                                           ->  Table Scan on household_demographics household_demographics_7  (cost=0.00..431.24 rows=477 width=4)
                                                                                 Filter: (((hd_dep_count = 3) AND (hd_vehicle_count <= 5)) OR ((hd_dep_count = 0) AND (hd_vehicle_count <= 2)) OR ((hd_dep_count = 1) AND (hd_vehicle_count <= 3)))
                                       ->  Aggregate  (cost=0.00..292569.35 rows=1 width=8)
                                             ->  Materialize  (cost=0.00..292569.35 rows=1 width=8)
                                                   ->  Gather Motion 3:1  (slice28; segments: 3)  (cost=0.00..292569.35 rows=1 width=8)
                                                         ->  Aggregate  (cost=0.00..292569.35 rows=1 width=8)
                                                               ->  Hash Join  (cost=0.00..292569.35 rows=2549704 width=1)
                                                                     Hash Cond: (store_sales_6.ss_hdemo_sk = household_demographics_6.hd_demo_sk)
                                                                     ->  Hash Join  (cost=0.00..289862.44 rows=12859897 width=4)
                                                                           Hash Cond: (store_sales_6.ss_store_sk = store_6.s_store_sk)
                                                                           ->  Hash Join  (cost=0.00..277612.69 rows=65139577 width=8)
                                                                                 Hash Cond: (store_sales_6.ss_sold_time_sk = time_dim_6.t_time_sk)
                                                                                 ->  Sequence  (cost=0.00..68542.76 rows=959996672 width=12)
                                                                                       ->  Partition Selector for store_sales (dynamic scan id: 1)  (cost=10.00..100.00 rows=34 width=4)
                                                                                             Partitions selected: 80 (out of 80)
                                                                                       ->  Dynamic Table Scan on store_sales store_sales_6 (dynamic scan id: 1)  (cost=0.00..68542.76 rows=959996672 width=12)
                                                                                 ->  Hash  (cost=435.25..435.25 rows=3164 width=4)
                                                                                       ->  Broadcast Motion 3:3  (slice25; segments: 3)  (cost=0.00..435.25 rows=3164 width=4)
                                                                                             ->  Table Scan on time_dim time_dim_6  (cost=0.00..435.03 rows=1055 width=4)
                                                                                                   Filter: ((t_hour = 8) AND (t_minute >= 30))
                                                                           ->  Hash  (cost=431.07..431.07 rows=100 width=4)
                                                                                 ->  Broadcast Motion 3:3  (slice26; segments: 3)  (cost=0.00..431.07 rows=100 width=4)
                                                                                       ->  Table Scan on store store_6  (cost=0.00..431.06 rows=34 width=4)
                                                                                             Filter: ((s_store_name)::text = 'ese'::text)
                                                                     ->  Hash  (cost=431.34..431.34 rows=1429 width=4)
                                                                           ->  Broadcast Motion 3:3  (slice27; segments: 3)  (cost=0.00..431.34 rows=1429 width=4)
                                                                                 ->  Table Scan on household_demographics household_demographics_6  (cost=0.00..431.24 rows=477 width=4)
                                                                                       Filter: (((hd_dep_count = 3) AND (hd_vehicle_count <= 5)) OR ((hd_dep_count = 0) AND (hd_vehicle_count <= 2)) OR ((hd_dep_count = 1) AND (hd_vehicle_count <= 3)))
                                 ->  Aggregate  (cost=0.00..293163.11 rows=1 width=8)
                                       ->  Materialize  (cost=0.00..293163.11 rows=1 width=8)
                                             ->  Gather Motion 3:1  (slice24; segments: 3)  (cost=0.00..293163.11 rows=1 width=8)
                                                   ->  Aggregate  (cost=0.00..293163.11 rows=1 width=8)
                                                         ->  Hash Join  (cost=0.00..293163.11 rows=2644806 width=1)
                                                               Hash Cond: (store_sales_5.ss_hdemo_sk = household_demographics_5.hd_demo_sk)
                                                               ->  Hash Join  (cost=0.00..290371.33 rows=13339562 width=4)
                                                                     Hash Cond: (store_sales_5.ss_store_sk = store_5.s_store_sk)
                                                                     ->  Hash Join  (cost=0.00..277680.75 rows=67569235 width=8)
                                                                           Hash Cond: (store_sales_5.ss_sold_time_sk = time_dim_5.t_time_sk)
                                                                           ->  Sequence  (cost=0.00..68542.76 rows=959996672 width=12)
                                                                                 ->  Partition Selector for store_sales (dynamic scan id: 3)  (cost=10.00..100.00 rows=34 width=4)
                                                                                       Partitions selected: 80 (out of 80)
                                                                                 ->  Dynamic Table Scan on store_sales store_sales_5 (dynamic scan id: 3)  (cost=0.00..68542.76 rows=959996672 width=12)
                                                                           ->  Hash  (cost=435.26..435.26 rows=3282 width=4)
                                                                                 ->  Broadcast Motion 3:3  (slice21; segments: 3)  (cost=0.00..435.26 rows=3282 width=4)
                                                                                       ->  Table Scan on time_dim time_dim_5  (cost=0.00..435.03 rows=1094 width=4)
                                                                                             Filter: ((t_hour = 9) AND (t_minute >= 30))
                                                                     ->  Hash  (cost=431.07..431.07 rows=100 width=4)
                                                                           ->  Broadcast Motion 3:3  (slice22; segments: 3)  (cost=0.00..431.07 rows=100 width=4)
                                                                                 ->  Table Scan on store store_5  (cost=0.00..431.06 rows=34 width=4)
                                                                                       Filter: ((s_store_name)::text = 'ese'::text)
                                                               ->  Hash  (cost=431.34..431.34 rows=1429 width=4)
                                                                     ->  Broadcast Motion 3:3  (slice23; segments: 3)  (cost=0.00..431.34 rows=1429 width=4)
                                                                           ->  Table Scan on household_demographics household_demographics_5  (cost=0.00..431.24 rows=477 width=4)
                                                                                 Filter: (((hd_dep_count = 3) AND (hd_vehicle_count <= 5)) OR ((hd_dep_count = 0) AND (hd_vehicle_count <= 2)) OR ((hd_dep_count = 1) AND (hd_vehicle_count <= 3)))
                           ->  Aggregate  (cost=0.00..292303.19 rows=1 width=8)
                                 ->  Materialize  (cost=0.00..292303.19 rows=1 width=8)
                                       ->  Gather Motion 3:1  (slice20; segments: 3)  (cost=0.00..292303.19 rows=1 width=8)
                                             ->  Aggregate  (cost=0.00..292303.19 rows=1 width=8)
                                                   ->  Hash Join  (cost=0.00..292303.19 rows=2507073 width=1)
                                                         Hash Cond: (store_sales_4.ss_hdemo_sk = household_demographics_4.hd_demo_sk)
                                                         ->  Hash Join  (cost=0.00..289634.32 rows=12644879 width=4)
                                                               Hash Cond: (store_sales_4.ss_store_sk = store_4.s_store_sk)
                                                               ->  Hash Join  (cost=0.00..277582.18 rows=64050437 width=8)
                                                                     Hash Cond: (store_sales_4.ss_sold_time_sk = time_dim_4.t_time_sk)
                                                                     ->  Sequence  (cost=0.00..68542.76 rows=959996672 width=12)
                                                                           ->  Partition Selector for store_sales (dynamic scan id: 4)  (cost=10.00..100.00 rows=34 width=4)
                                                                                 Partitions selected: 80 (out of 80)
                                                                           ->  Dynamic Table Scan on store_sales store_sales_4 (dynamic scan id: 4)  (cost=0.00..68542.76 rows=959996672 width=12)
                                                                     ->  Hash  (cost=435.25..435.25 rows=3111 width=4)
                                                                           ->  Broadcast Motion 3:3  (slice17; segments: 3)  (cost=0.00..435.25 rows=3111 width=4)
                                                                                 ->  Table Scan on time_dim time_dim_4  (cost=0.00..435.02 rows=1037 width=4)
                                                                                       Filter: ((t_hour = 10) AND (t_minute < 30))
                                                               ->  Hash  (cost=431.07..431.07 rows=100 width=4)
                                                                     ->  Broadcast Motion 3:3  (slice18; segments: 3)  (cost=0.00..431.07 rows=100 width=4)
                                                                           ->  Table Scan on store store_4  (cost=0.00..431.06 rows=34 width=4)
                                                                                 Filter: ((s_store_name)::text = 'ese'::text)
                                                         ->  Hash  (cost=431.34..431.34 rows=1429 width=4)
                                                               ->  Broadcast Motion 3:3  (slice19; segments: 3)  (cost=0.00..431.34 rows=1429 width=4)
                                                                     ->  Table Scan on household_demographics household_demographics_4  (cost=0.00..431.24 rows=477 width=4)
                                                                           Filter: (((hd_dep_count = 3) AND (hd_vehicle_count <= 5)) OR ((hd_dep_count = 0) AND (hd_vehicle_count <= 2)) OR ((hd_dep_count = 1) AND (hd_vehicle_count <= 3)))
                     ->  Aggregate  (cost=0.00..292401.64 rows=1 width=8)
                           ->  Materialize  (cost=0.00..292401.64 rows=1 width=8)
                                 ->  Gather Motion 3:1  (slice16; segments: 3)  (cost=0.00..292401.64 rows=1 width=8)
                                       ->  Aggregate  (cost=0.00..292401.64 rows=1 width=8)
                                             ->  Hash Join  (cost=0.00..292401.64 rows=2522842 width=1)
                                                   Hash Cond: (store_sales_3.ss_hdemo_sk = household_demographics_3.hd_demo_sk)
                                                   ->  Hash Join  (cost=0.00..289718.70 rows=12724415 width=4)
                                                         Hash Cond: (store_sales_3.ss_store_sk = store_3.s_store_sk)
                                                         ->  Hash Join  (cost=0.00..277593.47 rows=64453313 width=8)
                                                               Hash Cond: (store_sales_3.ss_sold_time_sk = time_dim_3.t_time_sk)
                                                               ->  Sequence  (cost=0.00..68542.76 rows=959996672 width=12)
                                                                     ->  Partition Selector for store_sales (dynamic scan id: 5)  (cost=10.00..100.00 rows=34 width=4)
                                                                           Partitions selected: 80 (out of 80)
                                                                     ->  Dynamic Table Scan on store_sales store_sales_3 (dynamic scan id: 5)  (cost=0.00..68542.76 rows=959996672 width=12)
                                                               ->  Hash  (cost=435.25..435.25 rows=3130 width=4)
                                                                     ->  Broadcast Motion 3:3  (slice13; segments: 3)  (cost=0.00..435.25 rows=3130 width=4)
                                                                           ->  Table Scan on time_dim time_dim_3  (cost=0.00..435.03 rows=1044 width=4)
                                                                                 Filter: ((t_hour = 10) AND (t_minute >= 30))
                                                         ->  Hash  (cost=431.07..431.07 rows=100 width=4)
                                                               ->  Broadcast Motion 3:3  (slice14; segments: 3)  (cost=0.00..431.07 rows=100 width=4)
                                                                     ->  Table Scan on store store_3  (cost=0.00..431.06 rows=34 width=4)
                                                                           Filter: ((s_store_name)::text = 'ese'::text)
                                                   ->  Hash  (cost=431.34..431.34 rows=1429 width=4)
                                                         ->  Broadcast Motion 3:3  (slice15; segments: 3)  (cost=0.00..431.34 rows=1429 width=4)
                                                               ->  Table Scan on household_demographics household_demographics_3  (cost=0.00..431.24 rows=477 width=4)
                                                                     Filter: (((hd_dep_count = 3) AND (hd_vehicle_count <= 5)) OR ((hd_dep_count = 0) AND (hd_vehicle_count <= 2)) OR ((hd_dep_count = 1) AND (hd_vehicle_count <= 3)))
               ->  Aggregate  (cost=0.00..292572.62 rows=1 width=8)
                     ->  Materialize  (cost=0.00..292572.62 rows=1 width=8)
                           ->  Gather Motion 3:1  (slice12; segments: 3)  (cost=0.00..292572.62 rows=1 width=8)
                                 ->  Aggregate  (cost=0.00..292572.62 rows=1 width=8)
                                       ->  Hash Join  (cost=0.00..292572.62 rows=2550227 width=1)
                                             Hash Cond: (store_sales_2.ss_hdemo_sk = household_demographics_2.hd_demo_sk)
                                             ->  Hash Join  (cost=0.00..289865.24 rows=12862535 width=4)
                                                   Hash Cond: (store_sales_2.ss_store_sk = store_2.s_store_sk)
                                                   ->  Hash Join  (cost=0.00..277613.06 rows=65152936 width=8)
                                                         Hash Cond: (store_sales_2.ss_sold_time_sk = time_dim_2.t_time_sk)
                                                         ->  Sequence  (cost=0.00..68542.76 rows=959996672 width=12)
                                                               ->  Partition Selector for store_sales (dynamic scan id: 6)  (cost=10.00..100.00 rows=34 width=4)
                                                                     Partitions selected: 80 (out of 80)
                                                               ->  Dynamic Table Scan on store_sales store_sales_2 (dynamic scan id: 6)  (cost=0.00..68542.76 rows=959996672 width=12)
                                                         ->  Hash  (cost=435.25..435.25 rows=3164 width=4)
                                                               ->  Broadcast Motion 3:3  (slice9; segments: 3)  (cost=0.00..435.25 rows=3164 width=4)
                                                                     ->  Table Scan on time_dim time_dim_2  (cost=0.00..435.03 rows=1055 width=4)
                                                                           Filter: ((t_hour = 11) AND (t_minute < 30))
                                                   ->  Hash  (cost=431.07..431.07 rows=100 width=4)
                                                         ->  Broadcast Motion 3:3  (slice10; segments: 3)  (cost=0.00..431.07 rows=100 width=4)
                                                               ->  Table Scan on store store_2  (cost=0.00..431.06 rows=34 width=4)
                                                                     Filter: ((s_store_name)::text = 'ese'::text)
                                             ->  Hash  (cost=431.34..431.34 rows=1429 width=4)
                                                   ->  Broadcast Motion 3:3  (slice11; segments: 3)  (cost=0.00..431.34 rows=1429 width=4)
                                                         ->  Table Scan on household_demographics household_demographics_2  (cost=0.00..431.24 rows=477 width=4)
                                                               Filter: (((hd_dep_count = 3) AND (hd_vehicle_count <= 5)) OR ((hd_dep_count = 0) AND (hd_vehicle_count <= 2)) OR ((hd_dep_count = 1) AND (hd_vehicle_count <= 3)))
         ->  Aggregate  (cost=0.00..292672.77 rows=1 width=8)
               ->  Materialize  (cost=0.00..292672.77 rows=1 width=8)
                     ->  Gather Motion 3:1  (slice8; segments: 3)  (cost=0.00..292672.77 rows=1 width=8)
                           ->  Aggregate  (cost=0.00..292672.77 rows=1 width=8)
                                 ->  Hash Join  (cost=0.00..292672.77 rows=2566268 width=1)
                                       Hash Cond: (store_sales_1.ss_hdemo_sk = household_demographics_1.hd_demo_sk)
                                       ->  Hash Join  (cost=0.00..289951.07 rows=12943440 width=4)
                                             Hash Cond: (store_sales_1.ss_store_sk = store_1.s_store_sk)
                                             ->  Hash Join  (cost=0.00..277624.54 rows=65562746 width=8)
                                                   Hash Cond: (store_sales_1.ss_sold_time_sk = time_dim_1.t_time_sk)
                                                   ->  Sequence  (cost=0.00..68542.76 rows=959996672 width=12)
                                                         ->  Partition Selector for store_sales (dynamic scan id: 7)  (cost=10.00..100.00 rows=34 width=4)
                                                               Partitions selected: 80 (out of 80)
                                                         ->  Dynamic Table Scan on store_sales store_sales_1 (dynamic scan id: 7)  (cost=0.00..68542.76 rows=959996672 width=12)
                                                   ->  Hash  (cost=435.25..435.25 rows=3184 width=4)
                                                         ->  Broadcast Motion 3:3  (slice5; segments: 3)  (cost=0.00..435.25 rows=3184 width=4)
                                                               ->  Table Scan on time_dim time_dim_1  (cost=0.00..435.03 rows=1062 width=4)
                                                                     Filter: ((t_hour = 11) AND (t_minute >= 30))
                                             ->  Hash  (cost=431.07..431.07 rows=100 width=4)
                                                   ->  Broadcast Motion 3:3  (slice6; segments: 3)  (cost=0.00..431.07 rows=100 width=4)
                                                         ->  Table Scan on store store_1  (cost=0.00..431.06 rows=34 width=4)
                                                               Filter: ((s_store_name)::text = 'ese'::text)
                                       ->  Hash  (cost=431.34..431.34 rows=1429 width=4)
                                             ->  Broadcast Motion 3:3  (slice7; segments: 3)  (cost=0.00..431.34 rows=1429 width=4)
                                                   ->  Table Scan on household_demographics household_demographics_1  (cost=0.00..431.24 rows=477 width=4)
                                                         Filter: (((hd_dep_count = 3) AND (hd_vehicle_count <= 5)) OR ((hd_dep_count = 0) AND (hd_vehicle_count <= 2)) OR ((hd_dep_count = 1) AND (hd_vehicle_count <= 3)))
   ->  Aggregate  (cost=0.00..293329.32 rows=1 width=8)
         ->  Materialize  (cost=0.00..293329.32 rows=1 width=8)
               ->  Gather Motion 3:1  (slice4; segments: 3)  (cost=0.00..293329.32 rows=1 width=8)
                     ->  Aggregate  (cost=0.00..293329.32 rows=1 width=8)
                           ->  Hash Join  (cost=0.00..293329.32 rows=2671428 width=1)
                                 Hash Cond: (store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)
                                 ->  Hash Join  (cost=0.00..290513.78 rows=13473837 width=4)
                                       Hash Cond: (store_sales.ss_store_sk = store.s_store_sk)
                                       ->  Hash Join  (cost=0.00..277699.81 rows=68249381 width=8)
                                             Hash Cond: (store_sales.ss_sold_time_sk = time_dim.t_time_sk)
                                             ->  Sequence  (cost=0.00..68542.76 rows=959996672 width=12)
                                                   ->  Partition Selector for store_sales (dynamic scan id: 8)  (cost=10.00..100.00 rows=34 width=4)
                                                         Partitions selected: 80 (out of 80)
                                                   ->  Dynamic Table Scan on store_sales (dynamic scan id: 8)  (cost=0.00..68542.76 rows=959996672 width=12)
                                             ->  Hash  (cost=435.26..435.26 rows=3315 width=4)
                                                   ->  Broadcast Motion 3:3  (slice1; segments: 3)  (cost=0.00..435.26 rows=3315 width=4)
                                                         ->  Table Scan on time_dim  (cost=0.00..435.03 rows=1105 width=4)
                                                               Filter: ((t_hour = 12) AND (t_minute < 30))
                                       ->  Hash  (cost=431.07..431.07 rows=100 width=4)
                                             ->  Broadcast Motion 3:3  (slice2; segments: 3)  (cost=0.00..431.07 rows=100 width=4)
                                                   ->  Table Scan on store  (cost=0.00..431.06 rows=34 width=4)
                                                         Filter: ((s_store_name)::text = 'ese'::text)
                                 ->  Hash  (cost=431.34..431.34 rows=1429 width=4)
                                       ->  Broadcast Motion 3:3  (slice3; segments: 3)  (cost=0.00..431.34 rows=1429 width=4)
                                             ->  Table Scan on household_demographics  (cost=0.00..431.24 rows=477 width=4)
                                                   Filter: (((hd_dep_count = 3) AND (hd_vehicle_count <= 5)) OR ((hd_dep_count = 0) AND (hd_vehicle_count <= 2)) OR ((hd_dep_count = 1) AND (hd_vehicle_count <= 3)))
 Planning time: 3427.923 ms
 Optimizer: PQO version 3.8.0
(223 rows)

-- end query 1 in stream 0 using template query88.tpl
