-- start query 1 in stream 0 using template query27.tpl
explain
select  i_item_id,
        s_state, grouping(s_state) g_state,
        avg(ss_quantity) agg1,
        avg(ss_list_price) agg2,
        avg(ss_coupon_amt) agg3,
        avg(ss_sales_price) agg4
 from store_sales, customer_demographics, date_dim, store, item
 where ss_sold_date_sk = d_date_sk and
       ss_item_sk = i_item_sk and
       ss_store_sk = s_store_sk and
       ss_cdemo_sk = cd_demo_sk and
       cd_gender = 'F' and
       cd_marital_status = 'M' and
       cd_education_status = '4 yr Degree' and
       d_year = 2002 and
       s_state in ('NE','IN', 'SD', 'MN', 'TX', 'MN')
 group by rollup (i_item_id, s_state)
 order by i_item_id
         ,s_state
 limit 100;
                                                                                                                    QUERY PLAN                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=57574902.37..57574903.70 rows=59 width=198)
   ->  Gather Motion 3:1  (slice6; segments: 3)  (cost=57574902.37..57574903.70 rows=59 width=198)
         Merge Key: partial_aggregation.i_item_id, partial_aggregation.s_state
         ->  Limit  (cost=57574902.37..57574902.52 rows=20 width=198)
               ->  Sort  (cost=57574902.37..57574902.52 rows=20 width=198)
                     Sort Key: partial_aggregation.i_item_id, partial_aggregation.s_state
                     ->  GroupAggregate  (cost=57574899.16..57574900.63 rows=20 width=198)
                           Group Key: partial_aggregation.i_item_id, partial_aggregation.s_state, partial_aggregation."grouping", partial_aggregation."group_id"
                           ->  Subquery Scan on partial_aggregation  (cost=57574899.16..57574899.27 rows=3 width=202)
                                 ->  Sort  (cost=57574899.16..57574899.18 rows=3 width=202)
                                       Sort Key: "rollup".i_item_id, "rollup".s_state, (Grouping)
                                       ->  Redistribute Motion 3:3  (slice5; segments: 3)  (cost=57574896.79..57574899.02 rows=3 width=202)
                                             Hash Key: "rollup".i_item_id, "rollup".s_state
                                             ->  GroupAggregate  (cost=57574896.79..57574898.84 rows=3 width=202)
                                                   Group Key: "rollup"."grouping", "rollup"."group_id", "rollup".i_item_id, "rollup".s_state
                                                   ->  Subquery Scan on "rollup"  (cost=57574896.79..57574898.40 rows=5 width=202)
                                                         ->  GroupAggregate  (cost=57574896.79..57574898.27 rows=5 width=202)
                                                               Group Key: rollup_1.i_item_id, rollup_1."grouping", rollup_1."group_id", rollup_1.s_state
                                                               ->  Subquery Scan on rollup_1  (cost=57574896.79..57574897.65 rows=6 width=202)
                                                                     ->  GroupAggregate  (cost=57574896.79..57574897.47 rows=6 width=202)
                                                                           Group Key: item.i_item_id, store.s_state
                                                                           ->  Sort  (cost=57574896.79..57574896.84 rows=7 width=39)
                                                                                 Sort Key: item.i_item_id, store.s_state
                                                                                 ->  Hash Join  (cost=50330.46..57574896.41 rows=7 width=39)
                                                                                       Hash Cond: (store_sales_1_prt_outliers.ss_item_sk = item.i_item_sk)
                                                                                       ->  Redistribute Motion 3:3  (slice4; segments: 3)  (cost=40608.41..57565174.14 rows=3 width=26)
                                                                                             Hash Key: store_sales_1_prt_outliers.ss_item_sk
                                                                                             ->  Hash Join  (cost=40608.41..57565173.97 rows=3 width=26)
                                                                                                   Hash Cond: (store_sales_1_prt_outliers.ss_cdemo_sk = customer_demographics.cd_demo_sk)
                                                                                                   ->  Redistribute Motion 3:3  (slice3; segments: 3)  (cost=1350.95..57525916.41 rows=3 width=30)
                                                                                                         Hash Key: store_sales_1_prt_outliers.ss_cdemo_sk
                                                                                                         ->  Hash Join  (cost=1350.95..57525916.24 rows=3 width=30)
                                                                                                               Hash Cond: (store_sales_1_prt_outliers.ss_store_sk = store.s_store_sk)
                                                                                                               ->  Redistribute Motion 3:3  (slice2; segments: 3)  (cost=1297.42..57525862.50 rows=11 width=31)
                                                                                                                     Hash Key: store_sales_1_prt_outliers.ss_store_sk
                                                                                                                     ->  Hash Join  (cost=1297.42..57525861.87 rows=11 width=31)
                                                                                                                           Hash Cond: (store_sales_1_prt_outliers.ss_sold_date_sk = date_dim.d_date_sk)
                                                                                                                           ->  Append  (cost=0.00..39524635.96 rows=959996170 width=35)
                                                                                                                                 ->  Result  (cost=0.00..1568615.00 rows=43200334 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_outliers  (cost=0.00..1568615.00 rows=43200334 width=35)
                                                                                                                                 ->  Result  (cost=0.00..324595.00 rows=7840134 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_2  (cost=0.00..324595.00 rows=7840134 width=35)
                                                                                                                                 ->  Result  (cost=0.00..336211.00 rows=8120800 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_3  (cost=0.00..336211.00 rows=8120800 width=35)
                                                                                                                                 ->  Result  (cost=0.00..324382.00 rows=7834967 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_4  (cost=0.00..324382.00 rows=7834967 width=35)
                                                                                                                                 ->  Result  (cost=0.00..336381.00 rows=8124734 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_5  (cost=0.00..336381.00 rows=8124734 width=35)
                                                                                                                                 ->  Result  (cost=0.00..336417.00 rows=8125800 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_6  (cost=0.00..336417.00 rows=8125800 width=35)
                                                                                                                                 ->  Result  (cost=0.00..336453.00 rows=8126567 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_7  (cost=0.00..336453.00 rows=8126567 width=35)
                                                                                                                                 ->  Result  (cost=0.00..336058.00 rows=8116967 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_8  (cost=0.00..336058.00 rows=8116967 width=35)
                                                                                                                                 ->  Result  (cost=0.00..489738.00 rows=11829267 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_9  (cost=0.00..489738.00 rows=11829267 width=35)
                                                                                                                                 ->  Result  (cost=0.00..765474.00 rows=18489534 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_10  (cost=0.00..765474.00 rows=18489534 width=35)
                                                                                                                                 ->  Result  (cost=0.00..766278.00 rows=18508900 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_11  (cost=0.00..766278.00 rows=18508900 width=35)
                                                                                                                                 ->  Result  (cost=0.00..793967.00 rows=19177700 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_12  (cost=0.00..793967.00 rows=19177700 width=35)
                                                                                                                                 ->  Result  (cost=0.00..1159820.00 rows=28014600 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_13  (cost=0.00..1159820.00 rows=28014600 width=35)
                                                                                                                                 ->  Result  (cost=0.00..1160753.00 rows=28037334 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_14  (cost=0.00..1160753.00 rows=28037334 width=35)
                                                                                                                                 ->  Result  (cost=0.00..436710.00 rows=10548367 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_15  (cost=0.00..436710.00 rows=10548367 width=35)
                                                                                                                                 ->  Result  (cost=0.00..336477.00 rows=8127134 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_16  (cost=0.00..336477.00 rows=8127134 width=35)
                                                                                                                                 ->  Result  (cost=0.00..324706.00 rows=7842834 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_17  (cost=0.00..324706.00 rows=7842834 width=35)
                                                                                                                                 ->  Result  (cost=0.00..336587.00 rows=8129867 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_18  (cost=0.00..336587.00 rows=8129867 width=35)
                                                                                                                                 ->  Result  (cost=0.00..336153.00 rows=8119367 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_19  (cost=0.00..336153.00 rows=8119367 width=35)
                                                                                                                                 ->  Result  (cost=0.00..336736.00 rows=8133367 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_20  (cost=0.00..336736.00 rows=8133367 width=35)
                                                                                                                                 ->  Result  (cost=0.00..336190.00 rows=8120200 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_21  (cost=0.00..336190.00 rows=8120200 width=35)
                                                                                                                                 ->  Result  (cost=0.00..474334.00 rows=11457100 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_22  (cost=0.00..474334.00 rows=11457100 width=35)
                                                                                                                                 ->  Result  (cost=0.00..766084.00 rows=18504234 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_23  (cost=0.00..766084.00 rows=18504234 width=35)
                                                                                                                                 ->  Result  (cost=0.00..765781.00 rows=18496900 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_24  (cost=0.00..765781.00 rows=18496900 width=35)
                                                                                                                                 ->  Result  (cost=0.00..779443.00 rows=18826834 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_25  (cost=0.00..779443.00 rows=18826834 width=35)
                                                                                                                                 ->  Result  (cost=0.00..1160832.00 rows=28039467 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_26  (cost=0.00..1160832.00 rows=28039467 width=35)
                                                                                                                                 ->  Result  (cost=0.00..1160090.00 rows=28021400 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_27  (cost=0.00..1160090.00 rows=28021400 width=35)
                                                                                                                                 ->  Result  (cost=0.00..465893.00 rows=11253134 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_28  (cost=0.00..465893.00 rows=11253134 width=35)
                                                                                                                                 ->  Result  (cost=0.00..335914.00 rows=8113600 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_29  (cost=0.00..335914.00 rows=8113600 width=35)
                                                                                                                                 ->  Result  (cost=0.00..336186.00 rows=8120167 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_30  (cost=0.00..336186.00 rows=8120167 width=35)
                                                                                                                                 ->  Result  (cost=0.00..336014.00 rows=8115934 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_31  (cost=0.00..336014.00 rows=8115934 width=35)
                                                                                                                                 ->  Result  (cost=0.00..335918.00 rows=8113667 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_32  (cost=0.00..335918.00 rows=8113667 width=35)
                                                                                                                                 ->  Result  (cost=0.00..336069.00 rows=8117334 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_33  (cost=0.00..336069.00 rows=8117334 width=35)
                                                                                                                                 ->  Result  (cost=0.00..335472.00 rows=8102900 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_34  (cost=0.00..335472.00 rows=8102900 width=35)
                                                                                                                                 ->  Result  (cost=0.00..457985.00 rows=11062100 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_35  (cost=0.00..457985.00 rows=11062100 width=35)
                                                                                                                                 ->  Result  (cost=0.00..764679.00 rows=18470400 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_36  (cost=0.00..764679.00 rows=18470400 width=35)
                                                                                                                                 ->  Result  (cost=0.00..764030.00 rows=18454700 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_37  (cost=0.00..764030.00 rows=18454700 width=35)
                                                                                                                                 ->  Result  (cost=0.00..764484.00 rows=18465634 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_38  (cost=0.00..764484.00 rows=18465634 width=35)
                                                                                                                                 ->  Result  (cost=0.00..1158198.04 rows=27975568 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_39  (cost=0.00..1158198.04 rows=27975568 width=35)
                                                                                                                                 ->  Result  (cost=0.00..1158199.04 rows=27975968 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_40  (cost=0.00..1158199.04 rows=27975968 width=35)
                                                                                                                                 ->  Result  (cost=0.00..483138.00 rows=11669800 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_41  (cost=0.00..483138.00 rows=11669800 width=35)
                                                                                                                                 ->  Result  (cost=0.00..336559.00 rows=8129100 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_42  (cost=0.00..336559.00 rows=8129100 width=35)
                                                                                                                                 ->  Result  (cost=0.00..324602.00 rows=7840367 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_43  (cost=0.00..324602.00 rows=7840367 width=35)
                                                                                                                                 ->  Result  (cost=0.00..336209.00 rows=8120567 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_44  (cost=0.00..336209.00 rows=8120567 width=35)
                                                                                                                                 ->  Result  (cost=0.00..336313.00 rows=8123267 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_45  (cost=0.00..336313.00 rows=8123267 width=35)
                                                                                                                                 ->  Result  (cost=0.00..336621.00 rows=8130734 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_46  (cost=0.00..336621.00 rows=8130734 width=35)
                                                                                                                                 ->  Result  (cost=0.00..335906.00 rows=8113400 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_47  (cost=0.00..335906.00 rows=8113400 width=35)
                                                                                                                                 ->  Result  (cost=0.00..428657.00 rows=10353800 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_48  (cost=0.00..428657.00 rows=10353800 width=35)
                                                                                                                                 ->  Result  (cost=0.00..766560.00 rows=18515734 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_49  (cost=0.00..766560.00 rows=18515734 width=35)
                                                                                                                                 ->  Result  (cost=0.00..766167.00 rows=18506234 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_50  (cost=0.00..766167.00 rows=18506234 width=35)
                                                                                                                                 ->  Result  (cost=0.00..766196.00 rows=18506900 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_51  (cost=0.00..766196.00 rows=18506900 width=35)
                                                                                                                                 ->  Result  (cost=0.00..1130938.00 rows=27317200 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_52  (cost=0.00..1130938.00 rows=27317200 width=35)
                                                                                                                                 ->  Result  (cost=0.00..1160637.96 rows=28034566 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_53  (cost=0.00..1160637.96 rows=28034566 width=35)
                                                                                                                                 ->  Result  (cost=0.00..555225.00 rows=13411000 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_54  (cost=0.00..555225.00 rows=13411000 width=35)
                                                                                                                                 ->  Result  (cost=0.00..336782.00 rows=8134567 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_55  (cost=0.00..336782.00 rows=8134567 width=35)
                                                                                                                                 ->  Result  (cost=0.00..324454.00 rows=7836734 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_56  (cost=0.00..324454.00 rows=7836734 width=35)
                                                                                                                                 ->  Result  (cost=0.00..336546.00 rows=8128867 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_57  (cost=0.00..336546.00 rows=8128867 width=35)
                                                                                                                                 ->  Result  (cost=0.00..336207.00 rows=8120667 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_58  (cost=0.00..336207.00 rows=8120667 width=35)
                                                                                                                                 ->  Result  (cost=0.00..336578.00 rows=8129534 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_59  (cost=0.00..336578.00 rows=8129534 width=35)
                                                                                                                                 ->  Result  (cost=0.00..336468.00 rows=8127067 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_60  (cost=0.00..336468.00 rows=8127067 width=35)
                                                                                                                                 ->  Result  (cost=0.00..412992.00 rows=9975467 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_61  (cost=0.00..412992.00 rows=9975467 width=35)
                                                                                                                                 ->  Result  (cost=0.00..765709.00 rows=18495234 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_62  (cost=0.00..765709.00 rows=18495234 width=35)
                                                                                                                                 ->  Result  (cost=0.00..766176.00 rows=18506500 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_63  (cost=0.00..766176.00 rows=18506500 width=35)
                                                                                                                                 ->  Result  (cost=0.00..766142.00 rows=18505834 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_64  (cost=0.00..766142.00 rows=18505834 width=35)
                                                                                                                                 ->  Result  (cost=0.00..1117566.96 rows=26994166 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_65  (cost=0.00..1117566.96 rows=26994166 width=35)
                                                                                                                                 ->  Result  (cost=0.00..1159645.96 rows=28010566 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_66  (cost=0.00..1159645.96 rows=28010566 width=35)
                                                                                                                                 ->  Result  (cost=0.00..331321.00 rows=8002500 width=35)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_67  (cost=0.00..331321.00 rows=8002500 width=35)
                                                                                                                                 ->  Result  (cost=0.00..1.00 rows=1 width=62)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_68  (cost=0.00..1.00 rows=1 width=62)
                                                                                                                                 ->  Result  (cost=0.00..1.00 rows=1 width=62)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_69  (cost=0.00..1.00 rows=1 width=62)
                                                                                                                                 ->  Result  (cost=0.00..1.00 rows=1 width=62)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_70  (cost=0.00..1.00 rows=1 width=62)
                                                                                                                                 ->  Result  (cost=0.00..1.00 rows=1 width=62)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_71  (cost=0.00..1.00 rows=1 width=62)
                                                                                                                                 ->  Result  (cost=0.00..1.00 rows=1 width=62)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_72  (cost=0.00..1.00 rows=1 width=62)
                                                                                                                                 ->  Result  (cost=0.00..1.00 rows=1 width=62)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_73  (cost=0.00..1.00 rows=1 width=62)
                                                                                                                                 ->  Result  (cost=0.00..1.00 rows=1 width=62)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_74  (cost=0.00..1.00 rows=1 width=62)
                                                                                                                                 ->  Result  (cost=0.00..1.00 rows=1 width=62)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_75  (cost=0.00..1.00 rows=1 width=62)
                                                                                                                                 ->  Result  (cost=0.00..1.00 rows=1 width=62)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_76  (cost=0.00..1.00 rows=1 width=62)
                                                                                                                                 ->  Result  (cost=0.00..1.00 rows=1 width=62)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_77  (cost=0.00..1.00 rows=1 width=62)
                                                                                                                                 ->  Result  (cost=0.00..1.00 rows=1 width=62)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_78  (cost=0.00..1.00 rows=1 width=62)
                                                                                                                                 ->  Result  (cost=0.00..1.00 rows=1 width=62)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_79  (cost=0.00..1.00 rows=1 width=62)
                                                                                                                                 ->  Result  (cost=0.00..1.00 rows=1 width=62)
                                                                                                                                       One-Time Filter: PartSelected
                                                                                                                                       ->  Append-only Columnar Scan on store_sales_1_prt_80  (cost=0.00..1.00 rows=1 width=62)
                                                                                                                           ->  Hash  (cost=1283.72..1283.72 rows=366 width=4)
                                                                                                                                 ->  Partition Selector for store_sales (dynamic scan id: 1)  (cost=0.00..1283.72 rows=366 width=4)
                                                                                                                                       Filter: date_dim.d_date_sk
                                                                                                                                       ->  Broadcast Motion 3:3  (slice1; segments: 3)  (cost=0.00..1283.72 rows=366 width=4)
                                                                                                                                             ->  Seq Scan on date_dim  (cost=0.00..1269.11 rows=122 width=4)
                                                                                                                                                   Filter: (d_year = 2002)
                                                                                                               ->  Hash  (cost=49.53..49.53 rows=107 width=7)
                                                                                                                     ->  Seq Scan on store  (cost=0.00..49.53 rows=107 width=7)
                                                                                                                           Filter: ((s_state)::text = ANY ('{NE,IN,SD,MN,TX,MN}'::text[]))
                                                                                                   ->  Hash  (cost=38026.65..38026.65 rows=32822 width=4)
                                                                                                         ->  Seq Scan on customer_demographics  (cost=0.00..38026.65 rows=32822 width=4)
                                                                                                               Filter: ((cd_gender = 'F'::bpchar) AND (cd_marital_status = 'M'::bpchar) AND ((cd_education_status)::text = '4 yr Degree'::text))
                                                                                       ->  Hash  (cost=5981.47..5981.47 rows=99749 width=21)
                                                                                             ->  Seq Scan on item  (cost=0.00..5981.47 rows=99749 width=21)
 Planning time: 22.858 ms
 Optimizer: legacy query optimizer
(294 rows)

-- end query 1 in stream 0 using template query27.tpl
