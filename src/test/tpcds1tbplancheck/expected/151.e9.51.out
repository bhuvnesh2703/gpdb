-- start query 1 in stream 0 using template query51.tpl
explain
WITH web_v1 as (
select
  ws_item_sk item_sk, d_date,
  sum(sum(ws_sales_price))
      over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales
from web_sales
    ,date_dim
where ws_sold_date_sk=d_date_sk
  and d_month_seq between 1212 and 1212+11
  and ws_item_sk is not NULL
group by ws_item_sk, d_date),
store_v1 as (
select
  ss_item_sk item_sk, d_date,
  sum(sum(ss_sales_price))
      over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales
from store_sales
    ,date_dim
where ss_sold_date_sk=d_date_sk
  and d_month_seq between 1212 and 1212+11
  and ss_item_sk is not NULL
group by ss_item_sk, d_date)
 select  *
from (select item_sk
     ,d_date
     ,web_sales
     ,store_sales
     ,max(web_sales)
         over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative
     ,max(store_sales)
         over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative
     from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk
                 ,case when web.d_date is not null then web.d_date else store.d_date end d_date
                 ,web.cume_sales web_sales
                 ,store.cume_sales store_sales
           from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk
                                                          and web.d_date = store.d_date)
          )x )y
where web_cumulative > store_cumulative
order by item_sk
        ,d_date
limit 100;
                                                                                                                                         QUERY PLAN                                                                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1156776.30..1156788.80 rows=100 width=136)
   ->  Gather Motion 3:1  (slice8; segments: 3)  (cost=1156776.30..1156788.80 rows=100 width=136)
         Merge Key: y.item_sk, y.d_date
         ->  Limit  (cost=1156776.30..1156786.80 rows=34 width=136)
               ->  Subquery Scan on y  (cost=1156776.30..1279586.82 rows=389875 width=136)
                     Filter: (y.web_cumulative > y.store_cumulative)
                     ->  WindowAgg  (cost=1156776.30..1235725.92 rows=1169624 width=80)
                           Partition By: (CASE WHEN (web_sales_1_prt_outliers.ws_item_sk IS NOT NULL) THEN web_sales_1_prt_outliers.ws_item_sk ELSE store_sales_1_prt_outliers.ss_item_sk END)
                           Order By: (CASE WHEN (date_dim.d_date IS NOT NULL) THEN date_dim.d_date ELSE date_dim_1.d_date END)
                           ->  Sort  (cost=1156776.30..1165548.48 rows=1169624 width=80)
                                 Sort Key: (CASE WHEN (web_sales_1_prt_outliers.ws_item_sk IS NOT NULL) THEN web_sales_1_prt_outliers.ws_item_sk ELSE store_sales_1_prt_outliers.ss_item_sk END), (CASE WHEN (date_dim.d_date IS NOT NULL) THEN date_dim.d_date ELSE date_dim_1.d_date END)
                                 ->  Redistribute Motion 3:3  (slice7; segments: 3)  (cost=1.08..201761.23 rows=1169624 width=80)
                                       Hash Key: (CASE WHEN (web_sales_1_prt_outliers.ws_item_sk IS NOT NULL) THEN web_sales_1_prt_outliers.ws_item_sk ELSE store_sales_1_prt_outliers.ss_item_sk END)
                                       ->  Hash Full Join  (cost=1.08..131583.79 rows=1169624 width=80)
                                             Hash Cond: ((web_sales_1_prt_outliers.ws_item_sk = store_sales_1_prt_outliers.ss_item_sk) AND (date_dim.d_date = date_dim_1.d_date))
                                             ->  WindowAgg  (cost=16812773.55..16882950.99 rows=1169624 width=40)
                                                   Partition By: web_sales_1_prt_outliers.ws_item_sk
                                                   Order By: date_dim.d_date
                                                   ->  Sort  (cost=16812773.55..16821545.73 rows=1169624 width=40)
                                                         Sort Key: web_sales_1_prt_outliers.ws_item_sk, date_dim.d_date
                                                         ->  Redistribute Motion 3:3  (slice3; segments: 3)  (cost=15901792.85..16078332.97 rows=1169624 width=40)
                                                               Hash Key: web_sales_1_prt_outliers.ws_item_sk
                                                               ->  HashAggregate  (cost=15901792.85..15973066.81 rows=1169624 width=40)
                                                                     Group Key: web_sales_1_prt_outliers.ws_item_sk, date_dim.d_date
                                                                     ->  Redistribute Motion 3:3  (slice2; segments: 3)  (cost=15698936.18..15812974.52 rows=1169624 width=40)
                                                                           Hash Key: web_sales_1_prt_outliers.ws_item_sk, date_dim.d_date
                                                                           ->  HashAggregate  (cost=15698936.18..15742797.08 rows=1169624 width=40)
                                                                                 Group Key: web_sales_1_prt_outliers.ws_item_sk, date_dim.d_date
                                                                                 ->  Hash Join  (cost=1479.32..15672619.64 rows=1169625 width=14)
                                                                                       Hash Cond: (web_sales_1_prt_outliers.ws_sold_date_sk = date_dim.d_date_sk)
                                                                                       ->  Append  (cost=0.00..11136051.31 rows=240000015 width=14)
                                                                                             ->  Result  (cost=0.00..2391.21 rows=59974 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_outliers  (cost=0.00..2391.21 rows=59974 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..94902.80 rows=2044794 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_2  (cost=0.00..94902.80 rows=2044794 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..98794.40 rows=2129180 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_3  (cost=0.00..98794.40 rows=2129180 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..95176.20 rows=2051340 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_4  (cost=0.00..95176.20 rows=2051340 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..98886.20 rows=2130874 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_5  (cost=0.00..98886.20 rows=2130874 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..98686.80 rows=2126394 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_6  (cost=0.00..98686.80 rows=2126394 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..98900.30 rows=2131144 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_7  (cost=0.00..98900.30 rows=2131144 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..98568.30 rows=2124144 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_8  (cost=0.00..98568.30 rows=2124144 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..143675.40 rows=3096280 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_9  (cost=0.00..143675.40 rows=3096280 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..224454.00 rows=4837567 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_10  (cost=0.00..224454.00 rows=4837567 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..224538.00 rows=4838600 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_11  (cost=0.00..224538.00 rows=4838600 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..232917.00 rows=5019700 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_12  (cost=0.00..232917.00 rows=5019700 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..340347.00 rows=7335234 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_13  (cost=0.00..340347.00 rows=7335234 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..339963.00 rows=7326700 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_14  (cost=0.00..339963.00 rows=7326700 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..128058.80 rows=2759894 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_15  (cost=0.00..128058.80 rows=2759894 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..98762.90 rows=2127930 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_16  (cost=0.00..98762.90 rows=2127930 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..95130.30 rows=2049977 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_17  (cost=0.00..95130.30 rows=2049977 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..98536.30 rows=2123477 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_18  (cost=0.00..98536.30 rows=2123477 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..98763.80 rows=2128160 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_19  (cost=0.00..98763.80 rows=2128160 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..98632.00 rows=2125534 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_20  (cost=0.00..98632.00 rows=2125534 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..98600.90 rows=2124597 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_21  (cost=0.00..98600.90 rows=2124597 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..139196.60 rows=2999954 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_22  (cost=0.00..139196.60 rows=2999954 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..224702.00 rows=4842300 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_23  (cost=0.00..224702.00 rows=4842300 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..224404.00 rows=4836067 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_24  (cost=0.00..224404.00 rows=4836067 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..228579.00 rows=4926567 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_25  (cost=0.00..228579.00 rows=4926567 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..340407.00 rows=7336234 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_26  (cost=0.00..340407.00 rows=7336234 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..339824.00 rows=7323934 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_27  (cost=0.00..339824.00 rows=7323934 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..136669.10 rows=2945270 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_28  (cost=0.00..136669.10 rows=2945270 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..98265.40 rows=2117680 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_29  (cost=0.00..98265.40 rows=2117680 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..98510.80 rows=2122894 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_30  (cost=0.00..98510.80 rows=2122894 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..98626.80 rows=2125460 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_31  (cost=0.00..98626.80 rows=2125460 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..98594.80 rows=2124860 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_32  (cost=0.00..98594.80 rows=2124860 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..98426.60 rows=2121220 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_33  (cost=0.00..98426.60 rows=2121220 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..98533.60 rows=2123320 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_34  (cost=0.00..98533.60 rows=2123320 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..134141.00 rows=2890900 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_35  (cost=0.00..134141.00 rows=2890900 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..224203.00 rows=4832167 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_36  (cost=0.00..224203.00 rows=4832167 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..224486.00 rows=4838100 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_37  (cost=0.00..224486.00 rows=4838100 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..224574.00 rows=4840000 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_38  (cost=0.00..224574.00 rows=4840000 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..339843.00 rows=7323734 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_39  (cost=0.00..339843.00 rows=7323734 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..339993.00 rows=7327400 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_40  (cost=0.00..339993.00 rows=7327400 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..141767.90 rows=3054930 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_41  (cost=0.00..141767.90 rows=3054930 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..98461.00 rows=2121867 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_42  (cost=0.00..98461.00 rows=2121867 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..95277.50 rows=2053050 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_43  (cost=0.00..95277.50 rows=2053050 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..98854.40 rows=2130480 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_44  (cost=0.00..98854.40 rows=2130480 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..98738.70 rows=2127790 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_45  (cost=0.00..98738.70 rows=2127790 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..98685.60 rows=2126654 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_46  (cost=0.00..98685.60 rows=2126654 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..98998.50 rows=2133217 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_47  (cost=0.00..98998.50 rows=2133217 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..125716.80 rows=2709260 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_48  (cost=0.00..125716.80 rows=2709260 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..224729.00 rows=4843367 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_49  (cost=0.00..224729.00 rows=4843367 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..224641.00 rows=4841034 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_50  (cost=0.00..224641.00 rows=4841034 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..224630.00 rows=4841267 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_51  (cost=0.00..224630.00 rows=4841267 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..332139.00 rows=7158600 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_52  (cost=0.00..332139.00 rows=7158600 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..340420.00 rows=7336634 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_53  (cost=0.00..340420.00 rows=7336634 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..162712.00 rows=3506534 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_54  (cost=0.00..162712.00 rows=3506534 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..98867.20 rows=2130440 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_55  (cost=0.00..98867.20 rows=2130440 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..95121.00 rows=2049967 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_56  (cost=0.00..95121.00 rows=2049967 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..98600.60 rows=2124820 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_57  (cost=0.00..98600.60 rows=2124820 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..98639.10 rows=2125604 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_58  (cost=0.00..98639.10 rows=2125604 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..98591.40 rows=2124880 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_59  (cost=0.00..98591.40 rows=2124880 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..98868.30 rows=2130610 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_60  (cost=0.00..98868.30 rows=2130610 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..121113.60 rows=2609954 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_61  (cost=0.00..121113.60 rows=2609954 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..224388.00 rows=4835634 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_62  (cost=0.00..224388.00 rows=4835634 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..224495.00 rows=4837834 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_63  (cost=0.00..224495.00 rows=4837834 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..224520.00 rows=4838767 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_64  (cost=0.00..224520.00 rows=4838767 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..328357.00 rows=7076767 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_65  (cost=0.00..328357.00 rows=7076767 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..340970.00 rows=7348567 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_66  (cost=0.00..340970.00 rows=7348567 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..97070.40 rows=2091947 width=14)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_67  (cost=0.00..97070.40 rows=2091947 width=14)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..1.00 rows=1 width=22)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_68  (cost=0.00..1.00 rows=1 width=22)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..1.00 rows=1 width=22)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_69  (cost=0.00..1.00 rows=1 width=22)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..1.00 rows=1 width=22)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_70  (cost=0.00..1.00 rows=1 width=22)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..1.00 rows=1 width=22)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_71  (cost=0.00..1.00 rows=1 width=22)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..1.00 rows=1 width=22)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_72  (cost=0.00..1.00 rows=1 width=22)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..1.00 rows=1 width=22)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_73  (cost=0.00..1.00 rows=1 width=22)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..1.00 rows=1 width=22)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_74  (cost=0.00..1.00 rows=1 width=22)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..1.00 rows=1 width=22)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_75  (cost=0.00..1.00 rows=1 width=22)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..1.00 rows=1 width=22)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_76  (cost=0.00..1.00 rows=1 width=22)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..1.00 rows=1 width=22)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_77  (cost=0.00..1.00 rows=1 width=22)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..1.00 rows=1 width=22)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_78  (cost=0.00..1.00 rows=1 width=22)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..1.00 rows=1 width=22)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_79  (cost=0.00..1.00 rows=1 width=22)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                             ->  Result  (cost=0.00..1.00 rows=1 width=22)
                                                                                                   One-Time Filter: PartSelected
                                                                                                   ->  Append-only Columnar Scan on web_sales_1_prt_80  (cost=0.00..1.00 rows=1 width=22)
                                                                                                         Filter: (ws_item_sk IS NOT NULL)
                                                                                       ->  Hash  (cost=1465.97..1465.97 rows=356 width=8)
                                                                                             ->  Partition Selector for web_sales (dynamic scan id: 1)  (cost=0.00..1465.97 rows=356 width=8)
                                                                                                   Filter: date_dim.d_date_sk
                                                                                                   ->  Broadcast Motion 3:3  (slice1; segments: 3)  (cost=0.00..1465.97 rows=356 width=8)
                                                                                                         ->  Seq Scan on date_dim  (cost=0.00..1451.73 rows=119 width=8)
                                                                                                               Filter: ((d_month_seq >= 1212) AND (d_month_seq <= 1223))
                                             ->  Hash  (cost=0.62..0.62 rows=11 width=40)
                                                   ->  WindowAgg  (cost=57526047.26..57526047.88 rows=11 width=40)
                                                         Partition By: store_sales_1_prt_outliers.ss_item_sk
                                                         Order By: date_dim_1.d_date
                                                         ->  Sort  (cost=57526047.26..57526047.34 rows=11 width=40)
                                                               Sort Key: store_sales_1_prt_outliers.ss_item_sk, date_dim_1.d_date
                                                               ->  Redistribute Motion 3:3  (slice6; segments: 3)  (cost=57526045.18..57526046.50 rows=11 width=40)
                                                                     Hash Key: store_sales_1_prt_outliers.ss_item_sk
                                                                     ->  HashAggregate  (cost=57526045.18..57526045.57 rows=11 width=40)
                                                                           Group Key: store_sales_1_prt_outliers.ss_item_sk, date_dim_1.d_date
                                                                           ->  Redistribute Motion 3:3  (slice5; segments: 3)  (cost=57526044.02..57526044.64 rows=11 width=40)
                                                                                 Hash Key: store_sales_1_prt_outliers.ss_item_sk, date_dim_1.d_date
                                                                                 ->  HashAggregate  (cost=57526044.02..57526044.02 rows=11 width=40)
                                                                                       Group Key: store_sales_1_prt_outliers.ss_item_sk, date_dim_1.d_date
                                                                                       ->  Hash Join  (cost=1479.32..57526043.78 rows=11 width=14)
                                                                                             Hash Cond: (store_sales_1_prt_outliers.ss_sold_date_sk = date_dim_1.d_date_sk)
                                                                                             ->  Append  (cost=0.00..39524635.96 rows=959996170 width=14)
                                                                                                   ->  Result  (cost=0.00..1568615.00 rows=43200334 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_outliers  (cost=0.00..1568615.00 rows=43200334 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..324595.00 rows=7840134 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_2  (cost=0.00..324595.00 rows=7840134 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..336211.00 rows=8120800 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_3  (cost=0.00..336211.00 rows=8120800 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..324382.00 rows=7834967 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_4  (cost=0.00..324382.00 rows=7834967 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..336381.00 rows=8124734 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_5  (cost=0.00..336381.00 rows=8124734 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..336417.00 rows=8125800 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_6  (cost=0.00..336417.00 rows=8125800 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..336453.00 rows=8126567 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_7  (cost=0.00..336453.00 rows=8126567 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..336058.00 rows=8116967 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_8  (cost=0.00..336058.00 rows=8116967 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..489738.00 rows=11829267 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_9  (cost=0.00..489738.00 rows=11829267 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..765474.00 rows=18489534 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_10  (cost=0.00..765474.00 rows=18489534 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..766278.00 rows=18508900 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_11  (cost=0.00..766278.00 rows=18508900 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..793967.00 rows=19177700 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_12  (cost=0.00..793967.00 rows=19177700 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..1159820.00 rows=28014600 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_13  (cost=0.00..1159820.00 rows=28014600 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..1160753.00 rows=28037334 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_14  (cost=0.00..1160753.00 rows=28037334 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..436710.00 rows=10548367 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_15  (cost=0.00..436710.00 rows=10548367 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..336477.00 rows=8127134 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_16  (cost=0.00..336477.00 rows=8127134 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..324706.00 rows=7842834 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_17  (cost=0.00..324706.00 rows=7842834 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..336587.00 rows=8129867 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_18  (cost=0.00..336587.00 rows=8129867 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..336153.00 rows=8119367 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_19  (cost=0.00..336153.00 rows=8119367 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..336736.00 rows=8133367 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_20  (cost=0.00..336736.00 rows=8133367 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..336190.00 rows=8120200 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_21  (cost=0.00..336190.00 rows=8120200 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..474334.00 rows=11457100 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_22  (cost=0.00..474334.00 rows=11457100 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..766084.00 rows=18504234 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_23  (cost=0.00..766084.00 rows=18504234 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..765781.00 rows=18496900 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_24  (cost=0.00..765781.00 rows=18496900 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..779443.00 rows=18826834 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_25  (cost=0.00..779443.00 rows=18826834 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..1160832.00 rows=28039467 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_26  (cost=0.00..1160832.00 rows=28039467 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..1160090.00 rows=28021400 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_27  (cost=0.00..1160090.00 rows=28021400 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..465893.00 rows=11253134 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_28  (cost=0.00..465893.00 rows=11253134 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..335914.00 rows=8113600 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_29  (cost=0.00..335914.00 rows=8113600 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..336186.00 rows=8120167 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_30  (cost=0.00..336186.00 rows=8120167 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..336014.00 rows=8115934 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_31  (cost=0.00..336014.00 rows=8115934 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..335918.00 rows=8113667 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_32  (cost=0.00..335918.00 rows=8113667 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..336069.00 rows=8117334 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_33  (cost=0.00..336069.00 rows=8117334 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..335472.00 rows=8102900 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_34  (cost=0.00..335472.00 rows=8102900 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..457985.00 rows=11062100 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_35  (cost=0.00..457985.00 rows=11062100 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..764679.00 rows=18470400 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_36  (cost=0.00..764679.00 rows=18470400 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..764030.00 rows=18454700 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_37  (cost=0.00..764030.00 rows=18454700 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..764484.00 rows=18465634 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_38  (cost=0.00..764484.00 rows=18465634 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..1158198.04 rows=27975568 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_39  (cost=0.00..1158198.04 rows=27975568 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..1158199.04 rows=27975968 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_40  (cost=0.00..1158199.04 rows=27975968 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..483138.00 rows=11669800 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_41  (cost=0.00..483138.00 rows=11669800 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..336559.00 rows=8129100 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_42  (cost=0.00..336559.00 rows=8129100 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..324602.00 rows=7840367 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_43  (cost=0.00..324602.00 rows=7840367 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..336209.00 rows=8120567 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_44  (cost=0.00..336209.00 rows=8120567 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..336313.00 rows=8123267 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_45  (cost=0.00..336313.00 rows=8123267 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..336621.00 rows=8130734 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_46  (cost=0.00..336621.00 rows=8130734 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..335906.00 rows=8113400 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_47  (cost=0.00..335906.00 rows=8113400 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..428657.00 rows=10353800 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_48  (cost=0.00..428657.00 rows=10353800 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..766560.00 rows=18515734 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_49  (cost=0.00..766560.00 rows=18515734 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..766167.00 rows=18506234 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_50  (cost=0.00..766167.00 rows=18506234 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..766196.00 rows=18506900 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_51  (cost=0.00..766196.00 rows=18506900 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..1130938.00 rows=27317200 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_52  (cost=0.00..1130938.00 rows=27317200 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..1160637.96 rows=28034566 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_53  (cost=0.00..1160637.96 rows=28034566 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..555225.00 rows=13411000 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_54  (cost=0.00..555225.00 rows=13411000 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..336782.00 rows=8134567 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_55  (cost=0.00..336782.00 rows=8134567 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..324454.00 rows=7836734 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_56  (cost=0.00..324454.00 rows=7836734 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..336546.00 rows=8128867 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_57  (cost=0.00..336546.00 rows=8128867 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..336207.00 rows=8120667 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_58  (cost=0.00..336207.00 rows=8120667 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..336578.00 rows=8129534 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_59  (cost=0.00..336578.00 rows=8129534 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..336468.00 rows=8127067 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_60  (cost=0.00..336468.00 rows=8127067 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..412992.00 rows=9975467 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_61  (cost=0.00..412992.00 rows=9975467 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..765709.00 rows=18495234 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_62  (cost=0.00..765709.00 rows=18495234 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..766176.00 rows=18506500 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_63  (cost=0.00..766176.00 rows=18506500 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..766142.00 rows=18505834 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_64  (cost=0.00..766142.00 rows=18505834 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..1117566.96 rows=26994166 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_65  (cost=0.00..1117566.96 rows=26994166 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..1159645.96 rows=28010566 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_66  (cost=0.00..1159645.96 rows=28010566 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..331321.00 rows=8002500 width=14)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_67  (cost=0.00..331321.00 rows=8002500 width=14)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..1.00 rows=1 width=22)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_68  (cost=0.00..1.00 rows=1 width=22)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..1.00 rows=1 width=22)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_69  (cost=0.00..1.00 rows=1 width=22)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..1.00 rows=1 width=22)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_70  (cost=0.00..1.00 rows=1 width=22)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..1.00 rows=1 width=22)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_71  (cost=0.00..1.00 rows=1 width=22)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..1.00 rows=1 width=22)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_72  (cost=0.00..1.00 rows=1 width=22)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..1.00 rows=1 width=22)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_73  (cost=0.00..1.00 rows=1 width=22)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..1.00 rows=1 width=22)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_74  (cost=0.00..1.00 rows=1 width=22)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..1.00 rows=1 width=22)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_75  (cost=0.00..1.00 rows=1 width=22)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..1.00 rows=1 width=22)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_76  (cost=0.00..1.00 rows=1 width=22)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..1.00 rows=1 width=22)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_77  (cost=0.00..1.00 rows=1 width=22)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..1.00 rows=1 width=22)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_78  (cost=0.00..1.00 rows=1 width=22)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..1.00 rows=1 width=22)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_79  (cost=0.00..1.00 rows=1 width=22)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                                   ->  Result  (cost=0.00..1.00 rows=1 width=22)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_80  (cost=0.00..1.00 rows=1 width=22)
                                                                                                               Filter: (ss_item_sk IS NOT NULL)
                                                                                             ->  Hash  (cost=1465.97..1465.97 rows=356 width=8)
                                                                                                   ->  Partition Selector for store_sales (dynamic scan id: 1)  (cost=0.00..1465.97 rows=356 width=8)
                                                                                                         Filter: date_dim_1.d_date_sk
                                                                                                         ->  Broadcast Motion 3:3  (slice4; segments: 3)  (cost=0.00..1465.97 rows=356 width=8)
                                                                                                               ->  Seq Scan on date_dim date_dim_1  (cost=0.00..1451.73 rows=119 width=8)
                                                                                                                     Filter: ((d_month_seq >= 1212) AND (d_month_seq <= 1223))
 Planning time: 30.400 ms
 Optimizer: legacy query optimizer
(702 rows)

-- end query 1 in stream 0 using template query51.tpl
