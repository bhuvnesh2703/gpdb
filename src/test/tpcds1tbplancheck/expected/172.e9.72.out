-- start query 1 in stream 0 using template query72.tpl
explain
select  i_item_desc
      ,w_warehouse_name
      ,d1.d_week_seq
      ,count(case when p_promo_sk is null then 1 else 0 end) no_promo
      ,count(case when p_promo_sk is not null then 1 else 0 end) promo
      ,count(*) total_cnt
from catalog_sales
join inventory on (cs_item_sk = inv_item_sk)
join warehouse on (w_warehouse_sk=inv_warehouse_sk)
join item on (i_item_sk = cs_item_sk)
join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)
join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)
join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)
join date_dim d2 on (inv_date_sk = d2.d_date_sk)
join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)
left outer join promotion on (cs_promo_sk=p_promo_sk)
left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)
where d1.d_week_seq = d2.d_week_seq
  and inv_quantity_on_hand < cs_quantity 
  and d3.d_date > d1.d_date + 5
  and hd_buy_potential = '1001-5000'
  and d1.d_year = 2001
  and hd_buy_potential = '1001-5000'
  and cd_marital_status = 'M'
  and d1.d_year = 2001
group by i_item_desc,w_warehouse_name,d1.d_week_seq
order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq
limit 100;
                                                                                                                                 QUERY PLAN                                                                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=82059772.58..82059774.83 rows=100 width=504)
   ->  Gather Motion 3:1  (slice12; segments: 3)  (cost=82059772.58..82059774.83 rows=100 width=504)
         Merge Key: (count((count(*)))), item.i_item_desc, warehouse.w_warehouse_name, d1.d_week_seq
         ->  Limit  (cost=82059772.58..82059772.83 rows=34 width=504)
               ->  Sort  (cost=82059772.58..82059806.46 rows=4518 width=504)
                     Sort Key: (count((count(*)))), item.i_item_desc, warehouse.w_warehouse_name, d1.d_week_seq
                     ->  HashAggregate  (cost=82059119.11..82059254.63 rows=4518 width=504)
                           Group Key: item.i_item_desc, warehouse.w_warehouse_name, d1.d_week_seq
                           ->  Redistribute Motion 3:3  (slice11; segments: 3)  (cost=82058509.27..82058780.31 rows=4518 width=504)
                                 Hash Key: item.i_item_desc, warehouse.w_warehouse_name, d1.d_week_seq
                                 ->  HashAggregate  (cost=82058509.27..82058509.27 rows=4518 width=504)
                                       Group Key: item.i_item_desc, warehouse.w_warehouse_name, d1.d_week_seq
                                       ->  Hash Left Join  (cost=78928589.86..82058305.98 rows=4518 width=127)
                                             Hash Cond: (catalog_sales_1_prt_outliers.cs_promo_sk = promotion.p_promo_sk)
                                             ->  Hash Join  (cost=78928426.61..82057922.49 rows=4518 width=127)
                                                   Hash Cond: (catalog_sales_1_prt_outliers.cs_item_sk = item.i_item_sk)
                                                   ->  Redistribute Motion 3:3  (slice9; segments: 3)  (cost=78918704.55..82048014.08 rows=4518 width=33)
                                                         Hash Key: catalog_sales_1_prt_outliers.cs_item_sk
                                                         ->  Hash Join  (cost=78918704.55..82047743.03 rows=4518 width=33)
                                                               Hash Cond: (inventory_1_prt_outliers.inv_warehouse_sk = warehouse.w_warehouse_sk)
                                                               ->  Hash Right Join  (cost=78918687.80..82047506.04 rows=4518 width=20)
                                                                     Hash Cond: ((catalog_returns_1_prt_outliers.cr_item_sk = catalog_sales_1_prt_outliers.cs_item_sk) AND (catalog_returns_1_prt_outliers.cr_order_number = catalog_sales_1_prt_outliers.cs_order_number))
                                                                     ->  Append  (cost=0.00..2048707.25 rows=47998910 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_outliers  (cost=0.00..1.00 rows=1 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_2  (cost=0.00..89.94 rows=1932 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_3  (cost=0.00..839.14 rows=19405 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_4  (cost=0.00..2485.51 rows=57851 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_5  (cost=0.00..4960.98 rows=115933 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_6  (cost=0.00..7782.08 rows=182003 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_7  (cost=0.00..10621.88 rows=248696 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_8  (cost=0.00..13478.93 rows=315565 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_9  (cost=0.00..15896.40 rows=372214 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_10  (cost=0.00..17750.30 rows=415710 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_11  (cost=0.00..19794.70 rows=463690 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_12  (cost=0.00..22437.10 rows=525604 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_13  (cost=0.00..26080.50 rows=611050 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_14  (cost=0.00..30734.10 rows=720170 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_15  (cost=0.00..36307.80 rows=850860 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_16  (cost=0.00..41041.30 rows=961744 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_17  (cost=0.00..43099.50 rows=1009950 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_18  (cost=0.00..41879.10 rows=981337 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_19  (cost=0.00..38497.60 rows=902120 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_20  (cost=0.00..34174.60 rows=800720 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_21  (cost=0.00..28866.00 rows=676300 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_22  (cost=0.00..23528.20 rows=551174 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_23  (cost=0.00..20118.40 rows=471247 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_24  (cost=0.00..19874.50 rows=465584 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_25  (cost=0.00..22296.70 rows=522290 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_26  (cost=0.00..25917.20 rows=607140 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_27  (cost=0.00..30522.50 rows=715184 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_28  (cost=0.00..36052.80 rows=844894 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_29  (cost=0.00..40956.30 rows=959777 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_30  (cost=0.00..43148.40 rows=1011214 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_31  (cost=0.00..42010.00 rows=984434 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_32  (cost=0.00..38722.30 rows=907377 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_33  (cost=0.00..34426.40 rows=806647 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_34  (cost=0.00..29177.30 rows=683644 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_35  (cost=0.00..23787.80 rows=557327 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_36  (cost=0.00..20236.00 rows=474067 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_37  (cost=0.00..19907.20 rows=466240 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_38  (cost=0.00..22185.10 rows=519704 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_39  (cost=0.00..25740.00 rows=603100 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_40  (cost=0.00..30341.40 rows=710914 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_41  (cost=0.00..35869.30 rows=840477 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_42  (cost=0.00..40858.00 rows=957467 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_43  (cost=0.00..43189.40 rows=1012114 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_44  (cost=0.00..42208.80 rows=989160 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_45  (cost=0.00..39037.10 rows=914804 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_46  (cost=0.00..34783.00 rows=815100 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_47  (cost=0.00..29479.40 rows=690714 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_48  (cost=0.00..24074.70 rows=564057 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_49  (cost=0.00..20308.20 rows=475707 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_50  (cost=0.00..19762.20 rows=462907 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_51  (cost=0.00..21941.80 rows=513960 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_52  (cost=0.00..25524.00 rows=598034 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_53  (cost=0.00..29988.40 rows=702614 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_54  (cost=0.00..35472.20 rows=831174 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_55  (cost=0.00..40521.40 rows=949514 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_56  (cost=0.00..43037.90 rows=1008564 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_57  (cost=0.00..42199.20 rows=988874 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_58  (cost=0.00..39131.90 rows=916964 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_59  (cost=0.00..34896.90 rows=817730 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_60  (cost=0.00..29665.40 rows=695080 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_61  (cost=0.00..24208.60 rows=567154 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_62  (cost=0.00..20387.30 rows=477644 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_63  (cost=0.00..19741.20 rows=462340 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_64  (cost=0.00..21867.20 rows=512274 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_65  (cost=0.00..25350.50 rows=593884 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_66  (cost=0.00..29837.00 rows=699100 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_67  (cost=0.00..35270.90 rows=826464 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_68  (cost=0.00..40185.20 rows=941674 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_69  (cost=0.00..41789.50 rows=979317 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_70  (cost=0.00..39187.40 rows=918347 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_71  (cost=0.00..33506.60 rows=785120 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_72  (cost=0.00..26483.20 rows=620407 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_73  (cost=0.00..18408.20 rows=431207 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_74  (cost=0.00..10161.74 rows=237858 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_75  (cost=0.00..3892.67 rows=90823 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_76  (cost=0.00..672.49 rows=15283 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_77  (cost=0.00..38.39 rows=213 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_78  (cost=0.00..1.00 rows=1 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_79  (cost=0.00..1.00 rows=1 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_returns_1_prt_80  (cost=0.00..1.00 rows=1 width=12)
                                                                     ->  Hash  (cost=78918484.51..78918484.51 rows=4518 width=28)
                                                                           ->  Redistribute Motion 3:3  (slice7; segments: 3)  (cost=31709686.95..78918484.51 rows=4518 width=28)
                                                                                 Hash Key: catalog_sales_1_prt_outliers.cs_item_sk, catalog_sales_1_prt_outliers.cs_order_number
                                                                                 ->  Hash Join  (cost=31709686.95..78918213.45 rows=4518 width=28)
                                                                                       Hash Cond: ((inventory_1_prt_outliers.inv_date_sk = d2.d_date_sk) AND (d1.d_week_seq = d2.d_week_seq))
                                                                                       ->  Hash Join  (cost=31702391.30..77170424.91 rows=46409530 width=32)
                                                                                             Hash Cond: (inventory_1_prt_outliers.inv_item_sk = catalog_sales_1_prt_outliers.cs_item_sk)
                                                                                             Join Filter: (inventory_1_prt_outliers.inv_quantity_on_hand < catalog_sales_1_prt_outliers.cs_quantity)
                                                                                             ->  Append  (cost=0.00..8061170.00 rows=261000005 width=16)
                                                                                                   ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_outliers  (cost=0.00..32.00 rows=1 width=16)
                                                                                                   ->  Result  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_2  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_3  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_4  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_5  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_6  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_7  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123536.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_8  (cost=0.00..123536.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_9  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_10  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_11  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_12  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123532.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_13  (cost=0.00..123532.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_14  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123536.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_15  (cost=0.00..123536.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_16  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_17  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_18  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_19  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_20  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_21  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_22  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_23  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123533.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_24  (cost=0.00..123533.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_25  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_26  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_27  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_28  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_29  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_30  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_31  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_32  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_33  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_34  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123536.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_35  (cost=0.00..123536.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_36  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_37  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_38  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123540.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_39  (cost=0.00..123540.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_40  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_41  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123531.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_42  (cost=0.00..123531.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123530.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_43  (cost=0.00..123530.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_44  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123529.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_45  (cost=0.00..123529.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_46  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_47  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123533.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_48  (cost=0.00..123533.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123531.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_49  (cost=0.00..123531.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_50  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123529.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_51  (cost=0.00..123529.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123530.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_52  (cost=0.00..123530.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123533.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_53  (cost=0.00..123533.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_54  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_55  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_56  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_57  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_58  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_59  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_60  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_61  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123541.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_62  (cost=0.00..123541.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123540.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_63  (cost=0.00..123540.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123540.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_64  (cost=0.00..123540.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_65  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_66  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                                                   ->  Result  (cost=0.00..30896.00 rows=1000000 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_67  (cost=0.00..30896.00 rows=1000000 width=16)
                                                                                                   ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_68  (cost=0.00..32.00 rows=1 width=16)
                                                                                                   ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_69  (cost=0.00..32.00 rows=1 width=16)
                                                                                                   ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_70  (cost=0.00..32.00 rows=1 width=16)
                                                                                                   ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_71  (cost=0.00..32.00 rows=1 width=16)
                                                                                                   ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_72  (cost=0.00..32.00 rows=1 width=16)
                                                                                                   ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_73  (cost=0.00..32.00 rows=1 width=16)
                                                                                                   ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_74  (cost=0.00..32.00 rows=1 width=16)
                                                                                                   ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_75  (cost=0.00..32.00 rows=1 width=16)
                                                                                                   ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_76  (cost=0.00..32.00 rows=1 width=16)
                                                                                                   ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_77  (cost=0.00..32.00 rows=1 width=16)
                                                                                                   ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_78  (cost=0.00..32.00 rows=1 width=16)
                                                                                                   ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_79  (cost=0.00..32.00 rows=1 width=16)
                                                                                                   ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                                         One-Time Filter: PartSelected
                                                                                                         ->  Append-only Scan on inventory_1_prt_80  (cost=0.00..32.00 rows=1 width=16)
                                                                                             ->  Hash  (cost=31699429.18..31699429.18 rows=78990 width=24)
                                                                                                   ->  Broadcast Motion 3:3  (slice5; segments: 3)  (cost=66331.05..31699429.18 rows=78990 width=24)
                                                                                                         ->  Hash Join  (cost=66331.05..31696269.59 rows=26330 width=24)
                                                                                                               Hash Cond: (catalog_sales_1_prt_outliers.cs_ship_date_sk = d3.d_date_sk)
                                                                                                               Join Filter: (d3.d_date > (d1.d_date + 5))
                                                                                                               ->  Hash Join  (cost=59583.26..31683691.75 rows=79233 width=32)
                                                                                                                     Hash Cond: (catalog_sales_1_prt_outliers.cs_bill_cdemo_sk = customer_demographics.cd_demo_sk)
                                                                                                                     ->  Hash Join  (cost=1512.42..31615765.84 rows=398832 width=36)
                                                                                                                           Hash Cond: (catalog_sales_1_prt_outliers.cs_bill_hdemo_sk = household_demographics.hd_demo_sk)
                                                                                                                           ->  Hash Join  (cost=1297.42..31558586.51 rows=2399968 width=40)
                                                                                                                                 Hash Cond: (catalog_sales_1_prt_outliers.cs_sold_date_sk = d1.d_date_sk)
                                                                                                                                 ->  Append  (cost=0.00..22485412.30 rows=479993481 width=36)
                                                                                                                                       ->  Result  (cost=0.00..95971.30 rows=2401110 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_outliers  (cost=0.00..95971.30 rows=2401110 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198531.00 rows=4234734 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_2  (cost=0.00..198531.00 rows=4234734 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198470.00 rows=4233434 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_3  (cost=0.00..198470.00 rows=4233434 width=36)
                                                                                                                                       ->  Result  (cost=0.00..191463.00 rows=4083934 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_4  (cost=0.00..191463.00 rows=4083934 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198330.00 rows=4230434 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_5  (cost=0.00..198330.00 rows=4230434 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198496.00 rows=4233967 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_6  (cost=0.00..198496.00 rows=4233967 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198494.00 rows=4233967 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_7  (cost=0.00..198494.00 rows=4233967 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198576.00 rows=4235667 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_8  (cost=0.00..198576.00 rows=4235667 width=36)
                                                                                                                                       ->  Result  (cost=0.00..297942.00 rows=6355400 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_9  (cost=0.00..297942.00 rows=6355400 width=36)
                                                                                                                                       ->  Result  (cost=0.00..451674.00 rows=9634834 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_10  (cost=0.00..451674.00 rows=9634834 width=36)
                                                                                                                                       ->  Result  (cost=0.00..451572.00 rows=9632700 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_11  (cost=0.00..451572.00 rows=9632700 width=36)
                                                                                                                                       ->  Result  (cost=0.00..476631.00 rows=10167234 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_12  (cost=0.00..476631.00 rows=10167234 width=36)
                                                                                                                                       ->  Result  (cost=0.00..684375.00 rows=14598867 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_13  (cost=0.00..684375.00 rows=14598867 width=36)
                                                                                                                                       ->  Result  (cost=0.00..684389.00 rows=14599200 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_14  (cost=0.00..684389.00 rows=14599200 width=36)
                                                                                                                                       ->  Result  (cost=0.00..215804.00 rows=4603234 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_15  (cost=0.00..215804.00 rows=4603234 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198278.00 rows=4229400 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_16  (cost=0.00..198278.00 rows=4229400 width=36)
                                                                                                                                       ->  Result  (cost=0.00..191360.00 rows=4081734 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_17  (cost=0.00..191360.00 rows=4081734 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198408.00 rows=4232134 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_18  (cost=0.00..198408.00 rows=4232134 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198462.00 rows=4233300 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_19  (cost=0.00..198462.00 rows=4233300 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198463.00 rows=4233267 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_20  (cost=0.00..198463.00 rows=4233267 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198544.00 rows=4235034 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_21  (cost=0.00..198544.00 rows=4235034 width=36)
                                                                                                                                       ->  Result  (cost=0.00..288857.00 rows=6161600 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_22  (cost=0.00..288857.00 rows=6161600 width=36)
                                                                                                                                       ->  Result  (cost=0.00..451775.00 rows=9637067 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_23  (cost=0.00..451775.00 rows=9637067 width=36)
                                                                                                                                       ->  Result  (cost=0.00..451807.00 rows=9637734 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_24  (cost=0.00..451807.00 rows=9637734 width=36)
                                                                                                                                       ->  Result  (cost=0.00..468431.00 rows=9992300 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_25  (cost=0.00..468431.00 rows=9992300 width=36)
                                                                                                                                       ->  Result  (cost=0.00..684511.00 rows=14601800 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_26  (cost=0.00..684511.00 rows=14601800 width=36)
                                                                                                                                       ->  Result  (cost=0.00..684485.00 rows=14601267 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_27  (cost=0.00..684485.00 rows=14601267 width=36)
                                                                                                                                       ->  Result  (cost=0.00..232955.00 rows=4969100 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_28  (cost=0.00..232955.00 rows=4969100 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198182.00 rows=4227400 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_29  (cost=0.00..198182.00 rows=4227400 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198180.00 rows=4227300 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_30  (cost=0.00..198180.00 rows=4227300 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198236.00 rows=4228467 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_31  (cost=0.00..198236.00 rows=4228467 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198161.00 rows=4226867 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_32  (cost=0.00..198161.00 rows=4226867 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198143.00 rows=4226467 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_33  (cost=0.00..198143.00 rows=4226467 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198217.00 rows=4228000 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_34  (cost=0.00..198217.00 rows=4228000 width=36)
                                                                                                                                       ->  Result  (cost=0.00..279401.00 rows=5959900 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_35  (cost=0.00..279401.00 rows=5959900 width=36)
                                                                                                                                       ->  Result  (cost=0.00..451102.00 rows=9622600 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_36  (cost=0.00..451102.00 rows=9622600 width=36)
                                                                                                                                       ->  Result  (cost=0.00..451004.00 rows=9620567 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_37  (cost=0.00..451004.00 rows=9620567 width=36)
                                                                                                                                       ->  Result  (cost=0.00..459207.00 rows=9795567 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_38  (cost=0.00..459207.00 rows=9795567 width=36)
                                                                                                                                       ->  Result  (cost=0.00..683201.00 rows=14573867 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_39  (cost=0.00..683201.00 rows=14573867 width=36)
                                                                                                                                       ->  Result  (cost=0.00..683288.00 rows=14575634 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_40  (cost=0.00..683288.00 rows=14575634 width=36)
                                                                                                                                       ->  Result  (cost=0.00..267716.00 rows=5710600 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_41  (cost=0.00..267716.00 rows=5710600 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198348.00 rows=4230867 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_42  (cost=0.00..198348.00 rows=4230867 width=36)
                                                                                                                                       ->  Result  (cost=0.00..191374.00 rows=4082034 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_43  (cost=0.00..191374.00 rows=4082034 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198449.00 rows=4233067 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_44  (cost=0.00..198449.00 rows=4233067 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198436.00 rows=4232667 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_45  (cost=0.00..198436.00 rows=4232667 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198484.00 rows=4233767 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_46  (cost=0.00..198484.00 rows=4233767 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198486.00 rows=4233767 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_47  (cost=0.00..198486.00 rows=4233767 width=36)
                                                                                                                                       ->  Result  (cost=0.00..261759.00 rows=5583500 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_48  (cost=0.00..261759.00 rows=5583500 width=36)
                                                                                                                                       ->  Result  (cost=0.00..451867.00 rows=9638934 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_49  (cost=0.00..451867.00 rows=9638934 width=36)
                                                                                                                                       ->  Result  (cost=0.00..451711.00 rows=9635634 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_50  (cost=0.00..451711.00 rows=9635634 width=36)
                                                                                                                                       ->  Result  (cost=0.00..451715.00 rows=9635700 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_51  (cost=0.00..451715.00 rows=9635700 width=36)
                                                                                                                                       ->  Result  (cost=0.00..676048.00 rows=14421300 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_52  (cost=0.00..676048.00 rows=14421300 width=36)
                                                                                                                                       ->  Result  (cost=0.00..684330.00 rows=14597934 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_53  (cost=0.00..684330.00 rows=14597934 width=36)
                                                                                                                                       ->  Result  (cost=0.00..285353.00 rows=6086800 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_54  (cost=0.00..285353.00 rows=6086800 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198500.00 rows=4234067 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_55  (cost=0.00..198500.00 rows=4234067 width=36)
                                                                                                                                       ->  Result  (cost=0.00..191327.00 rows=4081100 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_56  (cost=0.00..191327.00 rows=4081100 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198470.00 rows=4233434 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_57  (cost=0.00..198470.00 rows=4233434 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198434.00 rows=4232667 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_58  (cost=0.00..198434.00 rows=4232667 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198457.00 rows=4233100 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_59  (cost=0.00..198457.00 rows=4233100 width=36)
                                                                                                                                       ->  Result  (cost=0.00..198420.00 rows=4232400 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_60  (cost=0.00..198420.00 rows=4232400 width=36)
                                                                                                                                       ->  Result  (cost=0.00..252732.00 rows=5390967 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_61  (cost=0.00..252732.00 rows=5390967 width=36)
                                                                                                                                       ->  Result  (cost=0.00..451735.00 rows=9636134 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_62  (cost=0.00..451735.00 rows=9636134 width=36)
                                                                                                                                       ->  Result  (cost=0.00..451761.00 rows=9636700 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_63  (cost=0.00..451761.00 rows=9636700 width=36)
                                                                                                                                       ->  Result  (cost=0.00..451680.00 rows=9634900 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_64  (cost=0.00..451680.00 rows=9634900 width=36)
                                                                                                                                       ->  Result  (cost=0.00..667727.00 rows=14243734 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_65  (cost=0.00..667727.00 rows=14243734 width=36)
                                                                                                                                       ->  Result  (cost=0.00..684173.00 rows=14594534 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_66  (cost=0.00..684173.00 rows=14594534 width=36)
                                                                                                                                       ->  Result  (cost=0.00..244531.00 rows=5216100 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_67  (cost=0.00..244531.00 rows=5216100 width=36)
                                                                                                                                       ->  Result  (cost=0.00..1.00 rows=1 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_68  (cost=0.00..1.00 rows=1 width=36)
                                                                                                                                       ->  Result  (cost=0.00..1.00 rows=1 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_69  (cost=0.00..1.00 rows=1 width=36)
                                                                                                                                       ->  Result  (cost=0.00..1.00 rows=1 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_70  (cost=0.00..1.00 rows=1 width=36)
                                                                                                                                       ->  Result  (cost=0.00..1.00 rows=1 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_71  (cost=0.00..1.00 rows=1 width=36)
                                                                                                                                       ->  Result  (cost=0.00..1.00 rows=1 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_72  (cost=0.00..1.00 rows=1 width=36)
                                                                                                                                       ->  Result  (cost=0.00..1.00 rows=1 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_73  (cost=0.00..1.00 rows=1 width=36)
                                                                                                                                       ->  Result  (cost=0.00..1.00 rows=1 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_74  (cost=0.00..1.00 rows=1 width=36)
                                                                                                                                       ->  Result  (cost=0.00..1.00 rows=1 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_75  (cost=0.00..1.00 rows=1 width=36)
                                                                                                                                       ->  Result  (cost=0.00..1.00 rows=1 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_76  (cost=0.00..1.00 rows=1 width=36)
                                                                                                                                       ->  Result  (cost=0.00..1.00 rows=1 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_77  (cost=0.00..1.00 rows=1 width=36)
                                                                                                                                       ->  Result  (cost=0.00..1.00 rows=1 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_78  (cost=0.00..1.00 rows=1 width=36)
                                                                                                                                       ->  Result  (cost=0.00..1.00 rows=1 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_79  (cost=0.00..1.00 rows=1 width=36)
                                                                                                                                       ->  Result  (cost=0.00..1.00 rows=1 width=36)
                                                                                                                                             One-Time Filter: PartSelected
                                                                                                                                             ->  Append-only Columnar Scan on catalog_sales_1_prt_80  (cost=0.00..1.00 rows=1 width=36)
                                                                                                                                 ->  Hash  (cost=1283.72..1283.72 rows=366 width=12)
                                                                                                                                       ->  Partition Selector for catalog_sales (dynamic scan id: 1)  (cost=0.00..1283.72 rows=366 width=12)
                                                                                                                                             Filter: d1.d_date_sk
                                                                                                                                             ->  Broadcast Motion 3:3  (slice1; segments: 3)  (cost=0.00..1283.72 rows=366 width=12)
                                                                                                                                                   ->  Seq Scan on date_dim d1  (cost=0.00..1269.11 rows=122 width=12)
                                                                                                                                                         Filter: (d_year = 2001)
                                                                                                                           ->  Hash  (cost=170.00..170.00 rows=1201 width=4)
                                                                                                                                 ->  Broadcast Motion 3:3  (slice2; segments: 3)  (cost=0.00..170.00 rows=1201 width=4)
                                                                                                                                       ->  Seq Scan on household_demographics  (cost=0.00..122.00 rows=401 width=4)
                                                                                                                                             Filter: ((hd_buy_potential)::text = '1001-5000'::text)
                                                                                                                     ->  Hash  (cost=43724.99..43724.99 rows=382556 width=4)
                                                                                                                           ->  Broadcast Motion 3:3  (slice3; segments: 3)  (cost=0.00..43724.99 rows=382556 width=4)
                                                                                                                                 ->  Seq Scan on customer_demographics  (cost=0.00..28422.75 rows=127519 width=4)
                                                                                                                                       Filter: (cd_marital_status = 'M'::bpchar)
                                                                                                               ->  Hash  (cost=4008.45..4008.45 rows=73049 width=8)
                                                                                                                     ->  Broadcast Motion 3:3  (slice4; segments: 3)  (cost=0.00..4008.45 rows=73049 width=8)
                                                                                                                           ->  Seq Scan on date_dim d3  (cost=0.00..1086.49 rows=24350 width=8)
                                                                                       ->  Hash  (cost=4008.45..4008.45 rows=73049 width=8)
                                                                                             ->  Partition Selector for inventory (dynamic scan id: 2)  (cost=0.00..4008.45 rows=73049 width=8)
                                                                                                   Filter: d2.d_date_sk
                                                                                                   ->  Broadcast Motion 3:3  (slice6; segments: 3)  (cost=0.00..4008.45 rows=73049 width=8)
                                                                                                         ->  Seq Scan on date_dim d2  (cost=0.00..1086.49 rows=24350 width=8)
                                                               ->  Hash  (cost=16.00..16.00 rows=20 width=21)
                                                                     ->  Broadcast Motion 3:3  (slice8; segments: 3)  (cost=0.00..16.00 rows=20 width=21)
                                                                           ->  Seq Scan on warehouse  (cost=0.00..15.20 rows=7 width=21)
                                                   ->  Hash  (cost=5981.47..5981.47 rows=99749 width=106)
                                                         ->  Seq Scan on item  (cost=0.00..5981.47 rows=99749 width=106)
                                             ->  Hash  (cost=107.00..107.00 rows=1500 width=4)
                                                   ->  Broadcast Motion 3:3  (slice10; segments: 3)  (cost=0.00..107.00 rows=1500 width=4)
                                                         ->  Seq Scan on promotion  (cost=0.00..47.00 rows=500 width=4)
 Planning time: 458.112 ms
 Optimizer: legacy query optimizer
(636 rows)

-- end query 1 in stream 0 using template query72.tpl
