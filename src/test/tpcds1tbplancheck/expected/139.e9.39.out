-- start query 1 in stream 0 using template query39.tpl
explain
with inv as
(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy
       ,stdev,mean, case mean when 0 then null else stdev/mean end cov
 from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy
            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean
      from inventory
          ,item
          ,warehouse
          ,date_dim
      where inv_item_sk = i_item_sk
        and inv_warehouse_sk = w_warehouse_sk
        and inv_date_sk = d_date_sk
        and d_year =2002
      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo
 where case mean when 0 then 0 else stdev/mean end > 1)
select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov
        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov
from inv inv1,inv inv2
where inv1.i_item_sk = inv2.i_item_sk
  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk
  and inv1.d_moy=3
  and inv2.d_moy=3+1
order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov
        ,inv2.d_moy,inv2.mean, inv2.cov
;
                                                                                                                                                                        QUERY PLAN                                                                                                                                                                         
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Gather Motion 3:1  (slice11; segments: 3)  (cost=2763434.95..2763462.47 rows=11009 width=152)
   Merge Key: inv1.w_warehouse_sk, inv1.i_item_sk, inv1.mean, inv1.cov, inv2.mean, inv2.cov
   ->  Sort  (cost=2763434.95..2763462.47 rows=3670 width=152)
         Sort Key: inv1.w_warehouse_sk, inv1.i_item_sk, inv1.mean, inv1.cov, inv2.mean, inv2.cov
         ->  Hash Join  (cost=5738.98..2762695.93 rows=3670 width=152)
               Hash Cond: ((inv1.i_item_sk = inv2.i_item_sk) AND (inv1.w_warehouse_sk = inv2.w_warehouse_sk))
               ->  Redistribute Motion 3:3  (slice5; segments: 3)  (cost=0.00..4220.00 rows=35167 width=76)
                     Hash Key: inv1.i_item_sk, inv1.w_warehouse_sk
                     ->  Subquery Scan on inv1  (cost=0.00..2110.00 rows=35167 width=76)
                           ->  Subquery Scan on foo  (cost=13065871.58..13070619.08 rows=35167 width=134)
                                 ->  HashAggregate  (cost=13065871.58..13069036.58 rows=35167 width=134)
                                       Group Key: warehouse.w_warehouse_name, warehouse.w_warehouse_sk, item.i_item_sk, date_dim.d_moy
                                       Filter: (CASE pg_catalog.avg((avg(inventory_1_prt_outliers.inv_quantity_on_hand))) WHEN 0::numeric THEN 0::numeric ELSE (pg_catalog.stddev_samp((stddev_samp(inventory_1_prt_outliers.inv_quantity_on_hand))) / pg_catalog.avg((avg(inventory_1_prt_outliers.inv_quantity_on_hand)))) END > 1::numeric)
                                       ->  Redistribute Motion 3:3  (slice4; segments: 3)  (cost=13060332.83..13062442.83 rows=35167 width=134)
                                             Hash Key: warehouse.w_warehouse_name, warehouse.w_warehouse_sk, item.i_item_sk, date_dim.d_moy
                                             ->  HashAggregate  (cost=13060332.83..13060332.83 rows=35167 width=134)
                                                   Group Key: warehouse.w_warehouse_name, warehouse.w_warehouse_sk, item.i_item_sk, date_dim.d_moy
                                                   ->  Hash Join  (cost=30649.91..13034453.39 rows=383400 width=33)
                                                         Hash Cond: (inventory_1_prt_outliers.inv_warehouse_sk = warehouse.w_warehouse_sk)
                                                         ->  Hash Join  (cost=30633.16..13015745.93 rows=383400 width=16)
                                                               Hash Cond: (inventory_1_prt_outliers.inv_item_sk = item.i_item_sk)
                                                               ->  Hash Join  (cost=1460.05..12967882.11 rows=383400 width=16)
                                                                     Hash Cond: (inventory_1_prt_outliers.inv_date_sk = date_dim.d_date_sk)
                                                                     ->  Append  (cost=0.00..8061170.00 rows=261000005 width=16)
                                                                           ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_outliers  (cost=0.00..32.00 rows=1 width=16)
                                                                           ->  Result  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_2  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_3  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_4  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_5  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_6  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_7  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123536.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_8  (cost=0.00..123536.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_9  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_10  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_11  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_12  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123532.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_13  (cost=0.00..123532.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_14  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123536.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_15  (cost=0.00..123536.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_16  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_17  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_18  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_19  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_20  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_21  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_22  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_23  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123533.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_24  (cost=0.00..123533.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_25  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_26  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_27  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_28  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_29  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_30  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_31  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_32  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_33  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_34  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123536.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_35  (cost=0.00..123536.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_36  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_37  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_38  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123540.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_39  (cost=0.00..123540.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_40  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_41  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123531.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_42  (cost=0.00..123531.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123530.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_43  (cost=0.00..123530.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_44  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123529.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_45  (cost=0.00..123529.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_46  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_47  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123533.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_48  (cost=0.00..123533.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123531.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_49  (cost=0.00..123531.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_50  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123529.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_51  (cost=0.00..123529.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123530.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_52  (cost=0.00..123530.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123533.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_53  (cost=0.00..123533.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_54  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_55  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_56  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_57  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_58  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_59  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_60  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_61  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123541.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_62  (cost=0.00..123541.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123540.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_63  (cost=0.00..123540.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123540.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_64  (cost=0.00..123540.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_65  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_66  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                           ->  Result  (cost=0.00..30896.00 rows=1000000 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_67  (cost=0.00..30896.00 rows=1000000 width=16)
                                                                           ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_68  (cost=0.00..32.00 rows=1 width=16)
                                                                           ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_69  (cost=0.00..32.00 rows=1 width=16)
                                                                           ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_70  (cost=0.00..32.00 rows=1 width=16)
                                                                           ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_71  (cost=0.00..32.00 rows=1 width=16)
                                                                           ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_72  (cost=0.00..32.00 rows=1 width=16)
                                                                           ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_73  (cost=0.00..32.00 rows=1 width=16)
                                                                           ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_74  (cost=0.00..32.00 rows=1 width=16)
                                                                           ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_75  (cost=0.00..32.00 rows=1 width=16)
                                                                           ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_76  (cost=0.00..32.00 rows=1 width=16)
                                                                           ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_77  (cost=0.00..32.00 rows=1 width=16)
                                                                           ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_78  (cost=0.00..32.00 rows=1 width=16)
                                                                           ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_79  (cost=0.00..32.00 rows=1 width=16)
                                                                           ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Scan on inventory_1_prt_80  (cost=0.00..32.00 rows=1 width=16)
                                                                     ->  Hash  (cost=1456.03..1456.03 rows=108 width=8)
                                                                           ->  Partition Selector for inventory (dynamic scan id: 1)  (cost=0.00..1456.03 rows=108 width=8)
                                                                                 Filter: date_dim.d_date_sk
                                                                                 ->  Broadcast Motion 3:3  (slice1; segments: 3)  (cost=0.00..1456.03 rows=108 width=8)
                                                                                       ->  Seq Scan on date_dim  (cost=0.00..1451.73 rows=36 width=8)
                                                                                             Filter: ((d_year = 2002) AND (d_moy = 3))
                                                               ->  Hash  (cost=17951.35..17951.35 rows=299247 width=4)
                                                                     ->  Broadcast Motion 3:3  (slice2; segments: 3)  (cost=0.00..17951.35 rows=299247 width=4)
                                                                           ->  Seq Scan on item  (cost=0.00..5981.47 rows=99749 width=4)
                                                         ->  Hash  (cost=16.00..16.00 rows=20 width=21)
                                                               ->  Broadcast Motion 3:3  (slice3; segments: 3)  (cost=0.00..16.00 rows=20 width=21)
                                                                     ->  Seq Scan on warehouse  (cost=0.00..15.20 rows=7 width=21)
               ->  Hash  (cost=4173.80..4173.80 rows=34782 width=76)
                     ->  Redistribute Motion 3:3  (slice10; segments: 3)  (cost=0.00..4173.80 rows=34782 width=76)
                           Hash Key: inv2.i_item_sk, inv2.w_warehouse_sk
                           ->  Subquery Scan on inv2  (cost=0.00..2086.90 rows=34782 width=76)
                                 ->  Subquery Scan on foo_1  (cost=13064991.87..13069687.39 rows=34782 width=134)
                                       ->  HashAggregate  (cost=13064991.87..13068122.22 rows=34782 width=134)
                                             Group Key: warehouse_1.w_warehouse_name, warehouse_1.w_warehouse_sk, item_1.i_item_sk, date_dim_1.d_moy
                                             Filter: (CASE pg_catalog.avg((avg(inventory_1_prt_outliers_1.inv_quantity_on_hand))) WHEN 0::numeric THEN 0::numeric ELSE (pg_catalog.stddev_samp((stddev_samp(inventory_1_prt_outliers_1.inv_quantity_on_hand))) / pg_catalog.avg((avg(inventory_1_prt_outliers_1.inv_quantity_on_hand)))) END > 1::numeric)
                                             ->  Redistribute Motion 3:3  (slice9; segments: 3)  (cost=13059513.75..13061600.65 rows=34782 width=134)
                                                   Hash Key: warehouse_1.w_warehouse_name, warehouse_1.w_warehouse_sk, item_1.i_item_sk, date_dim_1.d_moy
                                                   ->  HashAggregate  (cost=13059513.75..13059513.75 rows=34782 width=134)
                                                         Group Key: warehouse_1.w_warehouse_name, warehouse_1.w_warehouse_sk, item_1.i_item_sk, date_dim_1.d_moy
                                                         ->  Hash Join  (cost=30649.82..13033917.81 rows=379200 width=33)
                                                               Hash Cond: (inventory_1_prt_outliers_1.inv_warehouse_sk = warehouse_1.w_warehouse_sk)
                                                               ->  Hash Join  (cost=30633.07..13015415.10 rows=379200 width=16)
                                                                     Hash Cond: (inventory_1_prt_outliers_1.inv_item_sk = item_1.i_item_sk)
                                                                     ->  Hash Join  (cost=1459.96..12967756.02 rows=379200 width=16)
                                                                           Hash Cond: (inventory_1_prt_outliers_1.inv_date_sk = date_dim_1.d_date_sk)
                                                                           ->  Append  (cost=0.00..8061170.00 rows=261000005 width=16)
                                                                                 ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_outliers inventory_1_prt_outliers_1  (cost=0.00..32.00 rows=1 width=16)
                                                                                 ->  Result  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_2 inventory_1_prt_2_1  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_3 inventory_1_prt_3_1  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_4 inventory_1_prt_4_1  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_5 inventory_1_prt_5_1  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_6 inventory_1_prt_6_1  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_7 inventory_1_prt_7_1  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123536.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_8 inventory_1_prt_8_1  (cost=0.00..123536.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_9 inventory_1_prt_9_1  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_10 inventory_1_prt_10_1  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_11 inventory_1_prt_11_1  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_12 inventory_1_prt_12_1  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123532.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_13 inventory_1_prt_13_1  (cost=0.00..123532.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_14 inventory_1_prt_14_1  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123536.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_15 inventory_1_prt_15_1  (cost=0.00..123536.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_16 inventory_1_prt_16_1  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_17 inventory_1_prt_17_1  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_18 inventory_1_prt_18_1  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_19 inventory_1_prt_19_1  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_20 inventory_1_prt_20_1  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_21 inventory_1_prt_21_1  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_22 inventory_1_prt_22_1  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_23 inventory_1_prt_23_1  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123533.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_24 inventory_1_prt_24_1  (cost=0.00..123533.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_25 inventory_1_prt_25_1  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_26 inventory_1_prt_26_1  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_27 inventory_1_prt_27_1  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_28 inventory_1_prt_28_1  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_29 inventory_1_prt_29_1  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_30 inventory_1_prt_30_1  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_31 inventory_1_prt_31_1  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_32 inventory_1_prt_32_1  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_33 inventory_1_prt_33_1  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_34 inventory_1_prt_34_1  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123536.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_35 inventory_1_prt_35_1  (cost=0.00..123536.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_36 inventory_1_prt_36_1  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_37 inventory_1_prt_37_1  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_38 inventory_1_prt_38_1  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123540.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_39 inventory_1_prt_39_1  (cost=0.00..123540.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_40 inventory_1_prt_40_1  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_41 inventory_1_prt_41_1  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123531.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_42 inventory_1_prt_42_1  (cost=0.00..123531.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123530.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_43 inventory_1_prt_43_1  (cost=0.00..123530.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_44 inventory_1_prt_44_1  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123529.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_45 inventory_1_prt_45_1  (cost=0.00..123529.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_46 inventory_1_prt_46_1  (cost=0.00..123538.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_47 inventory_1_prt_47_1  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123533.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_48 inventory_1_prt_48_1  (cost=0.00..123533.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123531.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_49 inventory_1_prt_49_1  (cost=0.00..123531.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_50 inventory_1_prt_50_1  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123529.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_51 inventory_1_prt_51_1  (cost=0.00..123529.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123530.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_52 inventory_1_prt_52_1  (cost=0.00..123530.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123533.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_53 inventory_1_prt_53_1  (cost=0.00..123533.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_54 inventory_1_prt_54_1  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_55 inventory_1_prt_55_1  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_56 inventory_1_prt_56_1  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_57 inventory_1_prt_57_1  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_58 inventory_1_prt_58_1  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_59 inventory_1_prt_59_1  (cost=0.00..123534.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_60 inventory_1_prt_60_1  (cost=0.00..123535.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_61 inventory_1_prt_61_1  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123541.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_62 inventory_1_prt_62_1  (cost=0.00..123541.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123540.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_63 inventory_1_prt_63_1  (cost=0.00..123540.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123540.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_64 inventory_1_prt_64_1  (cost=0.00..123540.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_65 inventory_1_prt_65_1  (cost=0.00..123537.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_66 inventory_1_prt_66_1  (cost=0.00..123539.00 rows=4000000 width=16)
                                                                                 ->  Result  (cost=0.00..30896.00 rows=1000000 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_67 inventory_1_prt_67_1  (cost=0.00..30896.00 rows=1000000 width=16)
                                                                                 ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_68 inventory_1_prt_68_1  (cost=0.00..32.00 rows=1 width=16)
                                                                                 ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_69 inventory_1_prt_69_1  (cost=0.00..32.00 rows=1 width=16)
                                                                                 ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_70 inventory_1_prt_70_1  (cost=0.00..32.00 rows=1 width=16)
                                                                                 ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_71 inventory_1_prt_71_1  (cost=0.00..32.00 rows=1 width=16)
                                                                                 ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_72 inventory_1_prt_72_1  (cost=0.00..32.00 rows=1 width=16)
                                                                                 ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_73 inventory_1_prt_73_1  (cost=0.00..32.00 rows=1 width=16)
                                                                                 ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_74 inventory_1_prt_74_1  (cost=0.00..32.00 rows=1 width=16)
                                                                                 ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_75 inventory_1_prt_75_1  (cost=0.00..32.00 rows=1 width=16)
                                                                                 ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_76 inventory_1_prt_76_1  (cost=0.00..32.00 rows=1 width=16)
                                                                                 ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_77 inventory_1_prt_77_1  (cost=0.00..32.00 rows=1 width=16)
                                                                                 ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_78 inventory_1_prt_78_1  (cost=0.00..32.00 rows=1 width=16)
                                                                                 ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_79 inventory_1_prt_79_1  (cost=0.00..32.00 rows=1 width=16)
                                                                                 ->  Result  (cost=0.00..32.00 rows=1 width=16)
                                                                                       One-Time Filter: PartSelected
                                                                                       ->  Append-only Scan on inventory_1_prt_80 inventory_1_prt_80_1  (cost=0.00..32.00 rows=1 width=16)
                                                                           ->  Hash  (cost=1455.98..1455.98 rows=107 width=8)
                                                                                 ->  Partition Selector for inventory (dynamic scan id: 1)  (cost=0.00..1455.98 rows=107 width=8)
                                                                                       Filter: date_dim_1.d_date_sk
                                                                                       ->  Broadcast Motion 3:3  (slice6; segments: 3)  (cost=0.00..1455.98 rows=107 width=8)
                                                                                             ->  Seq Scan on date_dim date_dim_1  (cost=0.00..1451.73 rows=36 width=8)
                                                                                                   Filter: ((d_year = 2002) AND (d_moy = 4))
                                                                     ->  Hash  (cost=17951.35..17951.35 rows=299247 width=4)
                                                                           ->  Broadcast Motion 3:3  (slice7; segments: 3)  (cost=0.00..17951.35 rows=299247 width=4)
                                                                                 ->  Seq Scan on item item_1  (cost=0.00..5981.47 rows=99749 width=4)
                                                               ->  Hash  (cost=16.00..16.00 rows=20 width=21)
                                                                     ->  Broadcast Motion 3:3  (slice8; segments: 3)  (cost=0.00..16.00 rows=20 width=21)
                                                                           ->  Seq Scan on warehouse warehouse_1  (cost=0.00..15.20 rows=7 width=21)
 Planning time: 20.507 ms
 Optimizer: legacy query optimizer
(549 rows)

with inv as
(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy
       ,stdev,mean, case mean when 0 then null else stdev/mean end cov
 from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy
            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean
      from inventory
          ,item
          ,warehouse
          ,date_dim
      where inv_item_sk = i_item_sk
        and inv_warehouse_sk = w_warehouse_sk
        and inv_date_sk = d_date_sk
        and d_year =2002
      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo
 where case mean when 0 then 0 else stdev/mean end > 1)
select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov
        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov
from inv inv1,inv inv2
where inv1.i_item_sk = inv2.i_item_sk
  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk
  and inv1.d_moy=3
  and inv2.d_moy=3+1
  and inv1.cov > 1.5
order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov
        ,inv2.d_moy,inv2.mean, inv2.cov
;
 w_warehouse_sk | i_item_sk | d_moy | mean | cov | w_warehouse_sk | i_item_sk | d_moy | mean | cov 
----------------+-----------+-------+------+-----+----------------+-----------+-------+------+-----
(0 rows)

-- end query 1 in stream 0 using template query39.tpl
