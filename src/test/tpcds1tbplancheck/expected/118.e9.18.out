-- start query 1 in stream 0 using template query18.tpl
explain
select  i_item_id,
        ca_country,
        ca_state, 
        ca_county,
        avg( cast(cs_quantity as numeric(12,2))) agg1,
        avg( cast(cs_list_price as numeric(12,2))) agg2,
        avg( cast(cs_coupon_amt as numeric(12,2))) agg3,
        avg( cast(cs_sales_price as numeric(12,2))) agg4,
        avg( cast(cs_net_profit as numeric(12,2))) agg5,
        avg( cast(c_birth_year as numeric(12,2))) agg6,
        avg( cast(cd1.cd_dep_count as numeric(12,2))) agg7
 from catalog_sales, customer_demographics cd1, 
      customer_demographics cd2, customer, customer_address, date_dim, item
 where cs_sold_date_sk = d_date_sk and
       cs_item_sk = i_item_sk and
       cs_bill_cdemo_sk = cd1.cd_demo_sk and
       cs_bill_customer_sk = c_customer_sk and
       cd1.cd_gender = 'M' and 
       cd1.cd_education_status = 'College' and
       c_current_cdemo_sk = cd2.cd_demo_sk and
       c_current_addr_sk = ca_address_sk and
       c_birth_month in (9,5,12,4,1,10) and
       d_year = 2001 and
       ca_state in ('ND','WI','AL'
                   ,'NC','OK','MS','TN')
 group by rollup (i_item_id, ca_country, ca_state, ca_county)
 order by ca_country,
        ca_state, 
        ca_county,
	i_item_id
 limit 100;
                                                                                                                                      QUERY PLAN                                                                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=32300460.41..32300462.66 rows=100 width=422)
   ->  Gather Motion 3:1  (slice8; segments: 3)  (cost=32300460.41..32300462.66 rows=100 width=422)
         Merge Key: partial_aggregation.ca_country, partial_aggregation.ca_state, partial_aggregation.ca_county, partial_aggregation.i_item_id
         ->  Limit  (cost=32300460.41..32300460.66 rows=34 width=422)
               ->  Sort  (cost=32300460.41..32301090.62 rows=84029 width=422)
                     Sort Key: partial_aggregation.ca_country, partial_aggregation.ca_state, partial_aggregation.ca_county, partial_aggregation.i_item_id
                     ->  HashAggregate  (cost=32277671.51..32290825.82 rows=84029 width=422)
                           Group Key: partial_aggregation.i_item_id, partial_aggregation.ca_country, partial_aggregation.ca_state, partial_aggregation.ca_county, partial_aggregation."grouping", partial_aggregation."group_id"
                           ->  Subquery Scan on partial_aggregation  (cost=32251961.59..32270528.51 rows=6464 width=434)
                                 ->  Redistribute Motion 3:3  (slice7; segments: 3)  (cost=32251961.59..32270334.60 rows=6464 width=434)
                                       Hash Key: "rollup".i_item_id, "rollup".ca_country, "rollup".ca_state, "rollup".ca_county
                                       ->  GroupAggregate  (cost=32251961.59..32269946.78 rows=6464 width=434)
                                             Group Key: "rollup"."grouping", "rollup"."group_id", "rollup".ca_state, "rollup".ca_county, "rollup".i_item_id, "rollup".ca_country
                                             ->  Subquery Scan on "rollup"  (cost=32251961.59..32268031.94 rows=9696 width=434)
                                                   ->  GroupAggregate  (cost=32251961.59..32267741.08 rows=9696 width=434)
                                                         Group Key: rollup_1.i_item_id, rollup_1."grouping", rollup_1."group_id", rollup_1.ca_county, rollup_1.ca_country, rollup_1.ca_state
                                                         ->  Subquery Scan on rollup_1  (cost=32251961.59..32265099.07 rows=12928 width=434)
                                                               ->  GroupAggregate  (cost=32251961.59..32264711.25 rows=12928 width=434)
                                                                     Group Key: rollup_2.i_item_id, rollup_2.ca_country, rollup_2."grouping", rollup_2."group_id", rollup_2.ca_state, rollup_2.ca_county
                                                                     ->  Subquery Scan on rollup_2  (cost=32251961.59..32261342.04 rows=16160 width=434)
                                                                           ->  GroupAggregate  (cost=32251961.59..32260857.26 rows=16160 width=434)
                                                                                 Group Key: rollup_3.i_item_id, rollup_3.ca_country, rollup_3.ca_state, rollup_3."grouping", rollup_3."group_id", rollup_3.ca_county
                                                                                 ->  Subquery Scan on rollup_3  (cost=32251961.59..32256760.90 rows=19391 width=434)
                                                                                       ->  GroupAggregate  (cost=32251961.59..32256179.17 rows=19391 width=434)
                                                                                             Group Key: item.i_item_id, customer_address.ca_country, customer_address.ca_state, customer_address.ca_county
                                                                                             ->  Sort  (cost=32251961.59..32252107.02 rows=19392 width=81)
                                                                                                   Sort Key: item.i_item_id, customer_address.ca_country, customer_address.ca_state, customer_address.ca_county
                                                                                                   ->  Hash Join  (cost=600057.28..32247357.68 rows=19392 width=81)
                                                                                                         Hash Cond: (catalog_sales_1_prt_outliers.cs_item_sk = item.i_item_sk)
                                                                                                         ->  Redistribute Motion 3:3  (slice6; segments: 3)  (cost=590335.23..32236835.73 rows=19392 width=68)
                                                                                                               Hash Key: catalog_sales_1_prt_outliers.cs_item_sk
                                                                                                               ->  Hash Join  (cost=590335.23..32235672.25 rows=19392 width=68)
                                                                                                                     Hash Cond: (customer.c_current_cdemo_sk = cd2.cd_demo_sk)
                                                                                                                     ->  Redistribute Motion 3:3  (slice5; segments: 3)  (cost=542704.68..32187164.23 rows=20114 width=72)
                                                                                                                           Hash Key: customer.c_current_cdemo_sk
                                                                                                                           ->  Hash Join  (cost=542704.68..32185957.42 rows=20114 width=72)
                                                                                                                                 Hash Cond: (customer.c_current_addr_sk = customer_address.ca_address_sk)
                                                                                                                                 ->  Redistribute Motion 3:3  (slice4; segments: 3)  (cost=391326.43..32032650.78 rows=116309 width=45)
                                                                                                                                       Hash Key: customer.c_current_addr_sk
                                                                                                                                       ->  Hash Join  (cost=391326.43..32025672.29 rows=116309 width=45)
                                                                                                                                             Hash Cond: (catalog_sales_1_prt_outliers.cs_bill_customer_sk = customer.c_customer_sk)
                                                                                                                                             ->  Redistribute Motion 3:3  (slice3; segments: 3)  (cost=49394.79..31673208.91 rows=239174 width=37)
                                                                                                                                                   Hash Key: catalog_sales_1_prt_outliers.cs_bill_customer_sk
                                                                                                                                                   ->  Hash Join  (cost=49394.79..31658858.48 rows=239174 width=37)
                                                                                                                                                         Hash Cond: (catalog_sales_1_prt_outliers.cs_bill_cdemo_sk = cd1.cd_demo_sk)
                                                                                                                                                         ->  Hash Join  (cost=1297.42..31558586.51 rows=2399968 width=37)
                                                                                                                                                               Hash Cond: (catalog_sales_1_prt_outliers.cs_sold_date_sk = date_dim.d_date_sk)
                                                                                                                                                               ->  Append  (cost=0.00..22485412.30 rows=479993481 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..95971.30 rows=2401110 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_outliers  (cost=0.00..95971.30 rows=2401110 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198531.00 rows=4234734 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_2  (cost=0.00..198531.00 rows=4234734 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198470.00 rows=4233434 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_3  (cost=0.00..198470.00 rows=4233434 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..191463.00 rows=4083934 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_4  (cost=0.00..191463.00 rows=4083934 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198330.00 rows=4230434 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_5  (cost=0.00..198330.00 rows=4230434 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198496.00 rows=4233967 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_6  (cost=0.00..198496.00 rows=4233967 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198494.00 rows=4233967 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_7  (cost=0.00..198494.00 rows=4233967 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198576.00 rows=4235667 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_8  (cost=0.00..198576.00 rows=4235667 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..297942.00 rows=6355400 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_9  (cost=0.00..297942.00 rows=6355400 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..451674.00 rows=9634834 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_10  (cost=0.00..451674.00 rows=9634834 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..451572.00 rows=9632700 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_11  (cost=0.00..451572.00 rows=9632700 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..476631.00 rows=10167234 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_12  (cost=0.00..476631.00 rows=10167234 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..684375.00 rows=14598867 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_13  (cost=0.00..684375.00 rows=14598867 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..684389.00 rows=14599200 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_14  (cost=0.00..684389.00 rows=14599200 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..215804.00 rows=4603234 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_15  (cost=0.00..215804.00 rows=4603234 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198278.00 rows=4229400 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_16  (cost=0.00..198278.00 rows=4229400 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..191360.00 rows=4081734 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_17  (cost=0.00..191360.00 rows=4081734 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198408.00 rows=4232134 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_18  (cost=0.00..198408.00 rows=4232134 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198462.00 rows=4233300 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_19  (cost=0.00..198462.00 rows=4233300 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198463.00 rows=4233267 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_20  (cost=0.00..198463.00 rows=4233267 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198544.00 rows=4235034 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_21  (cost=0.00..198544.00 rows=4235034 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..288857.00 rows=6161600 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_22  (cost=0.00..288857.00 rows=6161600 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..451775.00 rows=9637067 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_23  (cost=0.00..451775.00 rows=9637067 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..451807.00 rows=9637734 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_24  (cost=0.00..451807.00 rows=9637734 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..468431.00 rows=9992300 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_25  (cost=0.00..468431.00 rows=9992300 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..684511.00 rows=14601800 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_26  (cost=0.00..684511.00 rows=14601800 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..684485.00 rows=14601267 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_27  (cost=0.00..684485.00 rows=14601267 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..232955.00 rows=4969100 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_28  (cost=0.00..232955.00 rows=4969100 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198182.00 rows=4227400 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_29  (cost=0.00..198182.00 rows=4227400 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198180.00 rows=4227300 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_30  (cost=0.00..198180.00 rows=4227300 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198236.00 rows=4228467 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_31  (cost=0.00..198236.00 rows=4228467 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198161.00 rows=4226867 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_32  (cost=0.00..198161.00 rows=4226867 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198143.00 rows=4226467 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_33  (cost=0.00..198143.00 rows=4226467 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198217.00 rows=4228000 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_34  (cost=0.00..198217.00 rows=4228000 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..279401.00 rows=5959900 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_35  (cost=0.00..279401.00 rows=5959900 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..451102.00 rows=9622600 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_36  (cost=0.00..451102.00 rows=9622600 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..451004.00 rows=9620567 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_37  (cost=0.00..451004.00 rows=9620567 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..459207.00 rows=9795567 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_38  (cost=0.00..459207.00 rows=9795567 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..683201.00 rows=14573867 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_39  (cost=0.00..683201.00 rows=14573867 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..683288.00 rows=14575634 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_40  (cost=0.00..683288.00 rows=14575634 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..267716.00 rows=5710600 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_41  (cost=0.00..267716.00 rows=5710600 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198348.00 rows=4230867 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_42  (cost=0.00..198348.00 rows=4230867 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..191374.00 rows=4082034 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_43  (cost=0.00..191374.00 rows=4082034 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198449.00 rows=4233067 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_44  (cost=0.00..198449.00 rows=4233067 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198436.00 rows=4232667 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_45  (cost=0.00..198436.00 rows=4232667 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198484.00 rows=4233767 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_46  (cost=0.00..198484.00 rows=4233767 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198486.00 rows=4233767 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_47  (cost=0.00..198486.00 rows=4233767 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..261759.00 rows=5583500 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_48  (cost=0.00..261759.00 rows=5583500 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..451867.00 rows=9638934 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_49  (cost=0.00..451867.00 rows=9638934 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..451711.00 rows=9635634 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_50  (cost=0.00..451711.00 rows=9635634 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..451715.00 rows=9635700 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_51  (cost=0.00..451715.00 rows=9635700 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..676048.00 rows=14421300 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_52  (cost=0.00..676048.00 rows=14421300 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..684330.00 rows=14597934 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_53  (cost=0.00..684330.00 rows=14597934 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..285353.00 rows=6086800 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_54  (cost=0.00..285353.00 rows=6086800 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198500.00 rows=4234067 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_55  (cost=0.00..198500.00 rows=4234067 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..191327.00 rows=4081100 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_56  (cost=0.00..191327.00 rows=4081100 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198470.00 rows=4233434 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_57  (cost=0.00..198470.00 rows=4233434 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198434.00 rows=4232667 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_58  (cost=0.00..198434.00 rows=4232667 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198457.00 rows=4233100 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_59  (cost=0.00..198457.00 rows=4233100 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..198420.00 rows=4232400 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_60  (cost=0.00..198420.00 rows=4232400 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..252732.00 rows=5390967 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_61  (cost=0.00..252732.00 rows=5390967 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..451735.00 rows=9636134 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_62  (cost=0.00..451735.00 rows=9636134 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..451761.00 rows=9636700 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_63  (cost=0.00..451761.00 rows=9636700 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..451680.00 rows=9634900 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_64  (cost=0.00..451680.00 rows=9634900 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..667727.00 rows=14243734 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_65  (cost=0.00..667727.00 rows=14243734 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..684173.00 rows=14594534 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_66  (cost=0.00..684173.00 rows=14594534 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..244531.00 rows=5216100 width=41)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_67  (cost=0.00..244531.00 rows=5216100 width=41)
                                                                                                                                                                     ->  Result  (cost=0.00..1.00 rows=1 width=76)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_68  (cost=0.00..1.00 rows=1 width=76)
                                                                                                                                                                     ->  Result  (cost=0.00..1.00 rows=1 width=76)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_69  (cost=0.00..1.00 rows=1 width=76)
                                                                                                                                                                     ->  Result  (cost=0.00..1.00 rows=1 width=76)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_70  (cost=0.00..1.00 rows=1 width=76)
                                                                                                                                                                     ->  Result  (cost=0.00..1.00 rows=1 width=76)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_71  (cost=0.00..1.00 rows=1 width=76)
                                                                                                                                                                     ->  Result  (cost=0.00..1.00 rows=1 width=76)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_72  (cost=0.00..1.00 rows=1 width=76)
                                                                                                                                                                     ->  Result  (cost=0.00..1.00 rows=1 width=76)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_73  (cost=0.00..1.00 rows=1 width=76)
                                                                                                                                                                     ->  Result  (cost=0.00..1.00 rows=1 width=76)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_74  (cost=0.00..1.00 rows=1 width=76)
                                                                                                                                                                     ->  Result  (cost=0.00..1.00 rows=1 width=76)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_75  (cost=0.00..1.00 rows=1 width=76)
                                                                                                                                                                     ->  Result  (cost=0.00..1.00 rows=1 width=76)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_76  (cost=0.00..1.00 rows=1 width=76)
                                                                                                                                                                     ->  Result  (cost=0.00..1.00 rows=1 width=76)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_77  (cost=0.00..1.00 rows=1 width=76)
                                                                                                                                                                     ->  Result  (cost=0.00..1.00 rows=1 width=76)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_78  (cost=0.00..1.00 rows=1 width=76)
                                                                                                                                                                     ->  Result  (cost=0.00..1.00 rows=1 width=76)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_79  (cost=0.00..1.00 rows=1 width=76)
                                                                                                                                                                     ->  Result  (cost=0.00..1.00 rows=1 width=76)
                                                                                                                                                                           One-Time Filter: PartSelected
                                                                                                                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_80  (cost=0.00..1.00 rows=1 width=76)
                                                                                                                                                               ->  Hash  (cost=1283.72..1283.72 rows=366 width=4)
                                                                                                                                                                     ->  Partition Selector for catalog_sales (dynamic scan id: 1)  (cost=0.00..1283.72 rows=366 width=4)
                                                                                                                                                                           Filter: date_dim.d_date_sk
                                                                                                                                                                           ->  Broadcast Motion 3:3  (slice1; segments: 3)  (cost=0.00..1283.72 rows=366 width=4)
                                                                                                                                                                                 ->  Seq Scan on date_dim  (cost=0.00..1269.11 rows=122 width=4)
                                                                                                                                                                                       Filter: (d_year = 2001)
                                                                                                                                                         ->  Hash  (cost=40900.92..40900.92 rows=191906 width=8)
                                                                                                                                                               ->  Broadcast Motion 3:3  (slice2; segments: 3)  (cost=0.00..40900.92 rows=191906 width=8)
                                                                                                                                                                     ->  Seq Scan on customer_demographics cd1  (cost=0.00..33224.70 rows=63969 width=8)
                                                                                                                                                                           Filter: ((cd_gender = 'M'::bpchar) AND ((cd_education_status)::text = 'College'::text))
                                                                                                                                             ->  Hash  (cost=268781.25..268781.25 rows=1950677 width=16)
                                                                                                                                                   ->  Seq Scan on customer  (cost=0.00..268781.25 rows=1950677 width=16)
                                                                                                                                                         Filter: (c_birth_month = ANY ('{9,5,12,4,1,10}'::integer[]))
                                                                                                                                 ->  Hash  (cost=138404.81..138404.81 rows=345959 width=35)
                                                                                                                                       ->  Seq Scan on customer_address  (cost=0.00..138404.81 rows=345959 width=35)
                                                                                                                                             Filter: ((ca_state)::text = ANY ('{ND,WI,AL,NC,OK,MS,TN}'::text[]))
                                                                                                                     ->  Hash  (cost=23620.80..23620.80 rows=640260 width=4)
                                                                                                                           ->  Seq Scan on customer_demographics cd2  (cost=0.00..23620.80 rows=640260 width=4)
                                                                                                         ->  Hash  (cost=5981.47..5981.47 rows=99749 width=21)
                                                                                                               ->  Seq Scan on item  (cost=0.00..5981.47 rows=99749 width=21)
 Planning time: 44.146 ms
 Optimizer: legacy query optimizer
(310 rows)

-- end query 1 in stream 0 using template query18.tpl
