-- start query 1 in stream 0 using template query16.tpl
explain
select  
   count(distinct cs_order_number) as "order count"
  ,sum(cs_ext_ship_cost) as "total shipping cost"
  ,sum(cs_net_profit) as "total net profit"
from
   catalog_sales cs1
  ,date_dim
  ,customer_address
  ,call_center
where
    d_date between '2002-4-01' and 
           (cast('2002-4-01' as date) + 60 )
and cs1.cs_ship_date_sk = d_date_sk
and cs1.cs_ship_addr_sk = ca_address_sk
and ca_state = 'TN'
and cs1.cs_call_center_sk = cc_call_center_sk
and cc_county in ('Walker County','Oglethorpe County','Huron County','Wadena County',
                  'Ziebach County'
)
and exists (select *
            from catalog_sales cs2
            where cs1.cs_order_number = cs2.cs_order_number
              and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)
and not exists(select *
               from catalog_returns cr1
               where cs1.cs_order_number = cr1.cr_order_number)
order by count(distinct cs_order_number)
limit 100;
                                                                                                                                    QUERY PLAN                                                                                                                                    
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=66735270.28..66735270.29 rows=1 width=72)
   ->  Sort  (cost=66735270.28..66735270.29 rows=1 width=72)
         Sort Key: (count((count(DISTINCT cs1.cs_order_number))))
         ->  Aggregate  (cost=66735270.26..66735270.27 rows=1 width=72)
               ->  Gather Motion 3:1  (slice9; segments: 3)  (cost=66735270.19..66735270.24 rows=1 width=72)
                     ->  Aggregate  (cost=66735270.19..66735270.20 rows=1 width=72)
                           ->  Redistribute Motion 3:3  (slice8; segments: 3)  (cost=66735260.57..66735269.98 rows=10 width=20)
                                 Hash Key: cs1.cs_order_number
                                 ->  Hash Anti Join  (cost=66735260.57..66735269.44 rows=10 width=20)
                                       Hash Cond: (cs1.cs_order_number = cr1.cr_order_number)
                                       ->  Redistribute Motion 3:3  (slice6; segments: 3)  (cost=60006659.63..60006661.15 rows=11 width=64)
                                             Hash Key: cs1.cs_order_number
                                             ->  HashAggregate  (cost=60006660.77..60006661.07 rows=11 width=80)
                                                   Group Key: (cs1.ctid)::bigint, (date_dim.ctid)::bigint, (customer_address.ctid)::bigint, (call_center.ctid)::bigint, cs1.gp_segment_id, (2), date_dim.gp_segment_id, customer_address.gp_segment_id, call_center.gp_segment_id
                                                   ->  Result  (cost=31623135.57..60006660.09 rows=11 width=64)
                                                         ->  Redistribute Motion 3:3  (slice5; segments: 3)  (cost=31623135.57..60006660.09 rows=11 width=64)
                                                               Hash Key: cs1.ctid, date_dim.ctid, customer_address.ctid, call_center.ctid
                                                               ->  Hash Join  (cost=31623135.57..60006659.48 rows=11 width=64)
                                                                     Hash Cond: (cs2.cs_order_number = cs1.cs_order_number)
                                                                     Join Filter: (cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)
                                                                     ->  Append  (cost=0.00..22485412.30 rows=479993481 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_outliers cs2  (cost=0.00..95971.30 rows=2401110 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_2 cs2_1  (cost=0.00..198531.00 rows=4234734 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_3 cs2_2  (cost=0.00..198470.00 rows=4233434 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_4 cs2_3  (cost=0.00..191463.00 rows=4083934 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_5 cs2_4  (cost=0.00..198330.00 rows=4230434 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_6 cs2_5  (cost=0.00..198496.00 rows=4233967 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_7 cs2_6  (cost=0.00..198494.00 rows=4233967 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_8 cs2_7  (cost=0.00..198576.00 rows=4235667 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_9 cs2_8  (cost=0.00..297942.00 rows=6355400 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_10 cs2_9  (cost=0.00..451674.00 rows=9634834 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_11 cs2_10  (cost=0.00..451572.00 rows=9632700 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_12 cs2_11  (cost=0.00..476631.00 rows=10167234 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_13 cs2_12  (cost=0.00..684375.00 rows=14598867 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_14 cs2_13  (cost=0.00..684389.00 rows=14599200 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_15 cs2_14  (cost=0.00..215804.00 rows=4603234 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_16 cs2_15  (cost=0.00..198278.00 rows=4229400 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_17 cs2_16  (cost=0.00..191360.00 rows=4081734 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_18 cs2_17  (cost=0.00..198408.00 rows=4232134 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_19 cs2_18  (cost=0.00..198462.00 rows=4233300 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_20 cs2_19  (cost=0.00..198463.00 rows=4233267 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_21 cs2_20  (cost=0.00..198544.00 rows=4235034 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_22 cs2_21  (cost=0.00..288857.00 rows=6161600 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_23 cs2_22  (cost=0.00..451775.00 rows=9637067 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_24 cs2_23  (cost=0.00..451807.00 rows=9637734 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_25 cs2_24  (cost=0.00..468431.00 rows=9992300 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_26 cs2_25  (cost=0.00..684511.00 rows=14601800 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_27 cs2_26  (cost=0.00..684485.00 rows=14601267 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_28 cs2_27  (cost=0.00..232955.00 rows=4969100 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_29 cs2_28  (cost=0.00..198182.00 rows=4227400 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_30 cs2_29  (cost=0.00..198180.00 rows=4227300 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_31 cs2_30  (cost=0.00..198236.00 rows=4228467 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_32 cs2_31  (cost=0.00..198161.00 rows=4226867 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_33 cs2_32  (cost=0.00..198143.00 rows=4226467 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_34 cs2_33  (cost=0.00..198217.00 rows=4228000 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_35 cs2_34  (cost=0.00..279401.00 rows=5959900 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_36 cs2_35  (cost=0.00..451102.00 rows=9622600 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_37 cs2_36  (cost=0.00..451004.00 rows=9620567 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_38 cs2_37  (cost=0.00..459207.00 rows=9795567 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_39 cs2_38  (cost=0.00..683201.00 rows=14573867 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_40 cs2_39  (cost=0.00..683288.00 rows=14575634 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_41 cs2_40  (cost=0.00..267716.00 rows=5710600 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_42 cs2_41  (cost=0.00..198348.00 rows=4230867 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_43 cs2_42  (cost=0.00..191374.00 rows=4082034 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_44 cs2_43  (cost=0.00..198449.00 rows=4233067 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_45 cs2_44  (cost=0.00..198436.00 rows=4232667 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_46 cs2_45  (cost=0.00..198484.00 rows=4233767 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_47 cs2_46  (cost=0.00..198486.00 rows=4233767 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_48 cs2_47  (cost=0.00..261759.00 rows=5583500 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_49 cs2_48  (cost=0.00..451867.00 rows=9638934 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_50 cs2_49  (cost=0.00..451711.00 rows=9635634 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_51 cs2_50  (cost=0.00..451715.00 rows=9635700 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_52 cs2_51  (cost=0.00..676048.00 rows=14421300 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_53 cs2_52  (cost=0.00..684330.00 rows=14597934 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_54 cs2_53  (cost=0.00..285353.00 rows=6086800 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_55 cs2_54  (cost=0.00..198500.00 rows=4234067 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_56 cs2_55  (cost=0.00..191327.00 rows=4081100 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_57 cs2_56  (cost=0.00..198470.00 rows=4233434 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_58 cs2_57  (cost=0.00..198434.00 rows=4232667 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_59 cs2_58  (cost=0.00..198457.00 rows=4233100 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_60 cs2_59  (cost=0.00..198420.00 rows=4232400 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_61 cs2_60  (cost=0.00..252732.00 rows=5390967 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_62 cs2_61  (cost=0.00..451735.00 rows=9636134 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_63 cs2_62  (cost=0.00..451761.00 rows=9636700 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_64 cs2_63  (cost=0.00..451680.00 rows=9634900 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_65 cs2_64  (cost=0.00..667727.00 rows=14243734 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_66 cs2_65  (cost=0.00..684173.00 rows=14594534 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_67 cs2_66  (cost=0.00..244531.00 rows=5216100 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_68 cs2_67  (cost=0.00..1.00 rows=1 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_69 cs2_68  (cost=0.00..1.00 rows=1 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_70 cs2_69  (cost=0.00..1.00 rows=1 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_71 cs2_70  (cost=0.00..1.00 rows=1 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_72 cs2_71  (cost=0.00..1.00 rows=1 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_73 cs2_72  (cost=0.00..1.00 rows=1 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_74 cs2_73  (cost=0.00..1.00 rows=1 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_75 cs2_74  (cost=0.00..1.00 rows=1 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_76 cs2_75  (cost=0.00..1.00 rows=1 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_77 cs2_76  (cost=0.00..1.00 rows=1 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_78 cs2_77  (cost=0.00..1.00 rows=1 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_79 cs2_78  (cost=0.00..1.00 rows=1 width=12)
                                                                           ->  Append-only Columnar Scan on catalog_sales_1_prt_80 cs2_79  (cost=0.00..1.00 rows=1 width=12)
                                                                     ->  Hash  (cost=31622900.05..31622900.05 rows=6281 width=68)
                                                                           ->  Broadcast Motion 3:3  (slice4; segments: 3)  (cost=116714.96..31622900.05 rows=6281 width=68)
                                                                                 ->  Hash Join  (cost=116714.96..31622648.82 rows=2094 width=68)
                                                                                       Hash Cond: (cs1.cs_call_center_sk = call_center.cc_call_center_sk)
                                                                                       ->  Hash Join  (cost=116692.74..31622327.58 rows=12598 width=62)
                                                                                             Hash Cond: (cs1.cs_ship_addr_sk = customer_address.ca_address_sk)
                                                                                             ->  Hash Join  (cost=1456.58..31499033.93 rows=409577 width=56)
                                                                                                   Hash Cond: (cs1.cs_ship_date_sk = date_dim.d_date_sk)
                                                                                                   ->  Append  (cost=0.00..22485412.30 rows=479993481 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_outliers cs1  (cost=0.00..95971.30 rows=2401110 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_2 cs1_1  (cost=0.00..198531.00 rows=4234734 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_3 cs1_2  (cost=0.00..198470.00 rows=4233434 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_4 cs1_3  (cost=0.00..191463.00 rows=4083934 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_5 cs1_4  (cost=0.00..198330.00 rows=4230434 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_6 cs1_5  (cost=0.00..198496.00 rows=4233967 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_7 cs1_6  (cost=0.00..198494.00 rows=4233967 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_8 cs1_7  (cost=0.00..198576.00 rows=4235667 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_9 cs1_8  (cost=0.00..297942.00 rows=6355400 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_10 cs1_9  (cost=0.00..451674.00 rows=9634834 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_11 cs1_10  (cost=0.00..451572.00 rows=9632700 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_12 cs1_11  (cost=0.00..476631.00 rows=10167234 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_13 cs1_12  (cost=0.00..684375.00 rows=14598867 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_14 cs1_13  (cost=0.00..684389.00 rows=14599200 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_15 cs1_14  (cost=0.00..215804.00 rows=4603234 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_16 cs1_15  (cost=0.00..198278.00 rows=4229400 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_17 cs1_16  (cost=0.00..191360.00 rows=4081734 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_18 cs1_17  (cost=0.00..198408.00 rows=4232134 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_19 cs1_18  (cost=0.00..198462.00 rows=4233300 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_20 cs1_19  (cost=0.00..198463.00 rows=4233267 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_21 cs1_20  (cost=0.00..198544.00 rows=4235034 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_22 cs1_21  (cost=0.00..288857.00 rows=6161600 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_23 cs1_22  (cost=0.00..451775.00 rows=9637067 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_24 cs1_23  (cost=0.00..451807.00 rows=9637734 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_25 cs1_24  (cost=0.00..468431.00 rows=9992300 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_26 cs1_25  (cost=0.00..684511.00 rows=14601800 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_27 cs1_26  (cost=0.00..684485.00 rows=14601267 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_28 cs1_27  (cost=0.00..232955.00 rows=4969100 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_29 cs1_28  (cost=0.00..198182.00 rows=4227400 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_30 cs1_29  (cost=0.00..198180.00 rows=4227300 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_31 cs1_30  (cost=0.00..198236.00 rows=4228467 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_32 cs1_31  (cost=0.00..198161.00 rows=4226867 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_33 cs1_32  (cost=0.00..198143.00 rows=4226467 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_34 cs1_33  (cost=0.00..198217.00 rows=4228000 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_35 cs1_34  (cost=0.00..279401.00 rows=5959900 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_36 cs1_35  (cost=0.00..451102.00 rows=9622600 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_37 cs1_36  (cost=0.00..451004.00 rows=9620567 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_38 cs1_37  (cost=0.00..459207.00 rows=9795567 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_39 cs1_38  (cost=0.00..683201.00 rows=14573867 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_40 cs1_39  (cost=0.00..683288.00 rows=14575634 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_41 cs1_40  (cost=0.00..267716.00 rows=5710600 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_42 cs1_41  (cost=0.00..198348.00 rows=4230867 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_43 cs1_42  (cost=0.00..191374.00 rows=4082034 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_44 cs1_43  (cost=0.00..198449.00 rows=4233067 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_45 cs1_44  (cost=0.00..198436.00 rows=4232667 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_46 cs1_45  (cost=0.00..198484.00 rows=4233767 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_47 cs1_46  (cost=0.00..198486.00 rows=4233767 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_48 cs1_47  (cost=0.00..261759.00 rows=5583500 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_49 cs1_48  (cost=0.00..451867.00 rows=9638934 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_50 cs1_49  (cost=0.00..451711.00 rows=9635634 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_51 cs1_50  (cost=0.00..451715.00 rows=9635700 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_52 cs1_51  (cost=0.00..676048.00 rows=14421300 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_53 cs1_52  (cost=0.00..684330.00 rows=14597934 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_54 cs1_53  (cost=0.00..285353.00 rows=6086800 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_55 cs1_54  (cost=0.00..198500.00 rows=4234067 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_56 cs1_55  (cost=0.00..191327.00 rows=4081100 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_57 cs1_56  (cost=0.00..198470.00 rows=4233434 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_58 cs1_57  (cost=0.00..198434.00 rows=4232667 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_59 cs1_58  (cost=0.00..198457.00 rows=4233100 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_60 cs1_59  (cost=0.00..198420.00 rows=4232400 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_61 cs1_60  (cost=0.00..252732.00 rows=5390967 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_62 cs1_61  (cost=0.00..451735.00 rows=9636134 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_63 cs1_62  (cost=0.00..451761.00 rows=9636700 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_64 cs1_63  (cost=0.00..451680.00 rows=9634900 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_65 cs1_64  (cost=0.00..667727.00 rows=14243734 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_66 cs1_65  (cost=0.00..684173.00 rows=14594534 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_67 cs1_66  (cost=0.00..244531.00 rows=5216100 width=50)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_68 cs1_67  (cost=0.00..1.00 rows=1 width=66)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_69 cs1_68  (cost=0.00..1.00 rows=1 width=66)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_70 cs1_69  (cost=0.00..1.00 rows=1 width=66)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_71 cs1_70  (cost=0.00..1.00 rows=1 width=66)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_72 cs1_71  (cost=0.00..1.00 rows=1 width=66)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_73 cs1_72  (cost=0.00..1.00 rows=1 width=66)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_74 cs1_73  (cost=0.00..1.00 rows=1 width=66)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_75 cs1_74  (cost=0.00..1.00 rows=1 width=66)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_76 cs1_75  (cost=0.00..1.00 rows=1 width=66)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_77 cs1_76  (cost=0.00..1.00 rows=1 width=66)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_78 cs1_77  (cost=0.00..1.00 rows=1 width=66)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_79 cs1_78  (cost=0.00..1.00 rows=1 width=66)
                                                                                                         ->  Append-only Columnar Scan on catalog_sales_1_prt_80 cs1_79  (cost=0.00..1.00 rows=1 width=66)
                                                                                                   ->  Hash  (cost=1454.24..1454.24 rows=63 width=14)
                                                                                                         ->  Broadcast Motion 3:3  (slice1; segments: 3)  (cost=0.00..1454.24 rows=63 width=14)
                                                                                                               ->  Seq Scan on date_dim  (cost=0.00..1451.73 rows=21 width=14)
                                                                                                                     Filter: ((d_date >= '04-01-2002'::date) AND (d_date <= '05-31-2002'::date))
                                                                                             ->  Hash  (cost=108296.83..108296.83 rows=185049 width=14)
                                                                                                   ->  Broadcast Motion 3:3  (slice2; segments: 3)  (cost=0.00..108296.83 rows=185049 width=14)
                                                                                                         ->  Seq Scan on customer_address  (cost=0.00..100894.88 rows=61683 width=14)
                                                                                                               Filter: ((ca_state)::text = 'TN'::text)
                                                                                       ->  Hash  (cost=21.96..21.96 rows=7 width=14)
                                                                                             ->  Broadcast Motion 3:3  (slice3; segments: 3)  (cost=0.00..21.96 rows=7 width=14)
                                                                                                   ->  Seq Scan on call_center  (cost=0.00..21.68 rows=3 width=14)
                                                                                                         Filter: ((cc_county)::text = ANY ('{"Walker County","Oglethorpe County","Huron County","Wadena County","Ziebach County"}'::text[]))
                                       ->  Hash  (cost=4928641.83..4928641.83 rows=47998910 width=8)
                                             ->  Redistribute Motion 3:3  (slice7; segments: 3)  (cost=0.00..4928641.83 rows=47998910 width=8)
                                                   Hash Key: cr1.cr_order_number
                                                   ->  Append  (cost=0.00..2048707.25 rows=47998910 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_outliers cr1  (cost=0.00..1.00 rows=1 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_2 cr1_1  (cost=0.00..89.94 rows=1932 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_3 cr1_2  (cost=0.00..839.14 rows=19405 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_4 cr1_3  (cost=0.00..2485.51 rows=57851 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_5 cr1_4  (cost=0.00..4960.98 rows=115933 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_6 cr1_5  (cost=0.00..7782.08 rows=182003 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_7 cr1_6  (cost=0.00..10621.88 rows=248696 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_8 cr1_7  (cost=0.00..13478.93 rows=315565 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_9 cr1_8  (cost=0.00..15896.40 rows=372214 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_10 cr1_9  (cost=0.00..17750.30 rows=415710 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_11 cr1_10  (cost=0.00..19794.70 rows=463690 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_12 cr1_11  (cost=0.00..22437.10 rows=525604 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_13 cr1_12  (cost=0.00..26080.50 rows=611050 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_14 cr1_13  (cost=0.00..30734.10 rows=720170 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_15 cr1_14  (cost=0.00..36307.80 rows=850860 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_16 cr1_15  (cost=0.00..41041.30 rows=961744 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_17 cr1_16  (cost=0.00..43099.50 rows=1009950 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_18 cr1_17  (cost=0.00..41879.10 rows=981337 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_19 cr1_18  (cost=0.00..38497.60 rows=902120 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_20 cr1_19  (cost=0.00..34174.60 rows=800720 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_21 cr1_20  (cost=0.00..28866.00 rows=676300 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_22 cr1_21  (cost=0.00..23528.20 rows=551174 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_23 cr1_22  (cost=0.00..20118.40 rows=471247 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_24 cr1_23  (cost=0.00..19874.50 rows=465584 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_25 cr1_24  (cost=0.00..22296.70 rows=522290 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_26 cr1_25  (cost=0.00..25917.20 rows=607140 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_27 cr1_26  (cost=0.00..30522.50 rows=715184 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_28 cr1_27  (cost=0.00..36052.80 rows=844894 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_29 cr1_28  (cost=0.00..40956.30 rows=959777 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_30 cr1_29  (cost=0.00..43148.40 rows=1011214 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_31 cr1_30  (cost=0.00..42010.00 rows=984434 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_32 cr1_31  (cost=0.00..38722.30 rows=907377 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_33 cr1_32  (cost=0.00..34426.40 rows=806647 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_34 cr1_33  (cost=0.00..29177.30 rows=683644 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_35 cr1_34  (cost=0.00..23787.80 rows=557327 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_36 cr1_35  (cost=0.00..20236.00 rows=474067 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_37 cr1_36  (cost=0.00..19907.20 rows=466240 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_38 cr1_37  (cost=0.00..22185.10 rows=519704 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_39 cr1_38  (cost=0.00..25740.00 rows=603100 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_40 cr1_39  (cost=0.00..30341.40 rows=710914 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_41 cr1_40  (cost=0.00..35869.30 rows=840477 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_42 cr1_41  (cost=0.00..40858.00 rows=957467 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_43 cr1_42  (cost=0.00..43189.40 rows=1012114 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_44 cr1_43  (cost=0.00..42208.80 rows=989160 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_45 cr1_44  (cost=0.00..39037.10 rows=914804 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_46 cr1_45  (cost=0.00..34783.00 rows=815100 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_47 cr1_46  (cost=0.00..29479.40 rows=690714 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_48 cr1_47  (cost=0.00..24074.70 rows=564057 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_49 cr1_48  (cost=0.00..20308.20 rows=475707 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_50 cr1_49  (cost=0.00..19762.20 rows=462907 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_51 cr1_50  (cost=0.00..21941.80 rows=513960 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_52 cr1_51  (cost=0.00..25524.00 rows=598034 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_53 cr1_52  (cost=0.00..29988.40 rows=702614 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_54 cr1_53  (cost=0.00..35472.20 rows=831174 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_55 cr1_54  (cost=0.00..40521.40 rows=949514 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_56 cr1_55  (cost=0.00..43037.90 rows=1008564 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_57 cr1_56  (cost=0.00..42199.20 rows=988874 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_58 cr1_57  (cost=0.00..39131.90 rows=916964 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_59 cr1_58  (cost=0.00..34896.90 rows=817730 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_60 cr1_59  (cost=0.00..29665.40 rows=695080 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_61 cr1_60  (cost=0.00..24208.60 rows=567154 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_62 cr1_61  (cost=0.00..20387.30 rows=477644 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_63 cr1_62  (cost=0.00..19741.20 rows=462340 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_64 cr1_63  (cost=0.00..21867.20 rows=512274 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_65 cr1_64  (cost=0.00..25350.50 rows=593884 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_66 cr1_65  (cost=0.00..29837.00 rows=699100 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_67 cr1_66  (cost=0.00..35270.90 rows=826464 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_68 cr1_67  (cost=0.00..40185.20 rows=941674 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_69 cr1_68  (cost=0.00..41789.50 rows=979317 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_70 cr1_69  (cost=0.00..39187.40 rows=918347 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_71 cr1_70  (cost=0.00..33506.60 rows=785120 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_72 cr1_71  (cost=0.00..26483.20 rows=620407 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_73 cr1_72  (cost=0.00..18408.20 rows=431207 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_74 cr1_73  (cost=0.00..10161.74 rows=237858 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_75 cr1_74  (cost=0.00..3892.67 rows=90823 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_76 cr1_75  (cost=0.00..672.49 rows=15283 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_77 cr1_76  (cost=0.00..38.39 rows=213 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_78 cr1_77  (cost=0.00..1.00 rows=1 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_79 cr1_78  (cost=0.00..1.00 rows=1 width=8)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_80 cr1_79  (cost=0.00..1.00 rows=1 width=8)
 Planning time: 70.680 ms
 Optimizer: legacy query optimizer
(288 rows)

-- end query 1 in stream 0 using template query16.tpl
