-- start query 1 in stream 0 using template query91.tpl
explain
select  
        cc_call_center_id Call_Center,
        cc_name Call_Center_Name,
        cc_manager Manager,
        sum(cr_net_loss) Returns_Loss
from
        call_center,
        catalog_returns,
        date_dim,
        customer,
        customer_address,
        customer_demographics,
        household_demographics
where
        cr_call_center_sk       = cc_call_center_sk
and     cr_returned_date_sk     = d_date_sk
and     cr_returning_customer_sk= c_customer_sk
and     cd_demo_sk              = c_current_cdemo_sk
and     hd_demo_sk              = c_current_hdemo_sk
and     ca_address_sk           = c_current_addr_sk
and     d_year                  = 1999 
and     d_moy                   = 11
and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')
        or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))
and     hd_buy_potential like '0-500%'
and     ca_gmt_offset           = -7
group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status
order by sum(cr_net_loss) desc;
                                                                                                                                               QUERY PLAN                                                                                                                                               
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Gather Motion 3:1  (slice8; segments: 3)  (cost=3053150.23..3053150.54 rows=124 width=364)
   Merge Key: (pg_catalog.sum((sum(catalog_returns_1_prt_outliers.cr_net_loss))))
   ->  Sort  (cost=3053150.23..3053150.54 rows=42 width=364)
         Sort Key: (pg_catalog.sum((sum(catalog_returns_1_prt_outliers.cr_net_loss))))
         ->  HashAggregate  (cost=3053144.37..3053145.92 rows=42 width=364)
               Group Key: call_center.cc_call_center_id, call_center.cc_name, call_center.cc_manager, customer_demographics.cd_marital_status, customer_demographics.cd_education_status
               ->  Redistribute Motion 3:3  (slice7; segments: 3)  (cost=3053138.79..3053141.27 rows=42 width=364)
                     Hash Key: call_center.cc_call_center_id, call_center.cc_name, call_center.cc_manager, customer_demographics.cd_marital_status, customer_demographics.cd_education_status
                     ->  HashAggregate  (cost=3053138.79..3053138.79 rows=42 width=364)
                           Group Key: call_center.cc_call_center_id, call_center.cc_name, call_center.cc_manager, customer_demographics.cd_marital_status, customer_demographics.cd_education_status
                           ->  Hash Join  (cost=459632.25..3053132.53 rows=140 width=62)
                                 Hash Cond: (catalog_returns_1_prt_outliers.cr_call_center_sk = call_center.cc_call_center_sk)
                                 ->  Hash Join  (cost=459607.58..3053101.01 rows=142 width=22)
                                       Hash Cond: (catalog_returns_1_prt_outliers.cr_returned_date_sk = date_dim.d_date_sk)
                                       ->  Hash Join  (cost=458147.67..3049792.93 rows=98343 width=26)
                                             Hash Cond: (catalog_returns_1_prt_outliers.cr_returning_customer_sk = customer.c_customer_sk)
                                             ->  Append  (cost=0.00..2048707.25 rows=47998910 width=18)
                                                   ->  Result  (cost=0.00..1.00 rows=1 width=26)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_outliers  (cost=0.00..1.00 rows=1 width=26)
                                                   ->  Result  (cost=0.00..89.94 rows=1932 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_2  (cost=0.00..89.94 rows=1932 width=18)
                                                   ->  Result  (cost=0.00..839.14 rows=19405 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_3  (cost=0.00..839.14 rows=19405 width=18)
                                                   ->  Result  (cost=0.00..2485.51 rows=57851 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_4  (cost=0.00..2485.51 rows=57851 width=18)
                                                   ->  Result  (cost=0.00..4960.98 rows=115933 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_5  (cost=0.00..4960.98 rows=115933 width=18)
                                                   ->  Result  (cost=0.00..7782.08 rows=182003 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_6  (cost=0.00..7782.08 rows=182003 width=18)
                                                   ->  Result  (cost=0.00..10621.88 rows=248696 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_7  (cost=0.00..10621.88 rows=248696 width=18)
                                                   ->  Result  (cost=0.00..13478.93 rows=315565 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_8  (cost=0.00..13478.93 rows=315565 width=18)
                                                   ->  Result  (cost=0.00..15896.40 rows=372214 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_9  (cost=0.00..15896.40 rows=372214 width=18)
                                                   ->  Result  (cost=0.00..17750.30 rows=415710 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_10  (cost=0.00..17750.30 rows=415710 width=18)
                                                   ->  Result  (cost=0.00..19794.70 rows=463690 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_11  (cost=0.00..19794.70 rows=463690 width=18)
                                                   ->  Result  (cost=0.00..22437.10 rows=525604 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_12  (cost=0.00..22437.10 rows=525604 width=18)
                                                   ->  Result  (cost=0.00..26080.50 rows=611050 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_13  (cost=0.00..26080.50 rows=611050 width=18)
                                                   ->  Result  (cost=0.00..30734.10 rows=720170 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_14  (cost=0.00..30734.10 rows=720170 width=18)
                                                   ->  Result  (cost=0.00..36307.80 rows=850860 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_15  (cost=0.00..36307.80 rows=850860 width=18)
                                                   ->  Result  (cost=0.00..41041.30 rows=961744 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_16  (cost=0.00..41041.30 rows=961744 width=18)
                                                   ->  Result  (cost=0.00..43099.50 rows=1009950 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_17  (cost=0.00..43099.50 rows=1009950 width=18)
                                                   ->  Result  (cost=0.00..41879.10 rows=981337 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_18  (cost=0.00..41879.10 rows=981337 width=18)
                                                   ->  Result  (cost=0.00..38497.60 rows=902120 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_19  (cost=0.00..38497.60 rows=902120 width=18)
                                                   ->  Result  (cost=0.00..34174.60 rows=800720 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_20  (cost=0.00..34174.60 rows=800720 width=18)
                                                   ->  Result  (cost=0.00..28866.00 rows=676300 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_21  (cost=0.00..28866.00 rows=676300 width=18)
                                                   ->  Result  (cost=0.00..23528.20 rows=551174 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_22  (cost=0.00..23528.20 rows=551174 width=18)
                                                   ->  Result  (cost=0.00..20118.40 rows=471247 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_23  (cost=0.00..20118.40 rows=471247 width=18)
                                                   ->  Result  (cost=0.00..19874.50 rows=465584 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_24  (cost=0.00..19874.50 rows=465584 width=18)
                                                   ->  Result  (cost=0.00..22296.70 rows=522290 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_25  (cost=0.00..22296.70 rows=522290 width=18)
                                                   ->  Result  (cost=0.00..25917.20 rows=607140 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_26  (cost=0.00..25917.20 rows=607140 width=18)
                                                   ->  Result  (cost=0.00..30522.50 rows=715184 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_27  (cost=0.00..30522.50 rows=715184 width=18)
                                                   ->  Result  (cost=0.00..36052.80 rows=844894 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_28  (cost=0.00..36052.80 rows=844894 width=18)
                                                   ->  Result  (cost=0.00..40956.30 rows=959777 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_29  (cost=0.00..40956.30 rows=959777 width=18)
                                                   ->  Result  (cost=0.00..43148.40 rows=1011214 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_30  (cost=0.00..43148.40 rows=1011214 width=18)
                                                   ->  Result  (cost=0.00..42010.00 rows=984434 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_31  (cost=0.00..42010.00 rows=984434 width=18)
                                                   ->  Result  (cost=0.00..38722.30 rows=907377 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_32  (cost=0.00..38722.30 rows=907377 width=18)
                                                   ->  Result  (cost=0.00..34426.40 rows=806647 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_33  (cost=0.00..34426.40 rows=806647 width=18)
                                                   ->  Result  (cost=0.00..29177.30 rows=683644 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_34  (cost=0.00..29177.30 rows=683644 width=18)
                                                   ->  Result  (cost=0.00..23787.80 rows=557327 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_35  (cost=0.00..23787.80 rows=557327 width=18)
                                                   ->  Result  (cost=0.00..20236.00 rows=474067 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_36  (cost=0.00..20236.00 rows=474067 width=18)
                                                   ->  Result  (cost=0.00..19907.20 rows=466240 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_37  (cost=0.00..19907.20 rows=466240 width=18)
                                                   ->  Result  (cost=0.00..22185.10 rows=519704 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_38  (cost=0.00..22185.10 rows=519704 width=18)
                                                   ->  Result  (cost=0.00..25740.00 rows=603100 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_39  (cost=0.00..25740.00 rows=603100 width=18)
                                                   ->  Result  (cost=0.00..30341.40 rows=710914 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_40  (cost=0.00..30341.40 rows=710914 width=18)
                                                   ->  Result  (cost=0.00..35869.30 rows=840477 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_41  (cost=0.00..35869.30 rows=840477 width=18)
                                                   ->  Result  (cost=0.00..40858.00 rows=957467 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_42  (cost=0.00..40858.00 rows=957467 width=18)
                                                   ->  Result  (cost=0.00..43189.40 rows=1012114 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_43  (cost=0.00..43189.40 rows=1012114 width=18)
                                                   ->  Result  (cost=0.00..42208.80 rows=989160 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_44  (cost=0.00..42208.80 rows=989160 width=18)
                                                   ->  Result  (cost=0.00..39037.10 rows=914804 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_45  (cost=0.00..39037.10 rows=914804 width=18)
                                                   ->  Result  (cost=0.00..34783.00 rows=815100 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_46  (cost=0.00..34783.00 rows=815100 width=18)
                                                   ->  Result  (cost=0.00..29479.40 rows=690714 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_47  (cost=0.00..29479.40 rows=690714 width=18)
                                                   ->  Result  (cost=0.00..24074.70 rows=564057 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_48  (cost=0.00..24074.70 rows=564057 width=18)
                                                   ->  Result  (cost=0.00..20308.20 rows=475707 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_49  (cost=0.00..20308.20 rows=475707 width=18)
                                                   ->  Result  (cost=0.00..19762.20 rows=462907 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_50  (cost=0.00..19762.20 rows=462907 width=18)
                                                   ->  Result  (cost=0.00..21941.80 rows=513960 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_51  (cost=0.00..21941.80 rows=513960 width=18)
                                                   ->  Result  (cost=0.00..25524.00 rows=598034 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_52  (cost=0.00..25524.00 rows=598034 width=18)
                                                   ->  Result  (cost=0.00..29988.40 rows=702614 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_53  (cost=0.00..29988.40 rows=702614 width=18)
                                                   ->  Result  (cost=0.00..35472.20 rows=831174 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_54  (cost=0.00..35472.20 rows=831174 width=18)
                                                   ->  Result  (cost=0.00..40521.40 rows=949514 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_55  (cost=0.00..40521.40 rows=949514 width=18)
                                                   ->  Result  (cost=0.00..43037.90 rows=1008564 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_56  (cost=0.00..43037.90 rows=1008564 width=18)
                                                   ->  Result  (cost=0.00..42199.20 rows=988874 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_57  (cost=0.00..42199.20 rows=988874 width=18)
                                                   ->  Result  (cost=0.00..39131.90 rows=916964 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_58  (cost=0.00..39131.90 rows=916964 width=18)
                                                   ->  Result  (cost=0.00..34896.90 rows=817730 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_59  (cost=0.00..34896.90 rows=817730 width=18)
                                                   ->  Result  (cost=0.00..29665.40 rows=695080 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_60  (cost=0.00..29665.40 rows=695080 width=18)
                                                   ->  Result  (cost=0.00..24208.60 rows=567154 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_61  (cost=0.00..24208.60 rows=567154 width=18)
                                                   ->  Result  (cost=0.00..20387.30 rows=477644 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_62  (cost=0.00..20387.30 rows=477644 width=18)
                                                   ->  Result  (cost=0.00..19741.20 rows=462340 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_63  (cost=0.00..19741.20 rows=462340 width=18)
                                                   ->  Result  (cost=0.00..21867.20 rows=512274 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_64  (cost=0.00..21867.20 rows=512274 width=18)
                                                   ->  Result  (cost=0.00..25350.50 rows=593884 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_65  (cost=0.00..25350.50 rows=593884 width=18)
                                                   ->  Result  (cost=0.00..29837.00 rows=699100 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_66  (cost=0.00..29837.00 rows=699100 width=18)
                                                   ->  Result  (cost=0.00..35270.90 rows=826464 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_67  (cost=0.00..35270.90 rows=826464 width=18)
                                                   ->  Result  (cost=0.00..40185.20 rows=941674 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_68  (cost=0.00..40185.20 rows=941674 width=18)
                                                   ->  Result  (cost=0.00..41789.50 rows=979317 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_69  (cost=0.00..41789.50 rows=979317 width=18)
                                                   ->  Result  (cost=0.00..39187.40 rows=918347 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_70  (cost=0.00..39187.40 rows=918347 width=18)
                                                   ->  Result  (cost=0.00..33506.60 rows=785120 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_71  (cost=0.00..33506.60 rows=785120 width=18)
                                                   ->  Result  (cost=0.00..26483.20 rows=620407 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_72  (cost=0.00..26483.20 rows=620407 width=18)
                                                   ->  Result  (cost=0.00..18408.20 rows=431207 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_73  (cost=0.00..18408.20 rows=431207 width=18)
                                                   ->  Result  (cost=0.00..10161.74 rows=237858 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_74  (cost=0.00..10161.74 rows=237858 width=18)
                                                   ->  Result  (cost=0.00..3892.67 rows=90823 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_75  (cost=0.00..3892.67 rows=90823 width=18)
                                                   ->  Result  (cost=0.00..672.49 rows=15283 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_76  (cost=0.00..672.49 rows=15283 width=18)
                                                   ->  Result  (cost=0.00..38.39 rows=213 width=18)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_77  (cost=0.00..38.39 rows=213 width=18)
                                                   ->  Result  (cost=0.00..1.00 rows=1 width=26)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_78  (cost=0.00..1.00 rows=1 width=26)
                                                   ->  Result  (cost=0.00..1.00 rows=1 width=26)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_79  (cost=0.00..1.00 rows=1 width=26)
                                                   ->  Result  (cost=0.00..1.00 rows=1 width=26)
                                                         One-Time Filter: PartSelected
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_80  (cost=0.00..1.00 rows=1 width=26)
                                             ->  Hash  (cost=457208.11..457208.11 rows=25055 width=16)
                                                   ->  Broadcast Motion 3:3  (slice4; segments: 3)  (cost=170673.29..457208.11 rows=25055 width=16)
                                                         ->  Hash Join  (cost=170673.29..456205.92 rows=8352 width=16)
                                                               Hash Cond: (customer.c_current_addr_sk = customer_address.ca_address_sk)
                                                               ->  Redistribute Motion 3:3  (slice3; segments: 3)  (cost=61738.76..346144.11 rows=77932 width=20)
                                                                     Hash Key: customer.c_current_addr_sk
                                                                     ->  Hash Join  (cost=61738.76..341468.25 rows=77932 width=20)
                                                                           Hash Cond: (customer.c_current_hdemo_sk = household_demographics.hd_demo_sk)
                                                                           ->  Hash Join  (cost=61523.76..329834.48 rows=484312 width=24)
                                                                                 Hash Cond: (customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk)
                                                                                 ->  Seq Scan on customer  (cost=0.00..178782.00 rows=3999967 width=16)
                                                                                 ->  Hash  (cost=52477.72..52477.72 rows=241228 width=16)
                                                                                       ->  Broadcast Motion 3:3  (slice1; segments: 3)  (cost=0.00..52477.72 rows=241228 width=16)
                                                                                             ->  Seq Scan on customer_demographics  (cost=0.00..42828.60 rows=80410 width=16)
                                                                                                   Filter: (((cd_marital_status = 'M'::bpchar) AND ((cd_education_status)::text = 'Unknown'::text)) OR ((cd_marital_status = 'W'::bpchar) AND ((cd_education_status)::text = 'Advanced Degree'::text)))
                                                                           ->  Hash  (cost=170.00..170.00 rows=1201 width=4)
                                                                                 ->  Broadcast Motion 3:3  (slice2; segments: 3)  (cost=0.00..170.00 rows=1201 width=4)
                                                                                       ->  Seq Scan on household_demographics  (cost=0.00..122.00 rows=401 width=4)
                                                                                             Filter: ((hd_buy_potential)::text ~~ '0-500%'::text)
                                                               ->  Hash  (cost=100894.88..100894.88 rows=214391 width=4)
                                                                     ->  Seq Scan on customer_address  (cost=0.00..100894.88 rows=214391 width=4)
                                                                           Filter: (ca_gmt_offset = (-7)::numeric)
                                       ->  Hash  (cost=1455.95..1455.95 rows=106 width=4)
                                             ->  Partition Selector for catalog_returns (dynamic scan id: 1)  (cost=0.00..1455.95 rows=106 width=4)
                                                   Filter: date_dim.d_date_sk
                                                   ->  Broadcast Motion 3:3  (slice5; segments: 3)  (cost=0.00..1455.95 rows=106 width=4)
                                                         ->  Seq Scan on date_dim  (cost=0.00..1451.73 rows=36 width=4)
                                                               Filter: ((d_year = 1999) AND (d_moy = 11))
                                 ->  Hash  (cost=23.10..23.10 rows=42 width=48)
                                       ->  Broadcast Motion 3:3  (slice6; segments: 3)  (cost=0.00..23.10 rows=42 width=48)
                                             ->  Seq Scan on call_center  (cost=0.00..21.42 rows=14 width=48)
 Planning time: 21.242 ms
 Optimizer: legacy query optimizer
(290 rows)

-- end query 1 in stream 0 using template query91.tpl
