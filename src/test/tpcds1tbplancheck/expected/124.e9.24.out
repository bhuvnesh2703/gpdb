-- start query 1 in stream 0 using template query24.tpl
explain
with ssales as
(select c_last_name
      ,c_first_name
      ,s_store_name
      ,ca_state
      ,s_state
      ,i_color
      ,i_current_price
      ,i_manager_id
      ,i_units
      ,i_size
      ,sum(ss_sales_price) netpaid
from store_sales
    ,store_returns
    ,store
    ,item
    ,customer
    ,customer_address
where ss_ticket_number = sr_ticket_number
  and ss_item_sk = sr_item_sk
  and ss_customer_sk = c_customer_sk
  and ss_item_sk = i_item_sk
  and ss_store_sk = s_store_sk
  and c_birth_country = upper(ca_country)
  and s_zip = ca_zip
and s_market_id=7
group by c_last_name
        ,c_first_name
        ,s_store_name
        ,ca_state
        ,s_state
        ,i_color
        ,i_current_price
        ,i_manager_id
        ,i_units
        ,i_size)
select c_last_name
      ,c_first_name
      ,s_store_name
      ,sum(netpaid) paid
from ssales
where i_color = 'orchid'
group by c_last_name
        ,c_first_name
        ,s_store_name
having sum(netpaid) > (select 0.05*avg(netpaid)
                                 from ssales)
;
                                                                                                                                         QUERY PLAN                                                                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Gather Motion 3:1  (slice14; segments: 3)  (cost=57.23..58.02 rows=45 width=286)
   ->  HashAggregate  (cost=57.23..58.02 rows=15 width=286)
         Group Key: ssales.c_last_name, ssales.c_first_name, ssales.s_store_name
         Filter: (pg_catalog.sum((sum(ssales.netpaid))) > $0)
         InitPlan 1 (returns $0)  (slice15)
           ->  Aggregate  (cost=53.84..53.85 rows=1 width=32)
                 ->  Gather Motion 3:1  (slice13; segments: 3)  (cost=53.78..53.83 rows=1 width=32)
                       ->  Aggregate  (cost=53.78..53.79 rows=1 width=32)
                             ->  Subquery Scan on ssales_1  (cost=0.00..47.80 rows=797 width=32)
                                   ->  HashAggregate  (cost=3046033806.80..3046033836.68 rows=797 width=482)
                                         Group Key: customer_1.c_last_name, customer_1.c_first_name, store_1.s_store_name, customer_address_1.ca_state, store_1.s_state, item_1.i_color, item_1.i_current_price, item_1.i_manager_id, item_1.i_units, item_1.i_size
                                         ->  Redistribute Motion 3:3  (slice12; segments: 3)  (cost=3046033669.38..3046033717.18 rows=797 width=482)
                                               Hash Key: customer_1.c_last_name, customer_1.c_first_name, store_1.s_store_name, customer_address_1.ca_state, store_1.s_state, item_1.i_color, item_1.i_current_price, item_1.i_manager_id, item_1.i_units, item_1.i_size
                                               ->  HashAggregate  (cost=3046033669.38..3046033669.38 rows=797 width=482)
                                                     Group Key: customer_1.c_last_name, customer_1.c_first_name, store_1.s_store_name, customer_address_1.ca_state, store_1.s_state, item_1.i_color, item_1.i_current_price, item_1.i_manager_id, item_1.i_units, item_1.i_size
                                                     ->  Hash Join  (cost=9447364.88..3046033603.64 rows=797 width=55)
                                                           Hash Cond: (((customer_1.c_birth_country)::text = upper((customer_address_1.ca_country)::text)) AND ((store_1.s_zip)::text = (customer_address_1.ca_zip)::text))
                                                           ->  Broadcast Motion 3:3  (slice11; segments: 3)  (cost=9271450.13..3045695019.37 rows=1232 width=67)
                                                                 ->  Hash Join  (cost=9271450.13..3045694970.11 rows=411 width=67)
                                                                       Hash Cond: (store_sales_1_prt_outliers_1.ss_item_sk = item_1.i_item_sk)
                                                                       ->  Redistribute Motion 3:3  (slice10; segments: 3)  (cost=9261728.07..3045685231.12 rows=411 width=49)
                                                                             Hash Key: store_sales_1_prt_outliers_1.ss_item_sk
                                                                             ->  Hash Join  (cost=9261728.07..3045685206.49 rows=411 width=49)
                                                                                   Hash Cond: ((store_sales_1_prt_outliers_1.ss_ticket_number = store_returns_1_prt_outliers_1.sr_ticket_number) AND (store_sales_1_prt_outliers_1.ss_item_sk = store_returns_1_prt_outliers_1.sr_item_sk))
                                                                                   ->  Hash Join  (cost=1108825.44..66330408.37 rows=20631207 width=53)
                                                                                         Hash Cond: (store_sales_1_prt_outliers_1.ss_customer_sk = customer_1.c_customer_sk)
                                                                                         ->  Hash Join  (cost=51.19..58755594.25 rows=41032631 width=35)
                                                                                               Hash Cond: (store_sales_1_prt_outliers_1.ss_store_sk = store_1.s_store_sk)
                                                                                               ->  Append  (cost=0.00..39524635.96 rows=959996170 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_outliers store_sales_1_prt_outliers_1  (cost=0.00..1568615.00 rows=43200334 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_2 store_sales_1_prt_2_1  (cost=0.00..324595.00 rows=7840134 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_3 store_sales_1_prt_3_1  (cost=0.00..336211.00 rows=8120800 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_4 store_sales_1_prt_4_1  (cost=0.00..324382.00 rows=7834967 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_5 store_sales_1_prt_5_1  (cost=0.00..336381.00 rows=8124734 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_6 store_sales_1_prt_6_1  (cost=0.00..336417.00 rows=8125800 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_7 store_sales_1_prt_7_1  (cost=0.00..336453.00 rows=8126567 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_8 store_sales_1_prt_8_1  (cost=0.00..336058.00 rows=8116967 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_9 store_sales_1_prt_9_1  (cost=0.00..489738.00 rows=11829267 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_10 store_sales_1_prt_10_1  (cost=0.00..765474.00 rows=18489534 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_11 store_sales_1_prt_11_1  (cost=0.00..766278.00 rows=18508900 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_12 store_sales_1_prt_12_1  (cost=0.00..793967.00 rows=19177700 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_13 store_sales_1_prt_13_1  (cost=0.00..1159820.00 rows=28014600 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_14 store_sales_1_prt_14_1  (cost=0.00..1160753.00 rows=28037334 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_15 store_sales_1_prt_15_1  (cost=0.00..436710.00 rows=10548367 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_16 store_sales_1_prt_16_1  (cost=0.00..336477.00 rows=8127134 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_17 store_sales_1_prt_17_1  (cost=0.00..324706.00 rows=7842834 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_18 store_sales_1_prt_18_1  (cost=0.00..336587.00 rows=8129867 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_19 store_sales_1_prt_19_1  (cost=0.00..336153.00 rows=8119367 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_20 store_sales_1_prt_20_1  (cost=0.00..336736.00 rows=8133367 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_21 store_sales_1_prt_21_1  (cost=0.00..336190.00 rows=8120200 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_22 store_sales_1_prt_22_1  (cost=0.00..474334.00 rows=11457100 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_23 store_sales_1_prt_23_1  (cost=0.00..766084.00 rows=18504234 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_24 store_sales_1_prt_24_1  (cost=0.00..765781.00 rows=18496900 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_25 store_sales_1_prt_25_1  (cost=0.00..779443.00 rows=18826834 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_26 store_sales_1_prt_26_1  (cost=0.00..1160832.00 rows=28039467 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_27 store_sales_1_prt_27_1  (cost=0.00..1160090.00 rows=28021400 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_28 store_sales_1_prt_28_1  (cost=0.00..465893.00 rows=11253134 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_29 store_sales_1_prt_29_1  (cost=0.00..335914.00 rows=8113600 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_30 store_sales_1_prt_30_1  (cost=0.00..336186.00 rows=8120167 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_31 store_sales_1_prt_31_1  (cost=0.00..336014.00 rows=8115934 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_32 store_sales_1_prt_32_1  (cost=0.00..335918.00 rows=8113667 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_33 store_sales_1_prt_33_1  (cost=0.00..336069.00 rows=8117334 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_34 store_sales_1_prt_34_1  (cost=0.00..335472.00 rows=8102900 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_35 store_sales_1_prt_35_1  (cost=0.00..457985.00 rows=11062100 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_36 store_sales_1_prt_36_1  (cost=0.00..764679.00 rows=18470400 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_37 store_sales_1_prt_37_1  (cost=0.00..764030.00 rows=18454700 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_38 store_sales_1_prt_38_1  (cost=0.00..764484.00 rows=18465634 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_39 store_sales_1_prt_39_1  (cost=0.00..1158198.04 rows=27975568 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_40 store_sales_1_prt_40_1  (cost=0.00..1158199.04 rows=27975968 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_41 store_sales_1_prt_41_1  (cost=0.00..483138.00 rows=11669800 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_42 store_sales_1_prt_42_1  (cost=0.00..336559.00 rows=8129100 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_43 store_sales_1_prt_43_1  (cost=0.00..324602.00 rows=7840367 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_44 store_sales_1_prt_44_1  (cost=0.00..336209.00 rows=8120567 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_45 store_sales_1_prt_45_1  (cost=0.00..336313.00 rows=8123267 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_46 store_sales_1_prt_46_1  (cost=0.00..336621.00 rows=8130734 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_47 store_sales_1_prt_47_1  (cost=0.00..335906.00 rows=8113400 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_48 store_sales_1_prt_48_1  (cost=0.00..428657.00 rows=10353800 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_49 store_sales_1_prt_49_1  (cost=0.00..766560.00 rows=18515734 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_50 store_sales_1_prt_50_1  (cost=0.00..766167.00 rows=18506234 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_51 store_sales_1_prt_51_1  (cost=0.00..766196.00 rows=18506900 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_52 store_sales_1_prt_52_1  (cost=0.00..1130938.00 rows=27317200 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_53 store_sales_1_prt_53_1  (cost=0.00..1160637.96 rows=28034566 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_54 store_sales_1_prt_54_1  (cost=0.00..555225.00 rows=13411000 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_55 store_sales_1_prt_55_1  (cost=0.00..336782.00 rows=8134567 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_56 store_sales_1_prt_56_1  (cost=0.00..324454.00 rows=7836734 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_57 store_sales_1_prt_57_1  (cost=0.00..336546.00 rows=8128867 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_58 store_sales_1_prt_58_1  (cost=0.00..336207.00 rows=8120667 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_59 store_sales_1_prt_59_1  (cost=0.00..336578.00 rows=8129534 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_60 store_sales_1_prt_60_1  (cost=0.00..336468.00 rows=8127067 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_61 store_sales_1_prt_61_1  (cost=0.00..412992.00 rows=9975467 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_62 store_sales_1_prt_62_1  (cost=0.00..765709.00 rows=18495234 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_63 store_sales_1_prt_63_1  (cost=0.00..766176.00 rows=18506500 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_64 store_sales_1_prt_64_1  (cost=0.00..766142.00 rows=18505834 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_65 store_sales_1_prt_65_1  (cost=0.00..1117566.96 rows=26994166 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_66 store_sales_1_prt_66_1  (cost=0.00..1159645.96 rows=28010566 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_67 store_sales_1_prt_67_1  (cost=0.00..331321.00 rows=8002500 width=26)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_68 store_sales_1_prt_68_1  (cost=0.00..1.00 rows=1 width=34)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_69 store_sales_1_prt_69_1  (cost=0.00..1.00 rows=1 width=34)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_70 store_sales_1_prt_70_1  (cost=0.00..1.00 rows=1 width=34)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_71 store_sales_1_prt_71_1  (cost=0.00..1.00 rows=1 width=34)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_72 store_sales_1_prt_72_1  (cost=0.00..1.00 rows=1 width=34)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_73 store_sales_1_prt_73_1  (cost=0.00..1.00 rows=1 width=34)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_74 store_sales_1_prt_74_1  (cost=0.00..1.00 rows=1 width=34)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_75 store_sales_1_prt_75_1  (cost=0.00..1.00 rows=1 width=34)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_76 store_sales_1_prt_76_1  (cost=0.00..1.00 rows=1 width=34)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_77 store_sales_1_prt_77_1  (cost=0.00..1.00 rows=1 width=34)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_78 store_sales_1_prt_78_1  (cost=0.00..1.00 rows=1 width=34)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_79 store_sales_1_prt_79_1  (cost=0.00..1.00 rows=1 width=34)
                                                                                                     ->  Append-only Columnar Scan on store_sales_1_prt_80 store_sales_1_prt_80_1  (cost=0.00..1.00 rows=1 width=34)
                                                                                               ->  Hash  (cost=47.96..47.96 rows=86 width=17)
                                                                                                     ->  Broadcast Motion 3:3  (slice8; segments: 3)  (cost=0.00..47.96 rows=86 width=17)
                                                                                                           ->  Seq Scan on store store_1  (cost=0.00..44.52 rows=29 width=17)
                                                                                                                 Filter: (s_market_id = 7)
                                                                                         ->  Hash  (cost=658778.00..658778.00 rows=11999900 width=26)
                                                                                               ->  Broadcast Motion 3:3  (slice9; segments: 3)  (cost=0.00..658778.00 rows=11999900 width=26)
                                                                                                     ->  Seq Scan on customer customer_1  (cost=0.00..178782.00 rows=3999967 width=26)
                                                                                   ->  Hash  (cost=3832906.41..3832906.41 rows=95999916 width=12)
                                                                                         ->  Append  (cost=0.00..3832906.41 rows=95999916 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_outliers store_returns_1_prt_outliers_1  (cost=0.00..119589.00 rows=3359867 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_2 store_returns_1_prt_2_1  (cost=0.00..1853.03 rows=45768 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_3 store_returns_1_prt_3_1  (cost=0.00..6990.74 rows=174025 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_4 store_returns_1_prt_4_1  (cost=0.00..12073.00 rows=300934 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_5 store_returns_1_prt_5_1  (cost=0.00..17206.50 rows=429050 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_6 store_returns_1_prt_6_1  (cost=0.00..22418.30 rows=559077 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_7 store_returns_1_prt_7_1  (cost=0.00..27598.00 rows=688300 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_8 store_returns_1_prt_8_1  (cost=0.00..32106.70 rows=800790 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_9 store_returns_1_prt_9_1  (cost=0.00..32900.20 rows=820607 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_10 store_returns_1_prt_10_1  (cost=0.00..37679.10 rows=939970 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_11 store_returns_1_prt_11_1  (cost=0.00..44416.50 rows=1108017 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_12 store_returns_1_prt_12_1  (cost=0.00..51022.00 rows=1272934 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_13 store_returns_1_prt_13_1  (cost=0.00..60422.90 rows=1507530 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_14 store_returns_1_prt_14_1  (cost=0.00..73185.80 rows=1826060 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_15 store_returns_1_prt_15_1  (cost=0.00..82303.60 rows=2053554 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_16 store_returns_1_prt_16_1  (cost=0.00..79967.20 rows=1995307 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_17 store_returns_1_prt_17_1  (cost=0.00..73186.20 rows=1826107 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_18 store_returns_1_prt_18_1  (cost=0.00..66475.20 rows=1658607 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_19 store_returns_1_prt_19_1  (cost=0.00..58723.50 rows=1465084 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_20 store_returns_1_prt_20_1  (cost=0.00..46348.30 rows=1156177 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_21 store_returns_1_prt_21_1  (cost=0.00..34792.40 rows=867914 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_22 store_returns_1_prt_22_1  (cost=0.00..32894.20 rows=820507 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_23 store_returns_1_prt_23_1  (cost=0.00..37424.80 rows=933627 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_24 store_returns_1_prt_24_1  (cost=0.00..44195.80 rows=1102527 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_25 store_returns_1_prt_25_1  (cost=0.00..50837.00 rows=1268234 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_26 store_returns_1_prt_26_1  (cost=0.00..59985.70 rows=1496590 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_27 store_returns_1_prt_27_1  (cost=0.00..72724.00 rows=1814434 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_28 store_returns_1_prt_28_1  (cost=0.00..82164.10 rows=2050104 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_29 store_returns_1_prt_29_1  (cost=0.00..80191.60 rows=2000754 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_30 store_returns_1_prt_30_1  (cost=0.00..73529.70 rows=1834590 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_31 store_returns_1_prt_31_1  (cost=0.00..66909.40 rows=1669347 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_32 store_returns_1_prt_32_1  (cost=0.00..59189.10 rows=1476737 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_33 store_returns_1_prt_33_1  (cost=0.00..46935.60 rows=1170954 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_34 store_returns_1_prt_34_1  (cost=0.00..35180.30 rows=877544 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_35 store_returns_1_prt_35_1  (cost=0.00..32948.10 rows=821804 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_36 store_returns_1_prt_36_1  (cost=0.00..37243.00 rows=928967 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_37 store_returns_1_prt_37_1  (cost=0.00..43879.00 rows=1094634 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_38 store_returns_1_prt_38_1  (cost=0.00..50465.40 rows=1259047 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_39 store_returns_1_prt_39_1  (cost=0.00..59486.40 rows=1484147 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_40 store_returns_1_prt_40_1  (cost=0.00..72150.30 rows=1800177 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_41 store_returns_1_prt_41_1  (cost=0.00..81849.40 rows=2042280 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_42 store_returns_1_prt_42_1  (cost=0.00..80010.30 rows=1996310 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_43 store_returns_1_prt_43_1  (cost=0.00..73403.80 rows=1831427 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_44 store_returns_1_prt_44_1  (cost=0.00..66684.90 rows=1663764 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_45 store_returns_1_prt_45_1  (cost=0.00..59144.80 rows=1475594 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_46 store_returns_1_prt_46_1  (cost=0.00..47011.80 rows=1172827 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_47 store_returns_1_prt_47_1  (cost=0.00..35247.70 rows=879257 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_48 store_returns_1_prt_48_1  (cost=0.00..32757.00 rows=817067 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_49 store_returns_1_prt_49_1  (cost=0.00..36707.60 rows=915654 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_50 store_returns_1_prt_50_1  (cost=0.00..43497.40 rows=1085080 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_51 store_returns_1_prt_51_1  (cost=0.00..50143.80 rows=1250960 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_52 store_returns_1_prt_52_1  (cost=0.00..58791.30 rows=1466777 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_53 store_returns_1_prt_53_1  (cost=0.00..71405.50 rows=1781517 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_54 store_returns_1_prt_54_1  (cost=0.00..81729.80 rows=2039294 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_55 store_returns_1_prt_55_1  (cost=0.00..80773.90 rows=2015430 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_56 store_returns_1_prt_56_1  (cost=0.00..74229.00 rows=1852034 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_57 store_returns_1_prt_57_1  (cost=0.00..67439.70 rows=1682624 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_58 store_returns_1_prt_58_1  (cost=0.00..60085.40 rows=1499080 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_59 store_returns_1_prt_59_1  (cost=0.00..48188.70 rows=1202190 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_60 store_returns_1_prt_60_1  (cost=0.00..35990.20 rows=897740 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_61 store_returns_1_prt_61_1  (cost=0.00..32755.30 rows=817010 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_62 store_returns_1_prt_62_1  (cost=0.00..36451.80 rows=909294 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_63 store_returns_1_prt_63_1  (cost=0.00..43272.00 rows=1079500 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_64 store_returns_1_prt_64_1  (cost=0.00..49886.80 rows=1244560 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_65 store_returns_1_prt_65_1  (cost=0.00..58346.40 rows=1455714 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_66 store_returns_1_prt_66_1  (cost=0.00..70812.50 rows=1766850 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_67 store_returns_1_prt_67_1  (cost=0.00..80500.30 rows=2008644 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_68 store_returns_1_prt_68_1  (cost=0.00..75031.60 rows=1872054 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_69 store_returns_1_prt_69_1  (cost=0.00..63447.40 rows=1582914 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_70 store_returns_1_prt_70_1  (cost=0.00..51572.60 rows=1286687 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_71 store_returns_1_prt_71_1  (cost=0.00..39178.00 rows=977300 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_72 store_returns_1_prt_72_1  (cost=0.00..22132.80 rows=551994 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_73 store_returns_1_prt_73_1  (cost=0.00..4828.24 rows=120108 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_74 store_returns_1_prt_74_1  (cost=0.00..1.00 rows=1 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_75 store_returns_1_prt_75_1  (cost=0.00..1.00 rows=1 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_76 store_returns_1_prt_76_1  (cost=0.00..1.00 rows=1 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_77 store_returns_1_prt_77_1  (cost=0.00..1.00 rows=1 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_78 store_returns_1_prt_78_1  (cost=0.00..1.00 rows=1 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_79 store_returns_1_prt_79_1  (cost=0.00..1.00 rows=1 width=12)
                                                                                               ->  Append-only Columnar Scan on store_returns_1_prt_80 store_returns_1_prt_80_1  (cost=0.00..1.00 rows=1 width=12)
                                                                       ->  Hash  (cost=5981.47..5981.47 rows=99749 width=30)
                                                                             ->  Seq Scan on item item_1  (cost=0.00..5981.47 rows=99749 width=30)
                                                           ->  Hash  (cost=85890.90..85890.90 rows=2000530 width=23)
                                                                 ->  Seq Scan on customer_address customer_address_1  (cost=0.00..85890.90 rows=2000530 width=23)
         ->  Redistribute Motion 3:3  (slice7; segments: 3)  (cost=1.46..2.36 rows=15 width=286)
               Hash Key: ssales.c_last_name, ssales.c_first_name, ssales.s_store_name
               ->  HashAggregate  (cost=1.46..1.46 rows=15 width=286)
                     Group Key: ssales.c_last_name, ssales.c_first_name, ssales.s_store_name
                     ->  Subquery Scan on ssales  (cost=0.00..0.90 rows=15 width=286)
                           ->  HashAggregate  (cost=86316143.25..86316143.81 rows=15 width=482)
                                 Group Key: customer.c_last_name, customer.c_first_name, store.s_store_name, customer_address.ca_state, store.s_state, item.i_color, item.i_current_price, item.i_manager_id, item.i_units, item.i_size
                                 ->  Redistribute Motion 3:3  (slice6; segments: 3)  (cost=86316140.66..86316141.56 rows=15 width=482)
                                       Hash Key: customer.c_last_name, customer.c_first_name, store.s_store_name, customer_address.ca_state, store.s_state, item.i_color, item.i_current_price, item.i_manager_id, item.i_units, item.i_size
                                       ->  HashAggregate  (cost=86316140.66..86316140.66 rows=15 width=482)
                                             Group Key: customer.c_last_name, customer.c_first_name, store.s_store_name, customer_address.ca_state, store.s_state, item.i_color, item.i_current_price, item.i_manager_id, item.i_units, item.i_size
                                             ->  Hash Join  (cost=58457571.52..86316139.41 rows=16 width=55)
                                                   Hash Cond: (((customer.c_birth_country)::text = upper((customer_address.ca_country)::text)) AND ((store.s_zip)::text = (customer_address.ca_zip)::text))
                                                   ->  Broadcast Motion 3:3  (slice5; segments: 3)  (cost=58281656.77..86137118.45 rows=24 width=67)
                                                         ->  Hash Join  (cost=58281656.77..86137117.51 rows=8 width=67)
                                                               Hash Cond: ((store_returns_1_prt_outliers.sr_ticket_number = store_sales_1_prt_outliers.ss_ticket_number) AND (store_returns_1_prt_outliers.sr_item_sk = store_sales_1_prt_outliers.ss_item_sk))
                                                               ->  Append  (cost=0.00..3832906.41 rows=95999916 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_outliers  (cost=0.00..119589.00 rows=3359867 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_2  (cost=0.00..1853.03 rows=45768 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_3  (cost=0.00..6990.74 rows=174025 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_4  (cost=0.00..12073.00 rows=300934 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_5  (cost=0.00..17206.50 rows=429050 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_6  (cost=0.00..22418.30 rows=559077 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_7  (cost=0.00..27598.00 rows=688300 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_8  (cost=0.00..32106.70 rows=800790 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_9  (cost=0.00..32900.20 rows=820607 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_10  (cost=0.00..37679.10 rows=939970 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_11  (cost=0.00..44416.50 rows=1108017 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_12  (cost=0.00..51022.00 rows=1272934 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_13  (cost=0.00..60422.90 rows=1507530 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_14  (cost=0.00..73185.80 rows=1826060 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_15  (cost=0.00..82303.60 rows=2053554 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_16  (cost=0.00..79967.20 rows=1995307 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_17  (cost=0.00..73186.20 rows=1826107 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_18  (cost=0.00..66475.20 rows=1658607 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_19  (cost=0.00..58723.50 rows=1465084 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_20  (cost=0.00..46348.30 rows=1156177 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_21  (cost=0.00..34792.40 rows=867914 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_22  (cost=0.00..32894.20 rows=820507 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_23  (cost=0.00..37424.80 rows=933627 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_24  (cost=0.00..44195.80 rows=1102527 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_25  (cost=0.00..50837.00 rows=1268234 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_26  (cost=0.00..59985.70 rows=1496590 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_27  (cost=0.00..72724.00 rows=1814434 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_28  (cost=0.00..82164.10 rows=2050104 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_29  (cost=0.00..80191.60 rows=2000754 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_30  (cost=0.00..73529.70 rows=1834590 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_31  (cost=0.00..66909.40 rows=1669347 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_32  (cost=0.00..59189.10 rows=1476737 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_33  (cost=0.00..46935.60 rows=1170954 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_34  (cost=0.00..35180.30 rows=877544 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_35  (cost=0.00..32948.10 rows=821804 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_36  (cost=0.00..37243.00 rows=928967 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_37  (cost=0.00..43879.00 rows=1094634 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_38  (cost=0.00..50465.40 rows=1259047 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_39  (cost=0.00..59486.40 rows=1484147 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_40  (cost=0.00..72150.30 rows=1800177 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_41  (cost=0.00..81849.40 rows=2042280 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_42  (cost=0.00..80010.30 rows=1996310 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_43  (cost=0.00..73403.80 rows=1831427 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_44  (cost=0.00..66684.90 rows=1663764 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_45  (cost=0.00..59144.80 rows=1475594 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_46  (cost=0.00..47011.80 rows=1172827 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_47  (cost=0.00..35247.70 rows=879257 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_48  (cost=0.00..32757.00 rows=817067 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_49  (cost=0.00..36707.60 rows=915654 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_50  (cost=0.00..43497.40 rows=1085080 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_51  (cost=0.00..50143.80 rows=1250960 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_52  (cost=0.00..58791.30 rows=1466777 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_53  (cost=0.00..71405.50 rows=1781517 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_54  (cost=0.00..81729.80 rows=2039294 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_55  (cost=0.00..80773.90 rows=2015430 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_56  (cost=0.00..74229.00 rows=1852034 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_57  (cost=0.00..67439.70 rows=1682624 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_58  (cost=0.00..60085.40 rows=1499080 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_59  (cost=0.00..48188.70 rows=1202190 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_60  (cost=0.00..35990.20 rows=897740 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_61  (cost=0.00..32755.30 rows=817010 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_62  (cost=0.00..36451.80 rows=909294 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_63  (cost=0.00..43272.00 rows=1079500 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_64  (cost=0.00..49886.80 rows=1244560 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_65  (cost=0.00..58346.40 rows=1455714 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_66  (cost=0.00..70812.50 rows=1766850 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_67  (cost=0.00..80500.30 rows=2008644 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_68  (cost=0.00..75031.60 rows=1872054 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_69  (cost=0.00..63447.40 rows=1582914 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_70  (cost=0.00..51572.60 rows=1286687 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_71  (cost=0.00..39178.00 rows=977300 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_72  (cost=0.00..22132.80 rows=551994 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_73  (cost=0.00..4828.24 rows=120108 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_74  (cost=0.00..1.00 rows=1 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_75  (cost=0.00..1.00 rows=1 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_76  (cost=0.00..1.00 rows=1 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_77  (cost=0.00..1.00 rows=1 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_78  (cost=0.00..1.00 rows=1 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_79  (cost=0.00..1.00 rows=1 width=12)
                                                                     ->  Append-only Columnar Scan on store_returns_1_prt_80  (cost=0.00..1.00 rows=1 width=12)
                                                               ->  Hash  (cost=58274599.72..58274599.72 rows=156824 width=83)
                                                                     ->  Redistribute Motion 3:3  (slice4; segments: 3)  (cost=335737.81..58274599.72 rows=156824 width=83)
                                                                           Hash Key: store_sales_1_prt_outliers.ss_item_sk, store_sales_1_prt_outliers.ss_ticket_number
                                                                           ->  Hash Join  (cost=335737.81..58265190.32 rows=156824 width=83)
                                                                                 Hash Cond: (store_sales_1_prt_outliers.ss_customer_sk = customer.c_customer_sk)
                                                                                 ->  Redistribute Motion 3:3  (slice3; segments: 3)  (cost=6957.06..57915330.23 rows=311901 width=65)
                                                                                       Hash Key: store_sales_1_prt_outliers.ss_customer_sk
                                                                                       ->  Hash Join  (cost=6957.06..57896616.22 rows=311901 width=65)
                                                                                             Hash Cond: (store_sales_1_prt_outliers.ss_store_sk = store.s_store_sk)
                                                                                             ->  Hash Join  (cost=6905.87..57750385.72 rows=7297191 width=56)
                                                                                                   Hash Cond: (store_sales_1_prt_outliers.ss_item_sk = item.i_item_sk)
                                                                                                   ->  Append  (cost=0.00..39524635.96 rows=959996170 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_outliers  (cost=0.00..1568615.00 rows=43200334 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_2  (cost=0.00..324595.00 rows=7840134 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_3  (cost=0.00..336211.00 rows=8120800 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_4  (cost=0.00..324382.00 rows=7834967 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_5  (cost=0.00..336381.00 rows=8124734 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_6  (cost=0.00..336417.00 rows=8125800 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_7  (cost=0.00..336453.00 rows=8126567 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_8  (cost=0.00..336058.00 rows=8116967 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_9  (cost=0.00..489738.00 rows=11829267 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_10  (cost=0.00..765474.00 rows=18489534 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_11  (cost=0.00..766278.00 rows=18508900 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_12  (cost=0.00..793967.00 rows=19177700 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_13  (cost=0.00..1159820.00 rows=28014600 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_14  (cost=0.00..1160753.00 rows=28037334 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_15  (cost=0.00..436710.00 rows=10548367 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_16  (cost=0.00..336477.00 rows=8127134 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_17  (cost=0.00..324706.00 rows=7842834 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_18  (cost=0.00..336587.00 rows=8129867 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_19  (cost=0.00..336153.00 rows=8119367 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_20  (cost=0.00..336736.00 rows=8133367 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_21  (cost=0.00..336190.00 rows=8120200 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_22  (cost=0.00..474334.00 rows=11457100 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_23  (cost=0.00..766084.00 rows=18504234 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_24  (cost=0.00..765781.00 rows=18496900 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_25  (cost=0.00..779443.00 rows=18826834 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_26  (cost=0.00..1160832.00 rows=28039467 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_27  (cost=0.00..1160090.00 rows=28021400 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_28  (cost=0.00..465893.00 rows=11253134 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_29  (cost=0.00..335914.00 rows=8113600 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_30  (cost=0.00..336186.00 rows=8120167 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_31  (cost=0.00..336014.00 rows=8115934 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_32  (cost=0.00..335918.00 rows=8113667 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_33  (cost=0.00..336069.00 rows=8117334 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_34  (cost=0.00..335472.00 rows=8102900 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_35  (cost=0.00..457985.00 rows=11062100 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_36  (cost=0.00..764679.00 rows=18470400 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_37  (cost=0.00..764030.00 rows=18454700 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_38  (cost=0.00..764484.00 rows=18465634 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_39  (cost=0.00..1158198.04 rows=27975568 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_40  (cost=0.00..1158199.04 rows=27975968 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_41  (cost=0.00..483138.00 rows=11669800 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_42  (cost=0.00..336559.00 rows=8129100 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_43  (cost=0.00..324602.00 rows=7840367 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_44  (cost=0.00..336209.00 rows=8120567 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_45  (cost=0.00..336313.00 rows=8123267 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_46  (cost=0.00..336621.00 rows=8130734 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_47  (cost=0.00..335906.00 rows=8113400 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_48  (cost=0.00..428657.00 rows=10353800 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_49  (cost=0.00..766560.00 rows=18515734 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_50  (cost=0.00..766167.00 rows=18506234 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_51  (cost=0.00..766196.00 rows=18506900 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_52  (cost=0.00..1130938.00 rows=27317200 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_53  (cost=0.00..1160637.96 rows=28034566 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_54  (cost=0.00..555225.00 rows=13411000 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_55  (cost=0.00..336782.00 rows=8134567 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_56  (cost=0.00..324454.00 rows=7836734 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_57  (cost=0.00..336546.00 rows=8128867 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_58  (cost=0.00..336207.00 rows=8120667 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_59  (cost=0.00..336578.00 rows=8129534 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_60  (cost=0.00..336468.00 rows=8127067 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_61  (cost=0.00..412992.00 rows=9975467 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_62  (cost=0.00..765709.00 rows=18495234 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_63  (cost=0.00..766176.00 rows=18506500 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_64  (cost=0.00..766142.00 rows=18505834 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_65  (cost=0.00..1117566.96 rows=26994166 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_66  (cost=0.00..1159645.96 rows=28010566 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_67  (cost=0.00..331321.00 rows=8002500 width=26)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_68  (cost=0.00..1.00 rows=1 width=34)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_69  (cost=0.00..1.00 rows=1 width=34)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_70  (cost=0.00..1.00 rows=1 width=34)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_71  (cost=0.00..1.00 rows=1 width=34)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_72  (cost=0.00..1.00 rows=1 width=34)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_73  (cost=0.00..1.00 rows=1 width=34)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_74  (cost=0.00..1.00 rows=1 width=34)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_75  (cost=0.00..1.00 rows=1 width=34)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_76  (cost=0.00..1.00 rows=1 width=34)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_77  (cost=0.00..1.00 rows=1 width=34)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_78  (cost=0.00..1.00 rows=1 width=34)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_79  (cost=0.00..1.00 rows=1 width=34)
                                                                                                         ->  Append-only Columnar Scan on store_sales_1_prt_80  (cost=0.00..1.00 rows=1 width=34)
                                                                                                   ->  Hash  (cost=6820.57..6820.57 rows=2275 width=30)
                                                                                                         ->  Broadcast Motion 3:3  (slice1; segments: 3)  (cost=0.00..6820.57 rows=2275 width=30)
                                                                                                               ->  Seq Scan on item  (cost=0.00..6729.59 rows=759 width=30)
                                                                                                                     Filter: ((i_color)::text = 'orchid'::text)
                                                                                             ->  Hash  (cost=47.96..47.96 rows=86 width=17)
                                                                                                   ->  Broadcast Motion 3:3  (slice2; segments: 3)  (cost=0.00..47.96 rows=86 width=17)
                                                                                                         ->  Seq Scan on store  (cost=0.00..44.52 rows=29 width=17)
                                                                                                               Filter: (s_market_id = 7)
                                                                                 ->  Hash  (cost=178782.00..178782.00 rows=3999967 width=26)
                                                                                       ->  Seq Scan on customer  (cost=0.00..178782.00 rows=3999967 width=26)
                                                   ->  Hash  (cost=85890.90..85890.90 rows=2000530 width=23)
                                                         ->  Seq Scan on customer_address  (cost=0.00..85890.90 rows=2000530 width=23)
 Planning time: 60.739 ms
 Optimizer: legacy query optimizer
(405 rows)

with ssales as
(select c_last_name
      ,c_first_name
      ,s_store_name
      ,ca_state
      ,s_state
      ,i_color
      ,i_current_price
      ,i_manager_id
      ,i_units
      ,i_size
      ,sum(ss_sales_price) netpaid
from store_sales
    ,store_returns
    ,store
    ,item
    ,customer
    ,customer_address
where ss_ticket_number = sr_ticket_number
  and ss_item_sk = sr_item_sk
  and ss_customer_sk = c_customer_sk
  and ss_item_sk = i_item_sk
  and ss_store_sk = s_store_sk
  and c_birth_country = upper(ca_country)
  and s_zip = ca_zip
  and s_market_id = 7
group by c_last_name
        ,c_first_name
        ,s_store_name
        ,ca_state
        ,s_state
        ,i_color
        ,i_current_price
        ,i_manager_id
        ,i_units
        ,i_size)
select c_last_name
      ,c_first_name
      ,s_store_name
      ,sum(netpaid) paid
from ssales
where i_color = 'chiffon'
group by c_last_name
        ,c_first_name
        ,s_store_name
having sum(netpaid) > (select 0.05*avg(netpaid)
                           from ssales)
;
 c_last_name | c_first_name | s_store_name | paid 
-------------+--------------+--------------+------
(0 rows)

-- end query 1 in stream 0 using template query24.tpl
