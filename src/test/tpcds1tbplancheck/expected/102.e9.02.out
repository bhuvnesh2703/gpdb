-- start query 1 in stream 0 using template query2.tpl
explain
with wscs as
 (select sold_date_sk
        ,sales_price
  from (select ws_sold_date_sk sold_date_sk
              ,ws_ext_sales_price sales_price
        from web_sales) x
        union all
       (select cs_sold_date_sk sold_date_sk
              ,cs_ext_sales_price sales_price
        from catalog_sales)),
 wswscs as 
 (select d_week_seq,
        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,
        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,
        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,
        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,
        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,
        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,
        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales
 from wscs
     ,date_dim
 where d_date_sk = sold_date_sk
 group by d_week_seq)
 select d_week_seq1
       ,round(sun_sales1/sun_sales2,2)
       ,round(mon_sales1/mon_sales2,2)
       ,round(tue_sales1/tue_sales2,2)
       ,round(wed_sales1/wed_sales2,2)
       ,round(thu_sales1/thu_sales2,2)
       ,round(fri_sales1/fri_sales2,2)
       ,round(sat_sales1/sat_sales2,2)
 from
 (select wswscs.d_week_seq d_week_seq1
        ,sun_sales sun_sales1
        ,mon_sales mon_sales1
        ,tue_sales tue_sales1
        ,wed_sales wed_sales1
        ,thu_sales thu_sales1
        ,fri_sales fri_sales1
        ,sat_sales sat_sales1
  from wswscs,date_dim 
  where date_dim.d_week_seq = wswscs.d_week_seq and
        d_year = 2001) y,
 (select wswscs.d_week_seq d_week_seq2
        ,sun_sales sun_sales2
        ,mon_sales mon_sales2
        ,tue_sales tue_sales2
        ,wed_sales wed_sales2
        ,thu_sales thu_sales2
        ,fri_sales fri_sales2
        ,sat_sales sat_sales2
  from wswscs
      ,date_dim 
  where date_dim.d_week_seq = wswscs.d_week_seq and
        d_year = 2001+1) z
 where d_week_seq1=d_week_seq2-53
 order by d_week_seq1;
                                                                                               QUERY PLAN                                                                                                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Gather Motion 3:1  (slice8; segments: 3)  (cost=3537.56..3538.47 rows=366 width=452)
   Merge Key: date_dim_3.d_week_seq
   ->  Sort  (cost=3537.56..3538.47 rows=122 width=452)
         Sort Key: date_dim_3.d_week_seq
         ->  Hash Join  (cost=3031.49..3522.01 rows=122 width=452)
               Hash Cond: ((z.d_week_seq2 - 53) = date_dim_3.d_week_seq)
               ->  Redistribute Motion 3:3  (slice4; segments: 3)  (cost=1280.98..1753.25 rows=122 width=228)
                     Hash Key: (z.d_week_seq2 - 53)
                     ->  Subquery Scan on z  (cost=1280.98..1745.94 rows=122 width=228)
                           ->  Hash Join  (cost=1280.98..1742.29 rows=122 width=228)
                                 Hash Cond: (date_dim_1.d_week_seq = date_dim.d_week_seq)
                                 ->  HashAggregate  (cost=159306011.31..159306297.56 rows=3470 width=228)
                                       Group Key: date_dim_1.d_week_seq
                                       ->  Redistribute Motion 3:3  (slice2; segments: 3)  (cost=159305308.70..159305516.88 rows=3470 width=228)
                                             Hash Key: date_dim_1.d_week_seq
                                             ->  HashAggregate  (cost=159305308.70..159305308.70 rows=3470 width=228)
                                                   Group Key: date_dim_1.d_week_seq
                                                   ->  Hash Join  (cost=6747.79..78306040.44 rows=719993496 width=26)
                                                         Hash Cond: (wscs.sold_date_sk = date_dim_1.d_date_sk)
                                                         ->  Subquery Scan on wscs  (cost=0.00..43199609.74 rows=719993496 width=18)
                                                               ->  Append  (cost=0.00..33621463.61 rows=719993496 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_outliers  (cost=0.00..2391.21 rows=59974 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_2  (cost=0.00..94902.80 rows=2044794 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_3  (cost=0.00..98794.40 rows=2129180 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_4  (cost=0.00..95176.20 rows=2051340 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_5  (cost=0.00..98886.20 rows=2130874 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_6  (cost=0.00..98686.80 rows=2126394 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_7  (cost=0.00..98900.30 rows=2131144 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_8  (cost=0.00..98568.30 rows=2124144 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_9  (cost=0.00..143675.40 rows=3096280 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_10  (cost=0.00..224454.00 rows=4837567 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_11  (cost=0.00..224538.00 rows=4838600 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_12  (cost=0.00..232917.00 rows=5019700 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_13  (cost=0.00..340347.00 rows=7335234 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_14  (cost=0.00..339963.00 rows=7326700 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_15  (cost=0.00..128058.80 rows=2759894 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_16  (cost=0.00..98762.90 rows=2127930 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_17  (cost=0.00..95130.30 rows=2049977 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_18  (cost=0.00..98536.30 rows=2123477 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_19  (cost=0.00..98763.80 rows=2128160 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_20  (cost=0.00..98632.00 rows=2125534 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_21  (cost=0.00..98600.90 rows=2124597 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_22  (cost=0.00..139196.60 rows=2999954 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_23  (cost=0.00..224702.00 rows=4842300 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_24  (cost=0.00..224404.00 rows=4836067 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_25  (cost=0.00..228579.00 rows=4926567 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_26  (cost=0.00..340407.00 rows=7336234 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_27  (cost=0.00..339824.00 rows=7323934 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_28  (cost=0.00..136669.10 rows=2945270 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_29  (cost=0.00..98265.40 rows=2117680 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_30  (cost=0.00..98510.80 rows=2122894 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_31  (cost=0.00..98626.80 rows=2125460 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_32  (cost=0.00..98594.80 rows=2124860 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_33  (cost=0.00..98426.60 rows=2121220 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_34  (cost=0.00..98533.60 rows=2123320 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_35  (cost=0.00..134141.00 rows=2890900 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_36  (cost=0.00..224203.00 rows=4832167 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_37  (cost=0.00..224486.00 rows=4838100 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_38  (cost=0.00..224574.00 rows=4840000 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_39  (cost=0.00..339843.00 rows=7323734 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_40  (cost=0.00..339993.00 rows=7327400 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_41  (cost=0.00..141767.90 rows=3054930 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_42  (cost=0.00..98461.00 rows=2121867 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_43  (cost=0.00..95277.50 rows=2053050 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_44  (cost=0.00..98854.40 rows=2130480 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_45  (cost=0.00..98738.70 rows=2127790 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_46  (cost=0.00..98685.60 rows=2126654 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_47  (cost=0.00..98998.50 rows=2133217 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_48  (cost=0.00..125716.80 rows=2709260 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_49  (cost=0.00..224729.00 rows=4843367 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_50  (cost=0.00..224641.00 rows=4841034 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_51  (cost=0.00..224630.00 rows=4841267 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_52  (cost=0.00..332139.00 rows=7158600 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_53  (cost=0.00..340420.00 rows=7336634 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_54  (cost=0.00..162712.00 rows=3506534 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_55  (cost=0.00..98867.20 rows=2130440 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_56  (cost=0.00..95121.00 rows=2049967 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_57  (cost=0.00..98600.60 rows=2124820 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_58  (cost=0.00..98639.10 rows=2125604 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_59  (cost=0.00..98591.40 rows=2124880 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_60  (cost=0.00..98868.30 rows=2130610 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_61  (cost=0.00..121113.60 rows=2609954 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_62  (cost=0.00..224388.00 rows=4835634 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_63  (cost=0.00..224495.00 rows=4837834 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_64  (cost=0.00..224520.00 rows=4838767 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_65  (cost=0.00..328357.00 rows=7076767 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_66  (cost=0.00..340970.00 rows=7348567 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_67  (cost=0.00..97070.40 rows=2091947 width=10)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_68  (cost=0.00..1.00 rows=1 width=18)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_69  (cost=0.00..1.00 rows=1 width=18)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_70  (cost=0.00..1.00 rows=1 width=18)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_71  (cost=0.00..1.00 rows=1 width=18)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_72  (cost=0.00..1.00 rows=1 width=18)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_73  (cost=0.00..1.00 rows=1 width=18)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_74  (cost=0.00..1.00 rows=1 width=18)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_75  (cost=0.00..1.00 rows=1 width=18)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_76  (cost=0.00..1.00 rows=1 width=18)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_77  (cost=0.00..1.00 rows=1 width=18)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_78  (cost=0.00..1.00 rows=1 width=18)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_79  (cost=0.00..1.00 rows=1 width=18)
                                                                     ->  Append-only Columnar Scan on web_sales_1_prt_80  (cost=0.00..1.00 rows=1 width=18)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_outliers  (cost=0.00..95971.30 rows=2401110 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_2  (cost=0.00..198531.00 rows=4234734 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_3  (cost=0.00..198470.00 rows=4233434 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_4  (cost=0.00..191463.00 rows=4083934 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_5  (cost=0.00..198330.00 rows=4230434 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_6  (cost=0.00..198496.00 rows=4233967 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_7  (cost=0.00..198494.00 rows=4233967 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_8  (cost=0.00..198576.00 rows=4235667 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_9  (cost=0.00..297942.00 rows=6355400 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_10  (cost=0.00..451674.00 rows=9634834 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_11  (cost=0.00..451572.00 rows=9632700 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_12  (cost=0.00..476631.00 rows=10167234 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_13  (cost=0.00..684375.00 rows=14598867 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_14  (cost=0.00..684389.00 rows=14599200 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_15  (cost=0.00..215804.00 rows=4603234 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_16  (cost=0.00..198278.00 rows=4229400 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_17  (cost=0.00..191360.00 rows=4081734 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_18  (cost=0.00..198408.00 rows=4232134 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_19  (cost=0.00..198462.00 rows=4233300 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_20  (cost=0.00..198463.00 rows=4233267 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_21  (cost=0.00..198544.00 rows=4235034 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_22  (cost=0.00..288857.00 rows=6161600 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_23  (cost=0.00..451775.00 rows=9637067 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_24  (cost=0.00..451807.00 rows=9637734 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_25  (cost=0.00..468431.00 rows=9992300 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_26  (cost=0.00..684511.00 rows=14601800 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_27  (cost=0.00..684485.00 rows=14601267 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_28  (cost=0.00..232955.00 rows=4969100 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_29  (cost=0.00..198182.00 rows=4227400 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_30  (cost=0.00..198180.00 rows=4227300 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_31  (cost=0.00..198236.00 rows=4228467 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_32  (cost=0.00..198161.00 rows=4226867 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_33  (cost=0.00..198143.00 rows=4226467 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_34  (cost=0.00..198217.00 rows=4228000 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_35  (cost=0.00..279401.00 rows=5959900 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_36  (cost=0.00..451102.00 rows=9622600 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_37  (cost=0.00..451004.00 rows=9620567 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_38  (cost=0.00..459207.00 rows=9795567 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_39  (cost=0.00..683201.00 rows=14573867 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_40  (cost=0.00..683288.00 rows=14575634 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_41  (cost=0.00..267716.00 rows=5710600 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_42  (cost=0.00..198348.00 rows=4230867 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_43  (cost=0.00..191374.00 rows=4082034 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_44  (cost=0.00..198449.00 rows=4233067 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_45  (cost=0.00..198436.00 rows=4232667 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_46  (cost=0.00..198484.00 rows=4233767 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_47  (cost=0.00..198486.00 rows=4233767 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_48  (cost=0.00..261759.00 rows=5583500 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_49  (cost=0.00..451867.00 rows=9638934 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_50  (cost=0.00..451711.00 rows=9635634 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_51  (cost=0.00..451715.00 rows=9635700 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_52  (cost=0.00..676048.00 rows=14421300 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_53  (cost=0.00..684330.00 rows=14597934 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_54  (cost=0.00..285353.00 rows=6086800 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_55  (cost=0.00..198500.00 rows=4234067 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_56  (cost=0.00..191327.00 rows=4081100 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_57  (cost=0.00..198470.00 rows=4233434 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_58  (cost=0.00..198434.00 rows=4232667 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_59  (cost=0.00..198457.00 rows=4233100 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_60  (cost=0.00..198420.00 rows=4232400 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_61  (cost=0.00..252732.00 rows=5390967 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_62  (cost=0.00..451735.00 rows=9636134 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_63  (cost=0.00..451761.00 rows=9636700 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_64  (cost=0.00..451680.00 rows=9634900 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_65  (cost=0.00..667727.00 rows=14243734 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_66  (cost=0.00..684173.00 rows=14594534 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_67  (cost=0.00..244531.00 rows=5216100 width=10)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_68  (cost=0.00..1.00 rows=1 width=18)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_69  (cost=0.00..1.00 rows=1 width=18)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_70  (cost=0.00..1.00 rows=1 width=18)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_71  (cost=0.00..1.00 rows=1 width=18)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_72  (cost=0.00..1.00 rows=1 width=18)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_73  (cost=0.00..1.00 rows=1 width=18)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_74  (cost=0.00..1.00 rows=1 width=18)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_75  (cost=0.00..1.00 rows=1 width=18)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_76  (cost=0.00..1.00 rows=1 width=18)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_77  (cost=0.00..1.00 rows=1 width=18)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_78  (cost=0.00..1.00 rows=1 width=18)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_79  (cost=0.00..1.00 rows=1 width=18)
                                                                     ->  Append-only Columnar Scan on catalog_sales_1_prt_80  (cost=0.00..1.00 rows=1 width=18)
                                                         ->  Hash  (cost=4008.45..4008.45 rows=73049 width=16)
                                                               ->  Broadcast Motion 3:3  (slice1; segments: 3)  (cost=0.00..4008.45 rows=73049 width=16)
                                                                     ->  Seq Scan on date_dim date_dim_1  (cost=0.00..1086.49 rows=24350 width=16)
                                 ->  Hash  (cost=1276.42..1276.42 rows=122 width=4)
                                       ->  Redistribute Motion 3:3  (slice3; segments: 3)  (cost=0.00..1276.42 rows=122 width=4)
                                             Hash Key: date_dim.d_week_seq
                                             ->  Seq Scan on date_dim  (cost=0.00..1269.11 rows=122 width=4)
                                                   Filter: (d_year = 2002)
               ->  Hash  (cost=1745.94..1745.94 rows=122 width=228)
                     ->  Hash Join  (cost=1280.98..1742.29 rows=122 width=228)
                           Hash Cond: (date_dim_3.d_week_seq = date_dim_2.d_week_seq)
                           ->  HashAggregate  (cost=159306011.31..159306297.56 rows=3470 width=228)
                                 Group Key: date_dim_3.d_week_seq
                                 ->  Redistribute Motion 3:3  (slice6; segments: 3)  (cost=159305308.70..159305516.88 rows=3470 width=228)
                                       Hash Key: date_dim_3.d_week_seq
                                       ->  HashAggregate  (cost=159305308.70..159305308.70 rows=3470 width=228)
                                             Group Key: date_dim_3.d_week_seq
                                             ->  Hash Join  (cost=6747.79..78306040.44 rows=719993496 width=26)
                                                   Hash Cond: (wscs_1.sold_date_sk = date_dim_3.d_date_sk)
                                                   ->  Subquery Scan on wscs_1  (cost=0.00..43199609.74 rows=719993496 width=18)
                                                         ->  Append  (cost=0.00..33621463.61 rows=719993496 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_outliers web_sales_1_prt_outliers_1  (cost=0.00..2391.21 rows=59974 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_2 web_sales_1_prt_2_1  (cost=0.00..94902.80 rows=2044794 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_3 web_sales_1_prt_3_1  (cost=0.00..98794.40 rows=2129180 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_4 web_sales_1_prt_4_1  (cost=0.00..95176.20 rows=2051340 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_5 web_sales_1_prt_5_1  (cost=0.00..98886.20 rows=2130874 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_6 web_sales_1_prt_6_1  (cost=0.00..98686.80 rows=2126394 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_7 web_sales_1_prt_7_1  (cost=0.00..98900.30 rows=2131144 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_8 web_sales_1_prt_8_1  (cost=0.00..98568.30 rows=2124144 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_9 web_sales_1_prt_9_1  (cost=0.00..143675.40 rows=3096280 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_10 web_sales_1_prt_10_1  (cost=0.00..224454.00 rows=4837567 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_11 web_sales_1_prt_11_1  (cost=0.00..224538.00 rows=4838600 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_12 web_sales_1_prt_12_1  (cost=0.00..232917.00 rows=5019700 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_13 web_sales_1_prt_13_1  (cost=0.00..340347.00 rows=7335234 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_14 web_sales_1_prt_14_1  (cost=0.00..339963.00 rows=7326700 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_15 web_sales_1_prt_15_1  (cost=0.00..128058.80 rows=2759894 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_16 web_sales_1_prt_16_1  (cost=0.00..98762.90 rows=2127930 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_17 web_sales_1_prt_17_1  (cost=0.00..95130.30 rows=2049977 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_18 web_sales_1_prt_18_1  (cost=0.00..98536.30 rows=2123477 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_19 web_sales_1_prt_19_1  (cost=0.00..98763.80 rows=2128160 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_20 web_sales_1_prt_20_1  (cost=0.00..98632.00 rows=2125534 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_21 web_sales_1_prt_21_1  (cost=0.00..98600.90 rows=2124597 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_22 web_sales_1_prt_22_1  (cost=0.00..139196.60 rows=2999954 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_23 web_sales_1_prt_23_1  (cost=0.00..224702.00 rows=4842300 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_24 web_sales_1_prt_24_1  (cost=0.00..224404.00 rows=4836067 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_25 web_sales_1_prt_25_1  (cost=0.00..228579.00 rows=4926567 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_26 web_sales_1_prt_26_1  (cost=0.00..340407.00 rows=7336234 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_27 web_sales_1_prt_27_1  (cost=0.00..339824.00 rows=7323934 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_28 web_sales_1_prt_28_1  (cost=0.00..136669.10 rows=2945270 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_29 web_sales_1_prt_29_1  (cost=0.00..98265.40 rows=2117680 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_30 web_sales_1_prt_30_1  (cost=0.00..98510.80 rows=2122894 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_31 web_sales_1_prt_31_1  (cost=0.00..98626.80 rows=2125460 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_32 web_sales_1_prt_32_1  (cost=0.00..98594.80 rows=2124860 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_33 web_sales_1_prt_33_1  (cost=0.00..98426.60 rows=2121220 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_34 web_sales_1_prt_34_1  (cost=0.00..98533.60 rows=2123320 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_35 web_sales_1_prt_35_1  (cost=0.00..134141.00 rows=2890900 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_36 web_sales_1_prt_36_1  (cost=0.00..224203.00 rows=4832167 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_37 web_sales_1_prt_37_1  (cost=0.00..224486.00 rows=4838100 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_38 web_sales_1_prt_38_1  (cost=0.00..224574.00 rows=4840000 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_39 web_sales_1_prt_39_1  (cost=0.00..339843.00 rows=7323734 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_40 web_sales_1_prt_40_1  (cost=0.00..339993.00 rows=7327400 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_41 web_sales_1_prt_41_1  (cost=0.00..141767.90 rows=3054930 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_42 web_sales_1_prt_42_1  (cost=0.00..98461.00 rows=2121867 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_43 web_sales_1_prt_43_1  (cost=0.00..95277.50 rows=2053050 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_44 web_sales_1_prt_44_1  (cost=0.00..98854.40 rows=2130480 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_45 web_sales_1_prt_45_1  (cost=0.00..98738.70 rows=2127790 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_46 web_sales_1_prt_46_1  (cost=0.00..98685.60 rows=2126654 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_47 web_sales_1_prt_47_1  (cost=0.00..98998.50 rows=2133217 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_48 web_sales_1_prt_48_1  (cost=0.00..125716.80 rows=2709260 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_49 web_sales_1_prt_49_1  (cost=0.00..224729.00 rows=4843367 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_50 web_sales_1_prt_50_1  (cost=0.00..224641.00 rows=4841034 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_51 web_sales_1_prt_51_1  (cost=0.00..224630.00 rows=4841267 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_52 web_sales_1_prt_52_1  (cost=0.00..332139.00 rows=7158600 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_53 web_sales_1_prt_53_1  (cost=0.00..340420.00 rows=7336634 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_54 web_sales_1_prt_54_1  (cost=0.00..162712.00 rows=3506534 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_55 web_sales_1_prt_55_1  (cost=0.00..98867.20 rows=2130440 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_56 web_sales_1_prt_56_1  (cost=0.00..95121.00 rows=2049967 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_57 web_sales_1_prt_57_1  (cost=0.00..98600.60 rows=2124820 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_58 web_sales_1_prt_58_1  (cost=0.00..98639.10 rows=2125604 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_59 web_sales_1_prt_59_1  (cost=0.00..98591.40 rows=2124880 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_60 web_sales_1_prt_60_1  (cost=0.00..98868.30 rows=2130610 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_61 web_sales_1_prt_61_1  (cost=0.00..121113.60 rows=2609954 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_62 web_sales_1_prt_62_1  (cost=0.00..224388.00 rows=4835634 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_63 web_sales_1_prt_63_1  (cost=0.00..224495.00 rows=4837834 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_64 web_sales_1_prt_64_1  (cost=0.00..224520.00 rows=4838767 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_65 web_sales_1_prt_65_1  (cost=0.00..328357.00 rows=7076767 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_66 web_sales_1_prt_66_1  (cost=0.00..340970.00 rows=7348567 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_67 web_sales_1_prt_67_1  (cost=0.00..97070.40 rows=2091947 width=10)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_68 web_sales_1_prt_68_1  (cost=0.00..1.00 rows=1 width=18)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_69 web_sales_1_prt_69_1  (cost=0.00..1.00 rows=1 width=18)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_70 web_sales_1_prt_70_1  (cost=0.00..1.00 rows=1 width=18)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_71 web_sales_1_prt_71_1  (cost=0.00..1.00 rows=1 width=18)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_72 web_sales_1_prt_72_1  (cost=0.00..1.00 rows=1 width=18)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_73 web_sales_1_prt_73_1  (cost=0.00..1.00 rows=1 width=18)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_74 web_sales_1_prt_74_1  (cost=0.00..1.00 rows=1 width=18)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_75 web_sales_1_prt_75_1  (cost=0.00..1.00 rows=1 width=18)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_76 web_sales_1_prt_76_1  (cost=0.00..1.00 rows=1 width=18)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_77 web_sales_1_prt_77_1  (cost=0.00..1.00 rows=1 width=18)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_78 web_sales_1_prt_78_1  (cost=0.00..1.00 rows=1 width=18)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_79 web_sales_1_prt_79_1  (cost=0.00..1.00 rows=1 width=18)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_80 web_sales_1_prt_80_1  (cost=0.00..1.00 rows=1 width=18)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_outliers catalog_sales_1_prt_outliers_1  (cost=0.00..95971.30 rows=2401110 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_2 catalog_sales_1_prt_2_1  (cost=0.00..198531.00 rows=4234734 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_3 catalog_sales_1_prt_3_1  (cost=0.00..198470.00 rows=4233434 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_4 catalog_sales_1_prt_4_1  (cost=0.00..191463.00 rows=4083934 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_5 catalog_sales_1_prt_5_1  (cost=0.00..198330.00 rows=4230434 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_6 catalog_sales_1_prt_6_1  (cost=0.00..198496.00 rows=4233967 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_7 catalog_sales_1_prt_7_1  (cost=0.00..198494.00 rows=4233967 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_8 catalog_sales_1_prt_8_1  (cost=0.00..198576.00 rows=4235667 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_9 catalog_sales_1_prt_9_1  (cost=0.00..297942.00 rows=6355400 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_10 catalog_sales_1_prt_10_1  (cost=0.00..451674.00 rows=9634834 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_11 catalog_sales_1_prt_11_1  (cost=0.00..451572.00 rows=9632700 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_12 catalog_sales_1_prt_12_1  (cost=0.00..476631.00 rows=10167234 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_13 catalog_sales_1_prt_13_1  (cost=0.00..684375.00 rows=14598867 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_14 catalog_sales_1_prt_14_1  (cost=0.00..684389.00 rows=14599200 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_15 catalog_sales_1_prt_15_1  (cost=0.00..215804.00 rows=4603234 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_16 catalog_sales_1_prt_16_1  (cost=0.00..198278.00 rows=4229400 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_17 catalog_sales_1_prt_17_1  (cost=0.00..191360.00 rows=4081734 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_18 catalog_sales_1_prt_18_1  (cost=0.00..198408.00 rows=4232134 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_19 catalog_sales_1_prt_19_1  (cost=0.00..198462.00 rows=4233300 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_20 catalog_sales_1_prt_20_1  (cost=0.00..198463.00 rows=4233267 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_21 catalog_sales_1_prt_21_1  (cost=0.00..198544.00 rows=4235034 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_22 catalog_sales_1_prt_22_1  (cost=0.00..288857.00 rows=6161600 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_23 catalog_sales_1_prt_23_1  (cost=0.00..451775.00 rows=9637067 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_24 catalog_sales_1_prt_24_1  (cost=0.00..451807.00 rows=9637734 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_25 catalog_sales_1_prt_25_1  (cost=0.00..468431.00 rows=9992300 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_26 catalog_sales_1_prt_26_1  (cost=0.00..684511.00 rows=14601800 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_27 catalog_sales_1_prt_27_1  (cost=0.00..684485.00 rows=14601267 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_28 catalog_sales_1_prt_28_1  (cost=0.00..232955.00 rows=4969100 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_29 catalog_sales_1_prt_29_1  (cost=0.00..198182.00 rows=4227400 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_30 catalog_sales_1_prt_30_1  (cost=0.00..198180.00 rows=4227300 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_31 catalog_sales_1_prt_31_1  (cost=0.00..198236.00 rows=4228467 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_32 catalog_sales_1_prt_32_1  (cost=0.00..198161.00 rows=4226867 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_33 catalog_sales_1_prt_33_1  (cost=0.00..198143.00 rows=4226467 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_34 catalog_sales_1_prt_34_1  (cost=0.00..198217.00 rows=4228000 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_35 catalog_sales_1_prt_35_1  (cost=0.00..279401.00 rows=5959900 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_36 catalog_sales_1_prt_36_1  (cost=0.00..451102.00 rows=9622600 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_37 catalog_sales_1_prt_37_1  (cost=0.00..451004.00 rows=9620567 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_38 catalog_sales_1_prt_38_1  (cost=0.00..459207.00 rows=9795567 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_39 catalog_sales_1_prt_39_1  (cost=0.00..683201.00 rows=14573867 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_40 catalog_sales_1_prt_40_1  (cost=0.00..683288.00 rows=14575634 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_41 catalog_sales_1_prt_41_1  (cost=0.00..267716.00 rows=5710600 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_42 catalog_sales_1_prt_42_1  (cost=0.00..198348.00 rows=4230867 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_43 catalog_sales_1_prt_43_1  (cost=0.00..191374.00 rows=4082034 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_44 catalog_sales_1_prt_44_1  (cost=0.00..198449.00 rows=4233067 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_45 catalog_sales_1_prt_45_1  (cost=0.00..198436.00 rows=4232667 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_46 catalog_sales_1_prt_46_1  (cost=0.00..198484.00 rows=4233767 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_47 catalog_sales_1_prt_47_1  (cost=0.00..198486.00 rows=4233767 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_48 catalog_sales_1_prt_48_1  (cost=0.00..261759.00 rows=5583500 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_49 catalog_sales_1_prt_49_1  (cost=0.00..451867.00 rows=9638934 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_50 catalog_sales_1_prt_50_1  (cost=0.00..451711.00 rows=9635634 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_51 catalog_sales_1_prt_51_1  (cost=0.00..451715.00 rows=9635700 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_52 catalog_sales_1_prt_52_1  (cost=0.00..676048.00 rows=14421300 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_53 catalog_sales_1_prt_53_1  (cost=0.00..684330.00 rows=14597934 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_54 catalog_sales_1_prt_54_1  (cost=0.00..285353.00 rows=6086800 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_55 catalog_sales_1_prt_55_1  (cost=0.00..198500.00 rows=4234067 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_56 catalog_sales_1_prt_56_1  (cost=0.00..191327.00 rows=4081100 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_57 catalog_sales_1_prt_57_1  (cost=0.00..198470.00 rows=4233434 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_58 catalog_sales_1_prt_58_1  (cost=0.00..198434.00 rows=4232667 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_59 catalog_sales_1_prt_59_1  (cost=0.00..198457.00 rows=4233100 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_60 catalog_sales_1_prt_60_1  (cost=0.00..198420.00 rows=4232400 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_61 catalog_sales_1_prt_61_1  (cost=0.00..252732.00 rows=5390967 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_62 catalog_sales_1_prt_62_1  (cost=0.00..451735.00 rows=9636134 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_63 catalog_sales_1_prt_63_1  (cost=0.00..451761.00 rows=9636700 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_64 catalog_sales_1_prt_64_1  (cost=0.00..451680.00 rows=9634900 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_65 catalog_sales_1_prt_65_1  (cost=0.00..667727.00 rows=14243734 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_66 catalog_sales_1_prt_66_1  (cost=0.00..684173.00 rows=14594534 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_67 catalog_sales_1_prt_67_1  (cost=0.00..244531.00 rows=5216100 width=10)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_68 catalog_sales_1_prt_68_1  (cost=0.00..1.00 rows=1 width=18)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_69 catalog_sales_1_prt_69_1  (cost=0.00..1.00 rows=1 width=18)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_70 catalog_sales_1_prt_70_1  (cost=0.00..1.00 rows=1 width=18)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_71 catalog_sales_1_prt_71_1  (cost=0.00..1.00 rows=1 width=18)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_72 catalog_sales_1_prt_72_1  (cost=0.00..1.00 rows=1 width=18)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_73 catalog_sales_1_prt_73_1  (cost=0.00..1.00 rows=1 width=18)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_74 catalog_sales_1_prt_74_1  (cost=0.00..1.00 rows=1 width=18)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_75 catalog_sales_1_prt_75_1  (cost=0.00..1.00 rows=1 width=18)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_76 catalog_sales_1_prt_76_1  (cost=0.00..1.00 rows=1 width=18)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_77 catalog_sales_1_prt_77_1  (cost=0.00..1.00 rows=1 width=18)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_78 catalog_sales_1_prt_78_1  (cost=0.00..1.00 rows=1 width=18)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_79 catalog_sales_1_prt_79_1  (cost=0.00..1.00 rows=1 width=18)
                                                               ->  Append-only Columnar Scan on catalog_sales_1_prt_80 catalog_sales_1_prt_80_1  (cost=0.00..1.00 rows=1 width=18)
                                                   ->  Hash  (cost=4008.45..4008.45 rows=73049 width=16)
                                                         ->  Broadcast Motion 3:3  (slice5; segments: 3)  (cost=0.00..4008.45 rows=73049 width=16)
                                                               ->  Seq Scan on date_dim date_dim_3  (cost=0.00..1086.49 rows=24350 width=16)
                           ->  Hash  (cost=1276.42..1276.42 rows=122 width=4)
                                 ->  Redistribute Motion 3:3  (slice7; segments: 3)  (cost=0.00..1276.42 rows=122 width=4)
                                       Hash Key: date_dim_2.d_week_seq
                                       ->  Seq Scan on date_dim date_dim_2  (cost=0.00..1269.11 rows=122 width=4)
                                             Filter: (d_year = 2001)
 Planning time: 38.419 ms
 Optimizer: legacy query optimizer
(372 rows)

-- end query 1 in stream 0 using template query2.tpl
