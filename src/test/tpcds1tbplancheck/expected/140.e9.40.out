-- start query 1 in stream 0 using template query40.tpl
explain
select  
   w_state
  ,i_item_id
  ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date)) 
 		then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before
  ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date)) 
 		then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after
 from
   catalog_sales left outer join catalog_returns on
       (cs_order_number = cr_order_number 
        and cs_item_sk = cr_item_sk)
  ,warehouse 
  ,item
  ,date_dim
 where
     i_current_price between 0.99 and 1.49
 and i_item_sk          = cs_item_sk
 and cs_warehouse_sk    = w_warehouse_sk 
 and cs_sold_date_sk    = d_date_sk
 and d_date between (cast ('1998-04-08' as date) - 30 )
                and (cast ('1998-04-08' as date) + 30 ) 
 group by
    w_state,i_item_id
 order by w_state,i_item_id
limit 100;
                                                                                                                        QUERY PLAN                                                                                                                        
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=36224092.07..36224094.32 rows=100 width=126)
   ->  Gather Motion 3:1  (slice5; segments: 3)  (cost=36224092.07..36224094.32 rows=100 width=126)
         Merge Key: warehouse.w_state, item.i_item_id
         ->  Limit  (cost=36224092.07..36224092.32 rows=34 width=126)
               ->  Sort  (cost=36224092.07..36224292.09 rows=26670 width=126)
                     Sort Key: warehouse.w_state, item.i_item_id
                     ->  HashAggregate  (cost=36219834.05..36221034.18 rows=26670 width=126)
                           Group Key: warehouse.w_state, item.i_item_id
                           ->  Redistribute Motion 3:3  (slice4; segments: 3)  (cost=36215833.60..36217433.78 rows=26670 width=126)
                                 Hash Key: warehouse.w_state, item.i_item_id
                                 ->  HashAggregate  (cost=36215833.60..36215833.60 rows=26670 width=126)
                                       Group Key: warehouse.w_state, item.i_item_id
                                       ->  Hash Join  (cost=31517864.59..36214233.41 rows=26670 width=36)
                                             Hash Cond: (catalog_sales_1_prt_outliers.cs_warehouse_sk = warehouse.w_warehouse_sk)
                                             ->  Hash Right Join  (cost=31517847.84..36212915.10 rows=26745 width=37)
                                                   Hash Cond: ((catalog_returns_1_prt_outliers.cr_order_number = catalog_sales_1_prt_outliers.cs_order_number) AND (catalog_returns_1_prt_outliers.cr_item_sk = catalog_sales_1_prt_outliers.cs_item_sk))
                                                   ->  Append  (cost=0.00..2048707.25 rows=47998910 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_outliers  (cost=0.00..1.00 rows=1 width=26)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_2  (cost=0.00..89.94 rows=1932 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_3  (cost=0.00..839.14 rows=19405 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_4  (cost=0.00..2485.51 rows=57851 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_5  (cost=0.00..4960.98 rows=115933 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_6  (cost=0.00..7782.08 rows=182003 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_7  (cost=0.00..10621.88 rows=248696 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_8  (cost=0.00..13478.93 rows=315565 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_9  (cost=0.00..15896.40 rows=372214 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_10  (cost=0.00..17750.30 rows=415710 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_11  (cost=0.00..19794.70 rows=463690 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_12  (cost=0.00..22437.10 rows=525604 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_13  (cost=0.00..26080.50 rows=611050 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_14  (cost=0.00..30734.10 rows=720170 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_15  (cost=0.00..36307.80 rows=850860 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_16  (cost=0.00..41041.30 rows=961744 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_17  (cost=0.00..43099.50 rows=1009950 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_18  (cost=0.00..41879.10 rows=981337 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_19  (cost=0.00..38497.60 rows=902120 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_20  (cost=0.00..34174.60 rows=800720 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_21  (cost=0.00..28866.00 rows=676300 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_22  (cost=0.00..23528.20 rows=551174 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_23  (cost=0.00..20118.40 rows=471247 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_24  (cost=0.00..19874.50 rows=465584 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_25  (cost=0.00..22296.70 rows=522290 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_26  (cost=0.00..25917.20 rows=607140 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_27  (cost=0.00..30522.50 rows=715184 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_28  (cost=0.00..36052.80 rows=844894 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_29  (cost=0.00..40956.30 rows=959777 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_30  (cost=0.00..43148.40 rows=1011214 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_31  (cost=0.00..42010.00 rows=984434 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_32  (cost=0.00..38722.30 rows=907377 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_33  (cost=0.00..34426.40 rows=806647 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_34  (cost=0.00..29177.30 rows=683644 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_35  (cost=0.00..23787.80 rows=557327 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_36  (cost=0.00..20236.00 rows=474067 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_37  (cost=0.00..19907.20 rows=466240 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_38  (cost=0.00..22185.10 rows=519704 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_39  (cost=0.00..25740.00 rows=603100 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_40  (cost=0.00..30341.40 rows=710914 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_41  (cost=0.00..35869.30 rows=840477 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_42  (cost=0.00..40858.00 rows=957467 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_43  (cost=0.00..43189.40 rows=1012114 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_44  (cost=0.00..42208.80 rows=989160 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_45  (cost=0.00..39037.10 rows=914804 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_46  (cost=0.00..34783.00 rows=815100 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_47  (cost=0.00..29479.40 rows=690714 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_48  (cost=0.00..24074.70 rows=564057 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_49  (cost=0.00..20308.20 rows=475707 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_50  (cost=0.00..19762.20 rows=462907 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_51  (cost=0.00..21941.80 rows=513960 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_52  (cost=0.00..25524.00 rows=598034 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_53  (cost=0.00..29988.40 rows=702614 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_54  (cost=0.00..35472.20 rows=831174 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_55  (cost=0.00..40521.40 rows=949514 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_56  (cost=0.00..43037.90 rows=1008564 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_57  (cost=0.00..42199.20 rows=988874 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_58  (cost=0.00..39131.90 rows=916964 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_59  (cost=0.00..34896.90 rows=817730 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_60  (cost=0.00..29665.40 rows=695080 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_61  (cost=0.00..24208.60 rows=567154 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_62  (cost=0.00..20387.30 rows=477644 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_63  (cost=0.00..19741.20 rows=462340 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_64  (cost=0.00..21867.20 rows=512274 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_65  (cost=0.00..25350.50 rows=593884 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_66  (cost=0.00..29837.00 rows=699100 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_67  (cost=0.00..35270.90 rows=826464 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_68  (cost=0.00..40185.20 rows=941674 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_69  (cost=0.00..41789.50 rows=979317 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_70  (cost=0.00..39187.40 rows=918347 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_71  (cost=0.00..33506.60 rows=785120 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_72  (cost=0.00..26483.20 rows=620407 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_73  (cost=0.00..18408.20 rows=431207 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_74  (cost=0.00..10161.74 rows=237858 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_75  (cost=0.00..3892.67 rows=90823 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_76  (cost=0.00..672.49 rows=15283 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_77  (cost=0.00..38.39 rows=213 width=18)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_78  (cost=0.00..1.00 rows=1 width=26)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_79  (cost=0.00..1.00 rows=1 width=26)
                                                         ->  Append-only Columnar Scan on catalog_returns_1_prt_80  (cost=0.00..1.00 rows=1 width=26)
                                                   ->  Hash  (cost=31516644.33..31516644.33 rows=26745 width=43)
                                                         ->  Hash Join  (cost=10437.58..31516644.33 rows=26745 width=43)
                                                               Hash Cond: (catalog_sales_1_prt_outliers.cs_item_sk = item.i_item_sk)
                                                               ->  Hash Join  (cost=1456.60..31499124.73 rows=412602 width=26)
                                                                     Hash Cond: (catalog_sales_1_prt_outliers.cs_sold_date_sk = date_dim.d_date_sk)
                                                                     ->  Append  (cost=0.00..22485412.30 rows=479993481 width=26)
                                                                           ->  Result  (cost=0.00..95971.30 rows=2401110 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_outliers  (cost=0.00..95971.30 rows=2401110 width=26)
                                                                           ->  Result  (cost=0.00..198531.00 rows=4234734 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_2  (cost=0.00..198531.00 rows=4234734 width=26)
                                                                           ->  Result  (cost=0.00..198470.00 rows=4233434 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_3  (cost=0.00..198470.00 rows=4233434 width=26)
                                                                           ->  Result  (cost=0.00..191463.00 rows=4083934 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_4  (cost=0.00..191463.00 rows=4083934 width=26)
                                                                           ->  Result  (cost=0.00..198330.00 rows=4230434 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_5  (cost=0.00..198330.00 rows=4230434 width=26)
                                                                           ->  Result  (cost=0.00..198496.00 rows=4233967 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_6  (cost=0.00..198496.00 rows=4233967 width=26)
                                                                           ->  Result  (cost=0.00..198494.00 rows=4233967 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_7  (cost=0.00..198494.00 rows=4233967 width=26)
                                                                           ->  Result  (cost=0.00..198576.00 rows=4235667 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_8  (cost=0.00..198576.00 rows=4235667 width=26)
                                                                           ->  Result  (cost=0.00..297942.00 rows=6355400 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_9  (cost=0.00..297942.00 rows=6355400 width=26)
                                                                           ->  Result  (cost=0.00..451674.00 rows=9634834 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_10  (cost=0.00..451674.00 rows=9634834 width=26)
                                                                           ->  Result  (cost=0.00..451572.00 rows=9632700 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_11  (cost=0.00..451572.00 rows=9632700 width=26)
                                                                           ->  Result  (cost=0.00..476631.00 rows=10167234 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_12  (cost=0.00..476631.00 rows=10167234 width=26)
                                                                           ->  Result  (cost=0.00..684375.00 rows=14598867 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_13  (cost=0.00..684375.00 rows=14598867 width=26)
                                                                           ->  Result  (cost=0.00..684389.00 rows=14599200 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_14  (cost=0.00..684389.00 rows=14599200 width=26)
                                                                           ->  Result  (cost=0.00..215804.00 rows=4603234 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_15  (cost=0.00..215804.00 rows=4603234 width=26)
                                                                           ->  Result  (cost=0.00..198278.00 rows=4229400 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_16  (cost=0.00..198278.00 rows=4229400 width=26)
                                                                           ->  Result  (cost=0.00..191360.00 rows=4081734 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_17  (cost=0.00..191360.00 rows=4081734 width=26)
                                                                           ->  Result  (cost=0.00..198408.00 rows=4232134 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_18  (cost=0.00..198408.00 rows=4232134 width=26)
                                                                           ->  Result  (cost=0.00..198462.00 rows=4233300 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_19  (cost=0.00..198462.00 rows=4233300 width=26)
                                                                           ->  Result  (cost=0.00..198463.00 rows=4233267 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_20  (cost=0.00..198463.00 rows=4233267 width=26)
                                                                           ->  Result  (cost=0.00..198544.00 rows=4235034 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_21  (cost=0.00..198544.00 rows=4235034 width=26)
                                                                           ->  Result  (cost=0.00..288857.00 rows=6161600 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_22  (cost=0.00..288857.00 rows=6161600 width=26)
                                                                           ->  Result  (cost=0.00..451775.00 rows=9637067 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_23  (cost=0.00..451775.00 rows=9637067 width=26)
                                                                           ->  Result  (cost=0.00..451807.00 rows=9637734 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_24  (cost=0.00..451807.00 rows=9637734 width=26)
                                                                           ->  Result  (cost=0.00..468431.00 rows=9992300 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_25  (cost=0.00..468431.00 rows=9992300 width=26)
                                                                           ->  Result  (cost=0.00..684511.00 rows=14601800 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_26  (cost=0.00..684511.00 rows=14601800 width=26)
                                                                           ->  Result  (cost=0.00..684485.00 rows=14601267 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_27  (cost=0.00..684485.00 rows=14601267 width=26)
                                                                           ->  Result  (cost=0.00..232955.00 rows=4969100 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_28  (cost=0.00..232955.00 rows=4969100 width=26)
                                                                           ->  Result  (cost=0.00..198182.00 rows=4227400 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_29  (cost=0.00..198182.00 rows=4227400 width=26)
                                                                           ->  Result  (cost=0.00..198180.00 rows=4227300 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_30  (cost=0.00..198180.00 rows=4227300 width=26)
                                                                           ->  Result  (cost=0.00..198236.00 rows=4228467 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_31  (cost=0.00..198236.00 rows=4228467 width=26)
                                                                           ->  Result  (cost=0.00..198161.00 rows=4226867 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_32  (cost=0.00..198161.00 rows=4226867 width=26)
                                                                           ->  Result  (cost=0.00..198143.00 rows=4226467 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_33  (cost=0.00..198143.00 rows=4226467 width=26)
                                                                           ->  Result  (cost=0.00..198217.00 rows=4228000 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_34  (cost=0.00..198217.00 rows=4228000 width=26)
                                                                           ->  Result  (cost=0.00..279401.00 rows=5959900 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_35  (cost=0.00..279401.00 rows=5959900 width=26)
                                                                           ->  Result  (cost=0.00..451102.00 rows=9622600 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_36  (cost=0.00..451102.00 rows=9622600 width=26)
                                                                           ->  Result  (cost=0.00..451004.00 rows=9620567 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_37  (cost=0.00..451004.00 rows=9620567 width=26)
                                                                           ->  Result  (cost=0.00..459207.00 rows=9795567 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_38  (cost=0.00..459207.00 rows=9795567 width=26)
                                                                           ->  Result  (cost=0.00..683201.00 rows=14573867 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_39  (cost=0.00..683201.00 rows=14573867 width=26)
                                                                           ->  Result  (cost=0.00..683288.00 rows=14575634 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_40  (cost=0.00..683288.00 rows=14575634 width=26)
                                                                           ->  Result  (cost=0.00..267716.00 rows=5710600 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_41  (cost=0.00..267716.00 rows=5710600 width=26)
                                                                           ->  Result  (cost=0.00..198348.00 rows=4230867 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_42  (cost=0.00..198348.00 rows=4230867 width=26)
                                                                           ->  Result  (cost=0.00..191374.00 rows=4082034 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_43  (cost=0.00..191374.00 rows=4082034 width=26)
                                                                           ->  Result  (cost=0.00..198449.00 rows=4233067 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_44  (cost=0.00..198449.00 rows=4233067 width=26)
                                                                           ->  Result  (cost=0.00..198436.00 rows=4232667 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_45  (cost=0.00..198436.00 rows=4232667 width=26)
                                                                           ->  Result  (cost=0.00..198484.00 rows=4233767 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_46  (cost=0.00..198484.00 rows=4233767 width=26)
                                                                           ->  Result  (cost=0.00..198486.00 rows=4233767 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_47  (cost=0.00..198486.00 rows=4233767 width=26)
                                                                           ->  Result  (cost=0.00..261759.00 rows=5583500 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_48  (cost=0.00..261759.00 rows=5583500 width=26)
                                                                           ->  Result  (cost=0.00..451867.00 rows=9638934 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_49  (cost=0.00..451867.00 rows=9638934 width=26)
                                                                           ->  Result  (cost=0.00..451711.00 rows=9635634 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_50  (cost=0.00..451711.00 rows=9635634 width=26)
                                                                           ->  Result  (cost=0.00..451715.00 rows=9635700 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_51  (cost=0.00..451715.00 rows=9635700 width=26)
                                                                           ->  Result  (cost=0.00..676048.00 rows=14421300 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_52  (cost=0.00..676048.00 rows=14421300 width=26)
                                                                           ->  Result  (cost=0.00..684330.00 rows=14597934 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_53  (cost=0.00..684330.00 rows=14597934 width=26)
                                                                           ->  Result  (cost=0.00..285353.00 rows=6086800 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_54  (cost=0.00..285353.00 rows=6086800 width=26)
                                                                           ->  Result  (cost=0.00..198500.00 rows=4234067 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_55  (cost=0.00..198500.00 rows=4234067 width=26)
                                                                           ->  Result  (cost=0.00..191327.00 rows=4081100 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_56  (cost=0.00..191327.00 rows=4081100 width=26)
                                                                           ->  Result  (cost=0.00..198470.00 rows=4233434 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_57  (cost=0.00..198470.00 rows=4233434 width=26)
                                                                           ->  Result  (cost=0.00..198434.00 rows=4232667 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_58  (cost=0.00..198434.00 rows=4232667 width=26)
                                                                           ->  Result  (cost=0.00..198457.00 rows=4233100 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_59  (cost=0.00..198457.00 rows=4233100 width=26)
                                                                           ->  Result  (cost=0.00..198420.00 rows=4232400 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_60  (cost=0.00..198420.00 rows=4232400 width=26)
                                                                           ->  Result  (cost=0.00..252732.00 rows=5390967 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_61  (cost=0.00..252732.00 rows=5390967 width=26)
                                                                           ->  Result  (cost=0.00..451735.00 rows=9636134 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_62  (cost=0.00..451735.00 rows=9636134 width=26)
                                                                           ->  Result  (cost=0.00..451761.00 rows=9636700 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_63  (cost=0.00..451761.00 rows=9636700 width=26)
                                                                           ->  Result  (cost=0.00..451680.00 rows=9634900 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_64  (cost=0.00..451680.00 rows=9634900 width=26)
                                                                           ->  Result  (cost=0.00..667727.00 rows=14243734 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_65  (cost=0.00..667727.00 rows=14243734 width=26)
                                                                           ->  Result  (cost=0.00..684173.00 rows=14594534 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_66  (cost=0.00..684173.00 rows=14594534 width=26)
                                                                           ->  Result  (cost=0.00..244531.00 rows=5216100 width=26)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_67  (cost=0.00..244531.00 rows=5216100 width=26)
                                                                           ->  Result  (cost=0.00..1.00 rows=1 width=34)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_68  (cost=0.00..1.00 rows=1 width=34)
                                                                           ->  Result  (cost=0.00..1.00 rows=1 width=34)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_69  (cost=0.00..1.00 rows=1 width=34)
                                                                           ->  Result  (cost=0.00..1.00 rows=1 width=34)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_70  (cost=0.00..1.00 rows=1 width=34)
                                                                           ->  Result  (cost=0.00..1.00 rows=1 width=34)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_71  (cost=0.00..1.00 rows=1 width=34)
                                                                           ->  Result  (cost=0.00..1.00 rows=1 width=34)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_72  (cost=0.00..1.00 rows=1 width=34)
                                                                           ->  Result  (cost=0.00..1.00 rows=1 width=34)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_73  (cost=0.00..1.00 rows=1 width=34)
                                                                           ->  Result  (cost=0.00..1.00 rows=1 width=34)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_74  (cost=0.00..1.00 rows=1 width=34)
                                                                           ->  Result  (cost=0.00..1.00 rows=1 width=34)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_75  (cost=0.00..1.00 rows=1 width=34)
                                                                           ->  Result  (cost=0.00..1.00 rows=1 width=34)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_76  (cost=0.00..1.00 rows=1 width=34)
                                                                           ->  Result  (cost=0.00..1.00 rows=1 width=34)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_77  (cost=0.00..1.00 rows=1 width=34)
                                                                           ->  Result  (cost=0.00..1.00 rows=1 width=34)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_78  (cost=0.00..1.00 rows=1 width=34)
                                                                           ->  Result  (cost=0.00..1.00 rows=1 width=34)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_79  (cost=0.00..1.00 rows=1 width=34)
                                                                           ->  Result  (cost=0.00..1.00 rows=1 width=34)
                                                                                 One-Time Filter: PartSelected
                                                                                 ->  Append-only Columnar Scan on catalog_sales_1_prt_80  (cost=0.00..1.00 rows=1 width=34)
                                                                     ->  Hash  (cost=1454.25..1454.25 rows=63 width=8)
                                                                           ->  Partition Selector for catalog_sales (dynamic scan id: 1)  (cost=0.00..1454.25 rows=63 width=8)
                                                                                 Filter: date_dim.d_date_sk
                                                                                 ->  Broadcast Motion 3:3  (slice1; segments: 3)  (cost=0.00..1454.25 rows=63 width=8)
                                                                                       ->  Seq Scan on date_dim  (cost=0.00..1451.73 rows=21 width=8)
                                                                                             Filter: ((d_date >= '03-09-1998'::date) AND (d_date <= '05-08-1998'::date))
                                                               ->  Hash  (cost=8253.59..8253.59 rows=19398 width=21)
                                                                     ->  Broadcast Motion 3:3  (slice2; segments: 3)  (cost=0.00..8253.59 rows=19398 width=21)
                                                                           ->  Seq Scan on item  (cost=0.00..7477.70 rows=6466 width=21)
                                                                                 Filter: ((i_current_price >= 0.99) AND (i_current_price <= 1.49))
                                             ->  Hash  (cost=16.00..16.00 rows=20 width=7)
                                                   ->  Broadcast Motion 3:3  (slice3; segments: 3)  (cost=0.00..16.00 rows=20 width=7)
                                                         ->  Seq Scan on warehouse  (cost=0.00..15.20 rows=7 width=7)
 Planning time: 55.112 ms
 Optimizer: legacy query optimizer
(358 rows)

-- end query 1 in stream 0 using template query40.tpl
