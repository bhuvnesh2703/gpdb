-- start query 1 in stream 0 using template query94.tpl
explain
select  
   count(distinct ws_order_number) as "order count"
  ,sum(ws_ext_ship_cost) as "total shipping cost"
  ,sum(ws_net_profit) as "total net profit"
from
   web_sales ws1
  ,date_dim
  ,customer_address
  ,web_site
where
    d_date between '1999-5-01' and 
           (cast('1999-5-01' as date) + 60 )
and ws1.ws_ship_date_sk = d_date_sk
and ws1.ws_ship_addr_sk = ca_address_sk
and ca_state = 'TX'
and ws1.ws_web_site_sk = web_site_sk
and web_company_name = 'pri'
and exists (select *
            from web_sales ws2
            where ws1.ws_order_number = ws2.ws_order_number
              and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)
and not exists(select *
               from web_returns wr1
               where ws1.ws_order_number = wr1.wr_order_number)
order by count(distinct ws_order_number)
limit 100;
                                                                                                                                 QUERY PLAN                                                                                                                                 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=33340677.59..33340677.60 rows=1 width=72)
   ->  Sort  (cost=33340677.59..33340677.60 rows=1 width=72)
         Sort Key: (count((count(DISTINCT ws1.ws_order_number))))
         ->  Aggregate  (cost=33340677.57..33340677.58 rows=1 width=72)
               ->  Gather Motion 3:1  (slice9; segments: 3)  (cost=33340677.50..33340677.55 rows=1 width=72)
                     ->  Aggregate  (cost=33340677.50..33340677.51 rows=1 width=72)
                           ->  Redistribute Motion 3:3  (slice8; segments: 3)  (cost=33340660.58..33340677.30 rows=9 width=16)
                                 Hash Key: ws1.ws_order_number
                                 ->  Hash Anti Join  (cost=33340660.58..33340676.78 rows=9 width=16)
                                       Hash Cond: (ws1.ws_order_number = wr1.wr_order_number)
                                       ->  Redistribute Motion 3:3  (slice6; segments: 3)  (cost=30017497.92..30017499.39 rows=10 width=60)
                                             Hash Key: ws1.ws_order_number
                                             ->  HashAggregate  (cost=30017499.02..30017499.31 rows=10 width=76)
                                                   Group Key: (customer_address.ctid)::bigint, (ws1.ctid)::bigint, (date_dim.ctid)::bigint, (web_site.ctid)::bigint, customer_address.gp_segment_id, ws1.gp_segment_id, (2), date_dim.gp_segment_id, web_site.gp_segment_id
                                                   ->  Result  (cost=15758033.28..30017498.36 rows=10 width=60)
                                                         ->  Redistribute Motion 3:3  (slice5; segments: 3)  (cost=15758033.28..30017498.36 rows=10 width=60)
                                                               Hash Key: customer_address.ctid, ws1.ctid, date_dim.ctid, web_site.ctid
                                                               ->  Hash Join  (cost=15758033.28..30017497.77 rows=10 width=60)
                                                                     Hash Cond: (ws2.ws_order_number = ws1.ws_order_number)
                                                                     Join Filter: (ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)
                                                                     ->  Append  (cost=0.00..11136051.31 rows=240000015 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_outliers ws2  (cost=0.00..2391.21 rows=59974 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_2 ws2_1  (cost=0.00..94902.80 rows=2044794 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_3 ws2_2  (cost=0.00..98794.40 rows=2129180 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_4 ws2_3  (cost=0.00..95176.20 rows=2051340 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_5 ws2_4  (cost=0.00..98886.20 rows=2130874 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_6 ws2_5  (cost=0.00..98686.80 rows=2126394 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_7 ws2_6  (cost=0.00..98900.30 rows=2131144 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_8 ws2_7  (cost=0.00..98568.30 rows=2124144 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_9 ws2_8  (cost=0.00..143675.40 rows=3096280 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_10 ws2_9  (cost=0.00..224454.00 rows=4837567 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_11 ws2_10  (cost=0.00..224538.00 rows=4838600 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_12 ws2_11  (cost=0.00..232917.00 rows=5019700 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_13 ws2_12  (cost=0.00..340347.00 rows=7335234 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_14 ws2_13  (cost=0.00..339963.00 rows=7326700 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_15 ws2_14  (cost=0.00..128058.80 rows=2759894 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_16 ws2_15  (cost=0.00..98762.90 rows=2127930 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_17 ws2_16  (cost=0.00..95130.30 rows=2049977 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_18 ws2_17  (cost=0.00..98536.30 rows=2123477 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_19 ws2_18  (cost=0.00..98763.80 rows=2128160 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_20 ws2_19  (cost=0.00..98632.00 rows=2125534 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_21 ws2_20  (cost=0.00..98600.90 rows=2124597 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_22 ws2_21  (cost=0.00..139196.60 rows=2999954 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_23 ws2_22  (cost=0.00..224702.00 rows=4842300 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_24 ws2_23  (cost=0.00..224404.00 rows=4836067 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_25 ws2_24  (cost=0.00..228579.00 rows=4926567 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_26 ws2_25  (cost=0.00..340407.00 rows=7336234 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_27 ws2_26  (cost=0.00..339824.00 rows=7323934 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_28 ws2_27  (cost=0.00..136669.10 rows=2945270 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_29 ws2_28  (cost=0.00..98265.40 rows=2117680 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_30 ws2_29  (cost=0.00..98510.80 rows=2122894 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_31 ws2_30  (cost=0.00..98626.80 rows=2125460 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_32 ws2_31  (cost=0.00..98594.80 rows=2124860 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_33 ws2_32  (cost=0.00..98426.60 rows=2121220 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_34 ws2_33  (cost=0.00..98533.60 rows=2123320 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_35 ws2_34  (cost=0.00..134141.00 rows=2890900 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_36 ws2_35  (cost=0.00..224203.00 rows=4832167 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_37 ws2_36  (cost=0.00..224486.00 rows=4838100 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_38 ws2_37  (cost=0.00..224574.00 rows=4840000 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_39 ws2_38  (cost=0.00..339843.00 rows=7323734 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_40 ws2_39  (cost=0.00..339993.00 rows=7327400 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_41 ws2_40  (cost=0.00..141767.90 rows=3054930 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_42 ws2_41  (cost=0.00..98461.00 rows=2121867 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_43 ws2_42  (cost=0.00..95277.50 rows=2053050 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_44 ws2_43  (cost=0.00..98854.40 rows=2130480 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_45 ws2_44  (cost=0.00..98738.70 rows=2127790 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_46 ws2_45  (cost=0.00..98685.60 rows=2126654 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_47 ws2_46  (cost=0.00..98998.50 rows=2133217 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_48 ws2_47  (cost=0.00..125716.80 rows=2709260 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_49 ws2_48  (cost=0.00..224729.00 rows=4843367 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_50 ws2_49  (cost=0.00..224641.00 rows=4841034 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_51 ws2_50  (cost=0.00..224630.00 rows=4841267 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_52 ws2_51  (cost=0.00..332139.00 rows=7158600 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_53 ws2_52  (cost=0.00..340420.00 rows=7336634 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_54 ws2_53  (cost=0.00..162712.00 rows=3506534 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_55 ws2_54  (cost=0.00..98867.20 rows=2130440 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_56 ws2_55  (cost=0.00..95121.00 rows=2049967 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_57 ws2_56  (cost=0.00..98600.60 rows=2124820 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_58 ws2_57  (cost=0.00..98639.10 rows=2125604 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_59 ws2_58  (cost=0.00..98591.40 rows=2124880 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_60 ws2_59  (cost=0.00..98868.30 rows=2130610 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_61 ws2_60  (cost=0.00..121113.60 rows=2609954 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_62 ws2_61  (cost=0.00..224388.00 rows=4835634 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_63 ws2_62  (cost=0.00..224495.00 rows=4837834 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_64 ws2_63  (cost=0.00..224520.00 rows=4838767 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_65 ws2_64  (cost=0.00..328357.00 rows=7076767 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_66 ws2_65  (cost=0.00..340970.00 rows=7348567 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_67 ws2_66  (cost=0.00..97070.40 rows=2091947 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_68 ws2_67  (cost=0.00..1.00 rows=1 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_69 ws2_68  (cost=0.00..1.00 rows=1 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_70 ws2_69  (cost=0.00..1.00 rows=1 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_71 ws2_70  (cost=0.00..1.00 rows=1 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_72 ws2_71  (cost=0.00..1.00 rows=1 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_73 ws2_72  (cost=0.00..1.00 rows=1 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_74 ws2_73  (cost=0.00..1.00 rows=1 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_75 ws2_74  (cost=0.00..1.00 rows=1 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_76 ws2_75  (cost=0.00..1.00 rows=1 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_77 ws2_76  (cost=0.00..1.00 rows=1 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_78 ws2_77  (cost=0.00..1.00 rows=1 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_79 ws2_78  (cost=0.00..1.00 rows=1 width=8)
                                                                           ->  Append-only Columnar Scan on web_sales_1_prt_80 ws2_79  (cost=0.00..1.00 rows=1 width=8)
                                                                     ->  Hash  (cost=15757766.07..15757766.07 rows=7126 width=64)
                                                                           ->  Broadcast Motion 3:3  (slice4; segments: 3)  (cost=108208.31..15757766.07 rows=7126 width=64)
                                                                                 ->  Hash Join  (cost=108208.31..15757481.05 rows=2376 width=64)
                                                                                       Hash Cond: (ws1.ws_ship_addr_sk = customer_address.ca_address_sk)
                                                                                       ->  Redistribute Motion 3:3  (slice3; segments: 3)  (cost=1481.90..15650339.61 rows=30558 width=58)
                                                                                             Hash Key: ws1.ws_ship_addr_sk
                                                                                             ->  Hash Join  (cost=1481.90..15648506.17 rows=30558 width=58)
                                                                                                   Hash Cond: (ws1.ws_web_site_sk = web_site.web_site_sk)
                                                                                                   ->  Hash Join  (cost=1456.60..15643696.47 rows=206277 width=52)
                                                                                                         Hash Cond: (ws1.ws_ship_date_sk = date_dim.d_date_sk)
                                                                                                         ->  Append  (cost=0.00..11136051.31 rows=240000015 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_outliers ws1  (cost=0.00..2391.21 rows=59974 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_2 ws1_1  (cost=0.00..94902.80 rows=2044794 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_3 ws1_2  (cost=0.00..98794.40 rows=2129180 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_4 ws1_3  (cost=0.00..95176.20 rows=2051340 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_5 ws1_4  (cost=0.00..98886.20 rows=2130874 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_6 ws1_5  (cost=0.00..98686.80 rows=2126394 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_7 ws1_6  (cost=0.00..98900.30 rows=2131144 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_8 ws1_7  (cost=0.00..98568.30 rows=2124144 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_9 ws1_8  (cost=0.00..143675.40 rows=3096280 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_10 ws1_9  (cost=0.00..224454.00 rows=4837567 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_11 ws1_10  (cost=0.00..224538.00 rows=4838600 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_12 ws1_11  (cost=0.00..232917.00 rows=5019700 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_13 ws1_12  (cost=0.00..340347.00 rows=7335234 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_14 ws1_13  (cost=0.00..339963.00 rows=7326700 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_15 ws1_14  (cost=0.00..128058.80 rows=2759894 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_16 ws1_15  (cost=0.00..98762.90 rows=2127930 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_17 ws1_16  (cost=0.00..95130.30 rows=2049977 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_18 ws1_17  (cost=0.00..98536.30 rows=2123477 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_19 ws1_18  (cost=0.00..98763.80 rows=2128160 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_20 ws1_19  (cost=0.00..98632.00 rows=2125534 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_21 ws1_20  (cost=0.00..98600.90 rows=2124597 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_22 ws1_21  (cost=0.00..139196.60 rows=2999954 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_23 ws1_22  (cost=0.00..224702.00 rows=4842300 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_24 ws1_23  (cost=0.00..224404.00 rows=4836067 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_25 ws1_24  (cost=0.00..228579.00 rows=4926567 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_26 ws1_25  (cost=0.00..340407.00 rows=7336234 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_27 ws1_26  (cost=0.00..339824.00 rows=7323934 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_28 ws1_27  (cost=0.00..136669.10 rows=2945270 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_29 ws1_28  (cost=0.00..98265.40 rows=2117680 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_30 ws1_29  (cost=0.00..98510.80 rows=2122894 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_31 ws1_30  (cost=0.00..98626.80 rows=2125460 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_32 ws1_31  (cost=0.00..98594.80 rows=2124860 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_33 ws1_32  (cost=0.00..98426.60 rows=2121220 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_34 ws1_33  (cost=0.00..98533.60 rows=2123320 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_35 ws1_34  (cost=0.00..134141.00 rows=2890900 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_36 ws1_35  (cost=0.00..224203.00 rows=4832167 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_37 ws1_36  (cost=0.00..224486.00 rows=4838100 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_38 ws1_37  (cost=0.00..224574.00 rows=4840000 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_39 ws1_38  (cost=0.00..339843.00 rows=7323734 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_40 ws1_39  (cost=0.00..339993.00 rows=7327400 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_41 ws1_40  (cost=0.00..141767.90 rows=3054930 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_42 ws1_41  (cost=0.00..98461.00 rows=2121867 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_43 ws1_42  (cost=0.00..95277.50 rows=2053050 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_44 ws1_43  (cost=0.00..98854.40 rows=2130480 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_45 ws1_44  (cost=0.00..98738.70 rows=2127790 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_46 ws1_45  (cost=0.00..98685.60 rows=2126654 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_47 ws1_46  (cost=0.00..98998.50 rows=2133217 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_48 ws1_47  (cost=0.00..125716.80 rows=2709260 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_49 ws1_48  (cost=0.00..224729.00 rows=4843367 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_50 ws1_49  (cost=0.00..224641.00 rows=4841034 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_51 ws1_50  (cost=0.00..224630.00 rows=4841267 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_52 ws1_51  (cost=0.00..332139.00 rows=7158600 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_53 ws1_52  (cost=0.00..340420.00 rows=7336634 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_54 ws1_53  (cost=0.00..162712.00 rows=3506534 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_55 ws1_54  (cost=0.00..98867.20 rows=2130440 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_56 ws1_55  (cost=0.00..95121.00 rows=2049967 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_57 ws1_56  (cost=0.00..98600.60 rows=2124820 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_58 ws1_57  (cost=0.00..98639.10 rows=2125604 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_59 ws1_58  (cost=0.00..98591.40 rows=2124880 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_60 ws1_59  (cost=0.00..98868.30 rows=2130610 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_61 ws1_60  (cost=0.00..121113.60 rows=2609954 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_62 ws1_61  (cost=0.00..224388.00 rows=4835634 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_63 ws1_62  (cost=0.00..224495.00 rows=4837834 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_64 ws1_63  (cost=0.00..224520.00 rows=4838767 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_65 ws1_64  (cost=0.00..328357.00 rows=7076767 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_66 ws1_65  (cost=0.00..340970.00 rows=7348567 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_67 ws1_66  (cost=0.00..97070.40 rows=2091947 width=46)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_68 ws1_67  (cost=0.00..1.00 rows=1 width=62)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_69 ws1_68  (cost=0.00..1.00 rows=1 width=62)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_70 ws1_69  (cost=0.00..1.00 rows=1 width=62)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_71 ws1_70  (cost=0.00..1.00 rows=1 width=62)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_72 ws1_71  (cost=0.00..1.00 rows=1 width=62)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_73 ws1_72  (cost=0.00..1.00 rows=1 width=62)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_74 ws1_73  (cost=0.00..1.00 rows=1 width=62)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_75 ws1_74  (cost=0.00..1.00 rows=1 width=62)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_76 ws1_75  (cost=0.00..1.00 rows=1 width=62)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_77 ws1_76  (cost=0.00..1.00 rows=1 width=62)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_78 ws1_77  (cost=0.00..1.00 rows=1 width=62)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_79 ws1_78  (cost=0.00..1.00 rows=1 width=62)
                                                                                                               ->  Append-only Columnar Scan on web_sales_1_prt_80 ws1_79  (cost=0.00..1.00 rows=1 width=62)
                                                                                                         ->  Hash  (cost=1454.25..1454.25 rows=63 width=14)
                                                                                                               ->  Broadcast Motion 3:3  (slice1; segments: 3)  (cost=0.00..1454.25 rows=63 width=14)
                                                                                                                     ->  Seq Scan on date_dim  (cost=0.00..1451.73 rows=21 width=14)
                                                                                                                           Filter: ((d_date >= '05-01-1999'::date) AND (d_date <= '06-30-1999'::date))
                                                                                                   ->  Hash  (cost=24.99..24.99 rows=8 width=14)
                                                                                                         ->  Broadcast Motion 3:3  (slice2; segments: 3)  (cost=0.00..24.99 rows=8 width=14)
                                                                                                               ->  Seq Scan on web_site  (cost=0.00..24.68 rows=3 width=14)
                                                                                                                     Filter: ((web_company_name)::text = 'pri'::text)
                                                                                       ->  Hash  (cost=100894.88..100894.88 rows=155508 width=14)
                                                                                             ->  Seq Scan on customer_address  (cost=0.00..100894.88 rows=155508 width=14)
                                                                                                   Filter: ((ca_state)::text = 'TX'::text)
                                       ->  Hash  (cost=2423193.35..2423193.35 rows=23999182 width=4)
                                             ->  Redistribute Motion 3:3  (slice7; segments: 3)  (cost=0.00..2423193.35 rows=23999182 width=4)
                                                   Hash Key: wr1.wr_order_number
                                                   ->  Append  (cost=0.00..983242.45 rows=23999182 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_outliers wr1  (cost=0.00..38893.60 rows=1079754 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_2 wr1_1  (cost=0.00..51.87 rows=663 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_3 wr1_2  (cost=0.00..243.39 rows=5547 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_4 wr1_3  (cost=0.00..672.62 rows=16021 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_5 wr1_4  (cost=0.00..1337.96 rows=31999 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_6 wr1_5  (cost=0.00..2194.10 rows=52937 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_7 wr1_6  (cost=0.00..3165.94 rows=76598 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_8 wr1_7  (cost=0.00..4149.44 rows=100482 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_9 wr1_8  (cost=0.00..5123.76 rows=124092 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_10 wr1_9  (cost=0.00..6205.45 rows=150449 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_11 wr1_10  (cost=0.00..7467.74 rows=181092 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_12 wr1_11  (cost=0.00..8787.18 rows=213173 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_13 wr1_12  (cost=0.00..10246.69 rows=248690 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_14 wr1_13  (cost=0.00..11962.54 rows=290352 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_15 wr1_14  (cost=0.00..13706.59 rows=332753 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_16 wr1_15  (cost=0.00..15323.50 rows=371984 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_17 wr1_16  (cost=0.00..16613.80 rows=403427 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_18 wr1_17  (cost=0.00..17449.40 rows=423747 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_19 wr1_18  (cost=0.00..17450.10 rows=423704 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_20 wr1_19  (cost=0.00..16964.80 rows=411894 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_21 wr1_20  (cost=0.00..16132.20 rows=391674 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_22 wr1_21  (cost=0.00..14907.70 rows=361924 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_23 wr1_22  (cost=0.00..13378.79 rows=324693 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_24 wr1_23  (cost=0.00..12047.21 rows=292341 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_25 wr1_24  (cost=0.00..11228.09 rows=272470 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_26 wr1_25  (cost=0.00..11109.92 rows=269631 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_27 wr1_26  (cost=0.00..12030.70 rows=291957 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_28 wr1_27  (cost=0.00..13656.34 rows=331512 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_29 wr1_28  (cost=0.00..15310.30 rows=371677 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_30 wr1_29  (cost=0.00..16610.30 rows=403277 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_31 wr1_30  (cost=0.00..17417.80 rows=422960 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_32 wr1_31  (cost=0.00..17462.40 rows=423914 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_33 wr1_32  (cost=0.00..16977.10 rows=412204 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_34 wr1_33  (cost=0.00..16214.80 rows=393694 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_35 wr1_34  (cost=0.00..14996.10 rows=364070 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_36 wr1_35  (cost=0.00..13465.95 rows=326865 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_37 wr1_36  (cost=0.00..12069.06 rows=292936 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_38 wr1_37  (cost=0.00..11277.57 rows=273619 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_39 wr1_38  (cost=0.00..11095.59 rows=269287 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_40 wr1_39  (cost=0.00..11960.13 rows=290238 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_41 wr1_40  (cost=0.00..13588.95 rows=329865 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_42 wr1_41  (cost=0.00..15197.90 rows=368897 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_43 wr1_42  (cost=0.00..16516.40 rows=401014 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_44 wr1_43  (cost=0.00..17313.10 rows=420337 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_45 wr1_44  (cost=0.00..17436.40 rows=423380 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_46 wr1_45  (cost=0.00..16959.40 rows=411714 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_47 wr1_46  (cost=0.00..16178.70 rows=392790 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_48 wr1_47  (cost=0.00..14974.00 rows=363534 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_49 wr1_48  (cost=0.00..13451.19 rows=326507 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_50 wr1_49  (cost=0.00..12077.63 rows=293188 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_51 wr1_50  (cost=0.00..11199.36 rows=271779 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_52 wr1_51  (cost=0.00..11055.33 rows=268278 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_53 wr1_52  (cost=0.00..11851.16 rows=287672 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_54 wr1_53  (cost=0.00..13492.27 rows=327476 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_55 wr1_54  (cost=0.00..15119.10 rows=367037 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_56 wr1_55  (cost=0.00..16452.40 rows=399414 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_57 wr1_56  (cost=0.00..17332.10 rows=420837 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_58 wr1_57  (cost=0.00..17526.30 rows=425544 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_59 wr1_58  (cost=0.00..17030.00 rows=413467 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_60 wr1_59  (cost=0.00..16294.00 rows=395634 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_61 wr1_60  (cost=0.00..15121.60 rows=367087 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_62 wr1_61  (cost=0.00..13616.65 rows=330622 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_63 wr1_62  (cost=0.00..12209.64 rows=296355 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_64 wr1_63  (cost=0.00..11321.38 rows=274746 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_65 wr1_64  (cost=0.00..11070.08 rows=268603 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_66 wr1_65  (cost=0.00..11802.27 rows=286443 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_67 wr1_66  (cost=0.00..13397.43 rows=325215 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_68 wr1_67  (cost=0.00..14873.40 rows=361080 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_69 wr1_68  (cost=0.00..15860.80 rows=385127 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_70 wr1_69  (cost=0.00..16127.10 rows=391604 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_71 wr1_70  (cost=0.00..15525.80 rows=376927 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_72 wr1_71  (cost=0.00..14130.60 rows=342987 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_73 wr1_72  (cost=0.00..12407.21 rows=301141 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_74 wr1_73  (cost=0.00..10303.48 rows=250016 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_75 wr1_74  (cost=0.00..7747.34 rows=187845 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_76 wr1_75  (cost=0.00..5077.79 rows=123060 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_77 wr1_76  (cost=0.00..2838.35 rows=68612 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_78 wr1_77  (cost=0.00..1156.60 rows=27854 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_79 wr1_78  (cost=0.00..222.03 rows=5201 width=4)
                                                         ->  Append-only Columnar Scan on web_returns_1_prt_80 wr1_79  (cost=0.00..28.69 rows=23 width=4)
 Planning time: 73.956 ms
 Optimizer: legacy query optimizer
(289 rows)

-- end query 1 in stream 0 using template query94.tpl
