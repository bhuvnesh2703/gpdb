-- start query 1 in stream 0 using template query90.tpl
explain
select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio
 from ( select count(*) amc
       from web_sales, household_demographics , time_dim, web_page
       where ws_sold_time_sk = time_dim.t_time_sk
         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk
         and ws_web_page_sk = web_page.wp_web_page_sk
         and time_dim.t_hour between 6 and 6+1
         and household_demographics.hd_dep_count = 8
         and web_page.wp_char_count between 5000 and 5200) at,
      ( select count(*) pmc
       from web_sales, household_demographics , time_dim, web_page
       where ws_sold_time_sk = time_dim.t_time_sk
         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk
         and ws_web_page_sk = web_page.wp_web_page_sk
         and time_dim.t_hour between 14 and 14+1
         and household_demographics.hd_dep_count = 8
         and web_page.wp_char_count between 5000 and 5200) pt
 order by am_pm_ratio
 limit 100;
                                                                                          QUERY PLAN                                                                                          
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=10031835511.87..10031835511.88 rows=4 width=16)
   ->  Sort  (cost=10031835511.87..10031835511.88 rows=4 width=16)
         Sort Key: ((((count((count(*)))))::numeric(15,4) / ((count((count(*)))))::numeric(15,4)))
         ->  Nested Loop  (cost=10031835511.75..10031835511.84 rows=4 width=16)
               ->  Aggregate  (cost=15917619.35..15917619.36 rows=1 width=8)
                     ->  Gather Motion 3:1  (slice4; segments: 3)  (cost=15917619.29..15917619.34 rows=1 width=8)
                           ->  Aggregate  (cost=15917619.29..15917619.30 rows=1 width=8)
                                 ->  Hash Join  (cost=2469.78..15917290.52 rows=43836 width=0)
                                       Hash Cond: (web_sales_1_prt_outliers.ws_ship_hdemo_sk = household_demographics.hd_demo_sk)
                                       ->  Hash Join  (cost=2291.98..15907577.59 rows=438404 width=4)
                                             Hash Cond: (web_sales_1_prt_outliers.ws_sold_time_sk = time_dim.t_time_sk)
                                             ->  Hash Join  (cost=82.09..15793722.55 rows=5252963 width=8)
                                                   Hash Cond: (web_sales_1_prt_outliers.ws_web_page_sk = web_page.wp_web_page_sk)
                                                   ->  Append  (cost=0.00..11136051.31 rows=240000015 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_outliers  (cost=0.00..2391.21 rows=59974 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_2  (cost=0.00..94902.80 rows=2044794 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_3  (cost=0.00..98794.40 rows=2129180 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_4  (cost=0.00..95176.20 rows=2051340 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_5  (cost=0.00..98886.20 rows=2130874 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_6  (cost=0.00..98686.80 rows=2126394 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_7  (cost=0.00..98900.30 rows=2131144 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_8  (cost=0.00..98568.30 rows=2124144 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_9  (cost=0.00..143675.40 rows=3096280 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_10  (cost=0.00..224454.00 rows=4837567 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_11  (cost=0.00..224538.00 rows=4838600 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_12  (cost=0.00..232917.00 rows=5019700 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_13  (cost=0.00..340347.00 rows=7335234 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_14  (cost=0.00..339963.00 rows=7326700 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_15  (cost=0.00..128058.80 rows=2759894 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_16  (cost=0.00..98762.90 rows=2127930 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_17  (cost=0.00..95130.30 rows=2049977 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_18  (cost=0.00..98536.30 rows=2123477 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_19  (cost=0.00..98763.80 rows=2128160 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_20  (cost=0.00..98632.00 rows=2125534 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_21  (cost=0.00..98600.90 rows=2124597 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_22  (cost=0.00..139196.60 rows=2999954 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_23  (cost=0.00..224702.00 rows=4842300 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_24  (cost=0.00..224404.00 rows=4836067 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_25  (cost=0.00..228579.00 rows=4926567 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_26  (cost=0.00..340407.00 rows=7336234 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_27  (cost=0.00..339824.00 rows=7323934 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_28  (cost=0.00..136669.10 rows=2945270 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_29  (cost=0.00..98265.40 rows=2117680 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_30  (cost=0.00..98510.80 rows=2122894 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_31  (cost=0.00..98626.80 rows=2125460 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_32  (cost=0.00..98594.80 rows=2124860 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_33  (cost=0.00..98426.60 rows=2121220 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_34  (cost=0.00..98533.60 rows=2123320 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_35  (cost=0.00..134141.00 rows=2890900 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_36  (cost=0.00..224203.00 rows=4832167 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_37  (cost=0.00..224486.00 rows=4838100 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_38  (cost=0.00..224574.00 rows=4840000 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_39  (cost=0.00..339843.00 rows=7323734 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_40  (cost=0.00..339993.00 rows=7327400 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_41  (cost=0.00..141767.90 rows=3054930 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_42  (cost=0.00..98461.00 rows=2121867 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_43  (cost=0.00..95277.50 rows=2053050 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_44  (cost=0.00..98854.40 rows=2130480 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_45  (cost=0.00..98738.70 rows=2127790 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_46  (cost=0.00..98685.60 rows=2126654 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_47  (cost=0.00..98998.50 rows=2133217 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_48  (cost=0.00..125716.80 rows=2709260 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_49  (cost=0.00..224729.00 rows=4843367 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_50  (cost=0.00..224641.00 rows=4841034 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_51  (cost=0.00..224630.00 rows=4841267 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_52  (cost=0.00..332139.00 rows=7158600 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_53  (cost=0.00..340420.00 rows=7336634 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_54  (cost=0.00..162712.00 rows=3506534 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_55  (cost=0.00..98867.20 rows=2130440 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_56  (cost=0.00..95121.00 rows=2049967 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_57  (cost=0.00..98600.60 rows=2124820 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_58  (cost=0.00..98639.10 rows=2125604 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_59  (cost=0.00..98591.40 rows=2124880 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_60  (cost=0.00..98868.30 rows=2130610 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_61  (cost=0.00..121113.60 rows=2609954 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_62  (cost=0.00..224388.00 rows=4835634 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_63  (cost=0.00..224495.00 rows=4837834 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_64  (cost=0.00..224520.00 rows=4838767 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_65  (cost=0.00..328357.00 rows=7076767 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_66  (cost=0.00..340970.00 rows=7348567 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_67  (cost=0.00..97070.40 rows=2091947 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_68  (cost=0.00..1.00 rows=1 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_69  (cost=0.00..1.00 rows=1 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_70  (cost=0.00..1.00 rows=1 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_71  (cost=0.00..1.00 rows=1 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_72  (cost=0.00..1.00 rows=1 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_73  (cost=0.00..1.00 rows=1 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_74  (cost=0.00..1.00 rows=1 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_75  (cost=0.00..1.00 rows=1 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_76  (cost=0.00..1.00 rows=1 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_77  (cost=0.00..1.00 rows=1 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_78  (cost=0.00..1.00 rows=1 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_79  (cost=0.00..1.00 rows=1 width=12)
                                                         ->  Append-only Columnar Scan on web_sales_1_prt_80  (cost=0.00..1.00 rows=1 width=12)
                                                   ->  Hash  (cost=79.63..79.63 rows=66 width=4)
                                                         ->  Broadcast Motion 3:3  (slice1; segments: 3)  (cost=0.00..79.63 rows=66 width=4)
                                                               ->  Seq Scan on web_page  (cost=0.00..77.00 rows=22 width=4)
                                                                     Filter: ((wp_char_count >= 5000) AND (wp_char_count <= 5200))
                                             ->  Hash  (cost=1939.46..1939.46 rows=7212 width=4)
                                                   ->  Broadcast Motion 3:3  (slice2; segments: 3)  (cost=0.00..1939.46 rows=7212 width=4)
                                                         ->  Seq Scan on time_dim  (cost=0.00..1651.00 rows=2404 width=4)
                                                               Filter: ((t_hour >= 6) AND (t_hour <= 7))
                                       ->  Hash  (cost=150.80..150.80 rows=721 width=4)
                                             ->  Broadcast Motion 3:3  (slice3; segments: 3)  (cost=0.00..150.80 rows=721 width=4)
                                                   ->  Seq Scan on household_demographics  (cost=0.00..122.00 rows=241 width=4)
                                                         Filter: (hd_dep_count = 8)
               ->  Materialize  (cost=15917892.40..15917892.42 rows=1 width=8)
                     ->  Aggregate  (cost=15917892.40..15917892.41 rows=1 width=8)
                           ->  Gather Motion 3:1  (slice8; segments: 3)  (cost=15917892.33..15917892.38 rows=1 width=8)
                                 ->  Aggregate  (cost=15917892.33..15917892.34 rows=1 width=8)
                                       ->  Hash Join  (cost=2476.26..15917559.76 rows=44344 width=0)
                                             Hash Cond: (web_sales_1_prt_outliers_1.ws_ship_hdemo_sk = household_demographics_1.hd_demo_sk)
                                             ->  Hash Join  (cost=2298.46..15907736.39 rows=443481 width=4)
                                                   Hash Cond: (web_sales_1_prt_outliers_1.ws_sold_time_sk = time_dim_1.t_time_sk)
                                                   ->  Hash Join  (cost=82.09..15793722.55 rows=5252963 width=8)
                                                         Hash Cond: (web_sales_1_prt_outliers_1.ws_web_page_sk = web_page_1.wp_web_page_sk)
                                                         ->  Append  (cost=0.00..11136051.31 rows=240000015 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_outliers web_sales_1_prt_outliers_1  (cost=0.00..2391.21 rows=59974 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_2 web_sales_1_prt_2_1  (cost=0.00..94902.80 rows=2044794 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_3 web_sales_1_prt_3_1  (cost=0.00..98794.40 rows=2129180 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_4 web_sales_1_prt_4_1  (cost=0.00..95176.20 rows=2051340 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_5 web_sales_1_prt_5_1  (cost=0.00..98886.20 rows=2130874 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_6 web_sales_1_prt_6_1  (cost=0.00..98686.80 rows=2126394 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_7 web_sales_1_prt_7_1  (cost=0.00..98900.30 rows=2131144 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_8 web_sales_1_prt_8_1  (cost=0.00..98568.30 rows=2124144 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_9 web_sales_1_prt_9_1  (cost=0.00..143675.40 rows=3096280 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_10 web_sales_1_prt_10_1  (cost=0.00..224454.00 rows=4837567 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_11 web_sales_1_prt_11_1  (cost=0.00..224538.00 rows=4838600 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_12 web_sales_1_prt_12_1  (cost=0.00..232917.00 rows=5019700 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_13 web_sales_1_prt_13_1  (cost=0.00..340347.00 rows=7335234 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_14 web_sales_1_prt_14_1  (cost=0.00..339963.00 rows=7326700 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_15 web_sales_1_prt_15_1  (cost=0.00..128058.80 rows=2759894 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_16 web_sales_1_prt_16_1  (cost=0.00..98762.90 rows=2127930 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_17 web_sales_1_prt_17_1  (cost=0.00..95130.30 rows=2049977 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_18 web_sales_1_prt_18_1  (cost=0.00..98536.30 rows=2123477 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_19 web_sales_1_prt_19_1  (cost=0.00..98763.80 rows=2128160 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_20 web_sales_1_prt_20_1  (cost=0.00..98632.00 rows=2125534 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_21 web_sales_1_prt_21_1  (cost=0.00..98600.90 rows=2124597 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_22 web_sales_1_prt_22_1  (cost=0.00..139196.60 rows=2999954 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_23 web_sales_1_prt_23_1  (cost=0.00..224702.00 rows=4842300 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_24 web_sales_1_prt_24_1  (cost=0.00..224404.00 rows=4836067 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_25 web_sales_1_prt_25_1  (cost=0.00..228579.00 rows=4926567 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_26 web_sales_1_prt_26_1  (cost=0.00..340407.00 rows=7336234 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_27 web_sales_1_prt_27_1  (cost=0.00..339824.00 rows=7323934 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_28 web_sales_1_prt_28_1  (cost=0.00..136669.10 rows=2945270 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_29 web_sales_1_prt_29_1  (cost=0.00..98265.40 rows=2117680 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_30 web_sales_1_prt_30_1  (cost=0.00..98510.80 rows=2122894 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_31 web_sales_1_prt_31_1  (cost=0.00..98626.80 rows=2125460 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_32 web_sales_1_prt_32_1  (cost=0.00..98594.80 rows=2124860 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_33 web_sales_1_prt_33_1  (cost=0.00..98426.60 rows=2121220 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_34 web_sales_1_prt_34_1  (cost=0.00..98533.60 rows=2123320 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_35 web_sales_1_prt_35_1  (cost=0.00..134141.00 rows=2890900 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_36 web_sales_1_prt_36_1  (cost=0.00..224203.00 rows=4832167 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_37 web_sales_1_prt_37_1  (cost=0.00..224486.00 rows=4838100 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_38 web_sales_1_prt_38_1  (cost=0.00..224574.00 rows=4840000 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_39 web_sales_1_prt_39_1  (cost=0.00..339843.00 rows=7323734 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_40 web_sales_1_prt_40_1  (cost=0.00..339993.00 rows=7327400 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_41 web_sales_1_prt_41_1  (cost=0.00..141767.90 rows=3054930 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_42 web_sales_1_prt_42_1  (cost=0.00..98461.00 rows=2121867 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_43 web_sales_1_prt_43_1  (cost=0.00..95277.50 rows=2053050 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_44 web_sales_1_prt_44_1  (cost=0.00..98854.40 rows=2130480 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_45 web_sales_1_prt_45_1  (cost=0.00..98738.70 rows=2127790 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_46 web_sales_1_prt_46_1  (cost=0.00..98685.60 rows=2126654 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_47 web_sales_1_prt_47_1  (cost=0.00..98998.50 rows=2133217 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_48 web_sales_1_prt_48_1  (cost=0.00..125716.80 rows=2709260 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_49 web_sales_1_prt_49_1  (cost=0.00..224729.00 rows=4843367 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_50 web_sales_1_prt_50_1  (cost=0.00..224641.00 rows=4841034 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_51 web_sales_1_prt_51_1  (cost=0.00..224630.00 rows=4841267 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_52 web_sales_1_prt_52_1  (cost=0.00..332139.00 rows=7158600 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_53 web_sales_1_prt_53_1  (cost=0.00..340420.00 rows=7336634 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_54 web_sales_1_prt_54_1  (cost=0.00..162712.00 rows=3506534 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_55 web_sales_1_prt_55_1  (cost=0.00..98867.20 rows=2130440 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_56 web_sales_1_prt_56_1  (cost=0.00..95121.00 rows=2049967 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_57 web_sales_1_prt_57_1  (cost=0.00..98600.60 rows=2124820 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_58 web_sales_1_prt_58_1  (cost=0.00..98639.10 rows=2125604 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_59 web_sales_1_prt_59_1  (cost=0.00..98591.40 rows=2124880 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_60 web_sales_1_prt_60_1  (cost=0.00..98868.30 rows=2130610 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_61 web_sales_1_prt_61_1  (cost=0.00..121113.60 rows=2609954 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_62 web_sales_1_prt_62_1  (cost=0.00..224388.00 rows=4835634 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_63 web_sales_1_prt_63_1  (cost=0.00..224495.00 rows=4837834 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_64 web_sales_1_prt_64_1  (cost=0.00..224520.00 rows=4838767 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_65 web_sales_1_prt_65_1  (cost=0.00..328357.00 rows=7076767 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_66 web_sales_1_prt_66_1  (cost=0.00..340970.00 rows=7348567 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_67 web_sales_1_prt_67_1  (cost=0.00..97070.40 rows=2091947 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_68 web_sales_1_prt_68_1  (cost=0.00..1.00 rows=1 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_69 web_sales_1_prt_69_1  (cost=0.00..1.00 rows=1 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_70 web_sales_1_prt_70_1  (cost=0.00..1.00 rows=1 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_71 web_sales_1_prt_71_1  (cost=0.00..1.00 rows=1 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_72 web_sales_1_prt_72_1  (cost=0.00..1.00 rows=1 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_73 web_sales_1_prt_73_1  (cost=0.00..1.00 rows=1 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_74 web_sales_1_prt_74_1  (cost=0.00..1.00 rows=1 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_75 web_sales_1_prt_75_1  (cost=0.00..1.00 rows=1 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_76 web_sales_1_prt_76_1  (cost=0.00..1.00 rows=1 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_77 web_sales_1_prt_77_1  (cost=0.00..1.00 rows=1 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_78 web_sales_1_prt_78_1  (cost=0.00..1.00 rows=1 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_79 web_sales_1_prt_79_1  (cost=0.00..1.00 rows=1 width=12)
                                                               ->  Append-only Columnar Scan on web_sales_1_prt_80 web_sales_1_prt_80_1  (cost=0.00..1.00 rows=1 width=12)
                                                         ->  Hash  (cost=79.63..79.63 rows=66 width=4)
                                                               ->  Broadcast Motion 3:3  (slice5; segments: 3)  (cost=0.00..79.63 rows=66 width=4)
                                                                     ->  Seq Scan on web_page web_page_1  (cost=0.00..77.00 rows=22 width=4)
                                                                           Filter: ((wp_char_count >= 5000) AND (wp_char_count <= 5200))
                                                   ->  Hash  (cost=1942.80..1942.80 rows=7296 width=4)
                                                         ->  Broadcast Motion 3:3  (slice6; segments: 3)  (cost=0.00..1942.80 rows=7296 width=4)
                                                               ->  Seq Scan on time_dim time_dim_1  (cost=0.00..1651.00 rows=2432 width=4)
                                                                     Filter: ((t_hour >= 14) AND (t_hour <= 15))
                                             ->  Hash  (cost=150.80..150.80 rows=721 width=4)
                                                   ->  Broadcast Motion 3:3  (slice7; segments: 3)  (cost=0.00..150.80 rows=721 width=4)
                                                         ->  Seq Scan on household_demographics household_demographics_1  (cost=0.00..122.00 rows=241 width=4)
                                                               Filter: (hd_dep_count = 8)
 Planning time: 23.310 ms
 Optimizer: legacy query optimizer
(211 rows)

-- end query 1 in stream 0 using template query90.tpl
